# 姻缘和合法会显示问题修复说明

## 问题描述

用户反馈：在前台选择了姻缘和合法会对应的项目，但没有出现输入配偶信息的选项。

## 问题原因

经过调试发现，问题出现在 `pages/fahui/group.vue` 页面中。该页面使用了硬编码的项目索引来判断是否显示配偶信息：

```vue
<!-- 原来的代码 -->
<view class="section" v-if="selectedProjectIndex === 1">
```

这种硬编码的方式存在以下问题：
1. 如果项目顺序发生变化，条件就会失效
2. 如果数据库中的项目数量或顺序与默认数据不同，功能就会异常
3. 不够灵活，无法适应动态的项目数据

## 修复方案

### 1. 修改显示条件

将硬编码的索引判断改为基于项目分类的动态判断：

```vue
<!-- 修复后的代码 -->
<view class="section" v-if="selectedProjectIndex >= 0 && fahuiProjects[selectedProjectIndex] && fahuiProjects[selectedProjectIndex].category === '姻缘和合'">
```

### 2. 同时修复超度法会

同样的问题也存在于超度法会的显示条件中，一并修复：

```vue
<!-- 原来的代码 -->
<view class="section" v-if="selectedProjectIndex === 2">

<!-- 修复后的代码 -->
<view class="section" v-if="selectedProjectIndex >= 0 && fahuiProjects[selectedProjectIndex] && fahuiProjects[selectedProjectIndex].category === '超度法会'">
```

### 3. 添加调试信息

在项目选择时添加详细的调试信息，方便排查问题：

```javascript
selectProject(index) {
  // ... 原有代码 ...
  
  // 添加调试信息
  console.log('【调试】选择项目:', {
    index: index,
    project: project,
    category: project?.category,
    shouldShowSpouse: project?.category === '姻缘和合',
    shouldShowChaodu: project?.category === '超度法会'
  });
}
```

## 修复效果

### 修复前
- 只有选择索引为1的项目才显示配偶信息
- 只有选择索引为2的项目才显示超度信息
- 项目顺序变化会导致功能失效

### 修复后
- 选择任何分类为"姻缘和合"的项目都会显示配偶信息
- 选择任何分类为"超度法会"的项目都会显示超度信息
- 支持动态项目数据，不受项目顺序影响

## 调试信息

现在当您选择项目时，控制台会显示详细的调试信息：

```
【调试】选择项目: {
  index: 1,
  project: {_id: "joint_yinyuan", name: "姻缘合坛", category: "姻缘和合", ...},
  category: "姻缘和合",
  shouldShowSpouse: true,
  shouldShowChaodu: false
}
```

## 测试步骤

1. **打开合坛法会页面** (`pages/fahui/group.vue`)
2. **查看项目列表**，确认有姻缘和合法会项目
3. **选择姻缘和合法会项目**
4. **检查是否显示配偶信息区域**
5. **查看控制台调试信息**

## 相关文件

- `pages/fahui/group.vue` - 合坛法会报名页面（已修复）
- `pages/fahui/joint/form.vue` - 合坛法会表单页面（已有调试功能）

## 注意事项

1. **项目分类名称**：确保数据库中的项目分类名称与代码中的判断条件一致
   - 姻缘和合法会：`姻缘和合`
   - 超度法会：`超度法会`

2. **数据一致性**：如果使用默认数据，确保默认数据中的分类名称正确

3. **调试功能**：开发阶段可以保留调试信息，生产环境可以移除

## 总结

通过这次修复，姻缘和合法会的配偶信息显示功能现在可以正常工作，不再依赖于硬编码的项目索引，而是基于项目的实际分类进行动态判断。这提高了代码的灵活性和可维护性。 