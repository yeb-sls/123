<view class="data-v-6d1fbf98"><view class="admin-container data-v-6d1fbf98"><view class="page-header data-v-6d1fbf98"><text class="page-title data-v-6d1fbf98">合坛法会项目管理</text><text class="page-desc data-v-6d1fbf98">管理合坛法会项目及其详细配置</text><button data-event-opts="{{[['tap',[['showAddModal',['$event']]]]]}}" class="add-btn data-v-6d1fbf98" bindtap="__e">+ 新增项目</button></view><view class="projects-list data-v-6d1fbf98"><block wx:for="{{$root.l0}}" wx:for-item="project" wx:for-index="index" wx:key="_id"><view class="project-card data-v-6d1fbf98"><view class="project-header data-v-6d1fbf98"><view class="project-info data-v-6d1fbf98"><text class="project-name data-v-6d1fbf98">{{project.$orig.name}}</text><text class="project-category data-v-6d1fbf98">{{project.$orig.category}}</text></view><view class="project-price data-v-6d1fbf98">{{"¥"+project.$orig.price+"/人"}}</view></view><view class="project-desc data-v-6d1fbf98">{{project.$orig.description}}</view><view class="project-details data-v-6d1fbf98"><view class="detail-item data-v-6d1fbf98"><text class="detail-label data-v-6d1fbf98">截止日期：</text><text class="detail-value data-v-6d1fbf98">{{project.$orig.deadline}}</text></view><view class="detail-item data-v-6d1fbf98"><text class="detail-label data-v-6d1fbf98">最大人数：</text><text class="detail-value data-v-6d1fbf98">{{project.$orig.maxApplicants||'不限'}}</text></view><view class="detail-item data-v-6d1fbf98"><text class="detail-label data-v-6d1fbf98">可选日期：</text><text class="detail-value data-v-6d1fbf98">{{project.$orig.dates?project.g0:'待定'}}</text></view></view><view class="project-actions data-v-6d1fbf98"><button data-event-opts="{{[['tap',[['editProject',[index]]]]]}}" class="action-btn edit data-v-6d1fbf98" bindtap="__e">编辑</button><button data-event-opts="{{[['tap',[['manageGoods',['$0'],[[['projects','_id',project.$orig._id,'_id']]]]]]]}}" class="action-btn goods data-v-6d1fbf98" bindtap="__e">物品</button><button data-event-opts="{{[['tap',[['deleteProject',['$0'],[[['projects','_id',project.$orig._id,'_id']]]]]]]}}" class="action-btn delete data-v-6d1fbf98" bindtap="__e">删除</button></view></view></block></view><block wx:if="{{showForm}}"><view class="form-content form-vertical form-inline-below data-v-6d1fbf98"><view class="form-header data-v-6d1fbf98"><text class="form-title data-v-6d1fbf98">{{isEdit?'编辑项目':'新增项目'}}</text><text data-event-opts="{{[['tap',[['closeModal',['$event']]]]]}}" class="form-close data-v-6d1fbf98" bindtap="__e">×</text></view><view class="form-group data-v-6d1fbf98"><text class="form-label data-v-6d1fbf98">项目名称 *</text><input class="form-input data-v-6d1fbf98" placeholder="请输入项目名称" maxlength="30" data-event-opts="{{[['input',[['__set_model',['$0','name','$event',[]],['current']]]]]}}" value="{{current.name}}" bindinput="__e"/></view><view class="form-group data-v-6d1fbf98"><text class="form-label data-v-6d1fbf98">项目描述</text><textarea class="form-textarea data-v-6d1fbf98" placeholder="请输入项目描述" maxlength="200" data-event-opts="{{[['input',[['__set_model',['$0','description','$event',[]],['current']]]]]}}" value="{{current.description}}" bindinput="__e"></textarea></view><view class="form-group data-v-6d1fbf98"><text class="form-label data-v-6d1fbf98">项目分类 *</text><picker range="{{categoryOptions}}" value="{{categoryIndex}}" data-event-opts="{{[['change',[['onCategoryChange',['$event']]]]]}}" bindchange="__e" class="data-v-6d1fbf98"><view class="form-picker data-v-6d1fbf98"><text class="picker-value data-v-6d1fbf98">{{current.category||'请选择分类'}}</text><text class="picker-arrow data-v-6d1fbf98">▼</text></view></picker></view><view class="form-group data-v-6d1fbf98"><text class="form-label data-v-6d1fbf98">法金价格 *</text><input class="form-input data-v-6d1fbf98" type="number" placeholder="请输入法金价格" min="0" data-event-opts="{{[['input',[['__set_model',['$0','price','$event',['number']],['current']]]],['blur',[['$forceUpdate']]]]}}" value="{{current.price}}" bindinput="__e" bindblur="__e"/></view><view class="form-group data-v-6d1fbf98"><text class="form-label data-v-6d1fbf98">报名截止时间 *</text><picker mode="date" value="{{current.deadline}}" data-event-opts="{{[['change',[['onDeadlineChange',['$event']]]]]}}" bindchange="__e" class="data-v-6d1fbf98"><view class="form-picker data-v-6d1fbf98"><text class="picker-value data-v-6d1fbf98">{{current.deadline||'请选择截止日期'}}</text><text class="picker-arrow data-v-6d1fbf98">▼</text></view></picker></view><view class="form-group data-v-6d1fbf98"><text class="form-label data-v-6d1fbf98">可选日期 *</text><view class="date-list-vertical data-v-6d1fbf98"><block wx:for="{{current.dates}}" wx:for-item="date" wx:for-index="i" wx:key="i"><view class="date-item-vertical data-v-6d1fbf98"><input class="date-input data-v-6d1fbf98" placeholder="YYYY-MM-DD" data-event-opts="{{[['input',[['__set_model',['$0',i,'$event',[]],['current.dates']]]]]}}" value="{{current.dates[i]}}" bindinput="__e"/><button data-event-opts="{{[['tap',[['removeDate',[i]]]]]}}" class="remove-btn data-v-6d1fbf98" bindtap="__e">删除</button></view></block><button data-event-opts="{{[['tap',[['addDate',['$event']]]]]}}" class="add-date-btn data-v-6d1fbf98" bindtap="__e">+ 添加日期</button></view></view><view class="form-group data-v-6d1fbf98"><text class="form-label data-v-6d1fbf98">最大报名人数</text><input class="form-input data-v-6d1fbf98" type="number" placeholder="不填为不限" data-event-opts="{{[['input',[['__set_model',['$0','maxApplicants','$event',['number']],['current']]]],['blur',[['$forceUpdate']]]]}}" value="{{current.maxApplicants}}" bindinput="__e" bindblur="__e"/></view><view class="form-actions form-actions-center data-v-6d1fbf98"><button data-event-opts="{{[['tap',[['closeModal',['$event']]]]]}}" class="cancel-btn data-v-6d1fbf98" bindtap="__e">取消</button><button data-event-opts="{{[['tap',[['saveProject',['$event']]]]]}}" class="save-btn data-v-6d1fbf98" bindtap="__e">保存</button></view></view></block><block wx:if="{{showForm&&showDatePickerInline}}"><view class="date-picker-inline data-v-6d1fbf98"><view class="date-popup-header data-v-6d1fbf98"><text class="date-popup-title data-v-6d1fbf98">选择日期</text><text data-event-opts="{{[['tap',[['closeDatePicker',['$event']]]]]}}" class="date-popup-close data-v-6d1fbf98" bindtap="__e">×</text></view><picker mode="date" value="{{newDate}}" data-event-opts="{{[['change',[['onDateAdd',['$event']]]]]}}" bindchange="__e" class="data-v-6d1fbf98"><view class="date-picker data-v-6d1fbf98">{{''+(newDate||'请选择日期')+''}}</view></picker><view class="date-popup-actions data-v-6d1fbf98"><button data-event-opts="{{[['tap',[['closeDatePicker',['$event']]]]]}}" class="cancel-btn data-v-6d1fbf98" bindtap="__e">取消</button><button data-event-opts="{{[['tap',[['addDate',['$event']]]]]}}" class="confirm-btn data-v-6d1fbf98" bindtap="__e">确认</button></view></view></block></view></view>