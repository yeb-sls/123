<view class="admin-container data-v-f4037574"><view class="page-header data-v-f4037574"><text class="page-title data-v-f4037574">合坛法会项目管理</text><text class="page-desc data-v-f4037574">管理合坛法会项目及其详细配置</text><button data-event-opts="{{[['tap',[['showAddModal',['$event']]]]]}}" class="add-btn data-v-f4037574" bindtap="__e">+ 新增项目</button></view><view class="project-list data-v-f4037574"><block wx:for="{{$root.l0}}" wx:for-item="item" wx:for-index="idx" wx:key="_id"><view class="project-card data-v-f4037574"><view class="project-info data-v-f4037574"><text class="project-name data-v-f4037574">{{item.$orig.name}}</text><text class="project-desc data-v-f4037574">{{item.$orig.description}}</text><text class="project-dates data-v-f4037574">{{"日期："+(item.$orig.dates?item.g0:'')}}</text><text class="project-max data-v-f4037574">{{"人数上限："+(item.$orig.maxApplicants||'不限')}}</text><block wx:if="{{item.g1}}"><text class="project-goods data-v-f4037574">{{"代办物品："+item.g2}}</text></block><text class="project-receiver data-v-f4037574">{{"收件信息："+(item.$orig.needReceiver?'需要':'不需要')}}</text><text class="project-category data-v-f4037574">{{"分类："+(item.$orig.category||'未分类')}}</text><text class="project-deadline data-v-f4037574">{{"截止："+(item.$orig.deadline||'未设置')}}</text></view><view class="project-actions data-v-f4037574"><button data-event-opts="{{[['tap',[['editProject',[idx]]]]]}}" class="edit-btn data-v-f4037574" bindtap="__e">编辑</button><button data-event-opts="{{[['tap',[['deleteProject',['$0'],[[['projects','_id',item.$orig._id,'_id']]]]]]]}}" class="delete-btn data-v-f4037574" bindtap="__e">删除</button></view></view></block></view><uni-popup vue-id="39cae480-1" show="{{showPopup}}" type="center" data-event-opts="{{[['^close',[['closePopup']]]]}}" bind:close="__e" class="data-v-f4037574" bind:__l="__l" vue-slots="{{['default']}}"><view class="popup-content data-v-f4037574"><view class="popup-header data-v-f4037574"><text class="popup-title data-v-f4037574">{{isEdit?'编辑项目':'新增项目'}}</text><button data-event-opts="{{[['tap',[['closePopup',['$event']]]]]}}" class="close-btn data-v-f4037574" bindtap="__e">×</button></view><view class="form-group data-v-f4037574"><text class="form-label data-v-f4037574">项目名称 *</text><input class="form-input data-v-f4037574" placeholder="请输入项目名称" maxlength="30" data-event-opts="{{[['input',[['__set_model',['$0','name','$event',[]],['current']]]]]}}" value="{{current.name}}" bindinput="__e"/></view><view class="form-group data-v-f4037574"><text class="form-label data-v-f4037574">项目描述</text><textarea class="form-textarea data-v-f4037574" placeholder="请输入项目描述" maxlength="200" data-event-opts="{{[['input',[['__set_model',['$0','description','$event',[]],['current']]]]]}}" value="{{current.description}}" bindinput="__e"></textarea></view><view class="form-group data-v-f4037574"><text class="form-label data-v-f4037574">项目分类 *</text><picker range="{{categoryOptions}}" value="{{$root.g3}}" data-event-opts="{{[['change',[['onCategoryChange',['$event']]]]]}}" bindchange="__e" class="data-v-f4037574"><view class="picker data-v-f4037574"><text class="picker-value data-v-f4037574">{{current.category||'请选择分类'}}</text><text class="picker-arrow data-v-f4037574">▼</text></view></picker></view><view class="form-group data-v-f4037574"><text class="form-label data-v-f4037574">项目金额（法金） *</text><input class="form-input data-v-f4037574" type="number" placeholder="请输入金额" min="0" data-event-opts="{{[['input',[['__set_model',['$0','price','$event',['number']],['current']]]],['blur',[['$forceUpdate']]]]}}" value="{{current.price}}" bindinput="__e" bindblur="__e"/></view><view class="form-group data-v-f4037574"><text class="form-label data-v-f4037574">报名截止时间 *</text><picker mode="date" value="{{current.deadline}}" data-event-opts="{{[['change',[['onDeadlineChange',['$event']]]]]}}" bindchange="__e" class="data-v-f4037574"><view class="picker data-v-f4037574"><text class="picker-value data-v-f4037574">{{current.deadline||'请选择截止日期'}}</text><text class="picker-arrow data-v-f4037574">▼</text></view></picker></view><view class="form-group data-v-f4037574"><text class="form-label data-v-f4037574">可选日期 *</text><view class="date-list data-v-f4037574"><block wx:for="{{current.dates}}" wx:for-item="date" wx:for-index="i" wx:key="i"><view class="date-item data-v-f4037574"><input class="date-input data-v-f4037574" placeholder="YYYY-MM-DD" data-event-opts="{{[['input',[['__set_model',['$0',i,'$event',[]],['current.dates']]]]]}}" value="{{current.dates[i]}}" bindinput="__e"/><button data-event-opts="{{[['tap',[['removeDate',[i]]]]]}}" class="remove-btn data-v-f4037574" bindtap="__e">删除</button></view></block><button data-event-opts="{{[['tap',[['addDate',['$event']]]]]}}" class="add-date-btn data-v-f4037574" bindtap="__e">+ 添加日期</button></view></view><view class="form-group data-v-f4037574"><text class="form-label data-v-f4037574">报名人数上限</text><input class="form-input data-v-f4037574" type="number" placeholder="不填为不限" data-event-opts="{{[['input',[['__set_model',['$0','maxApplicants','$event',['number']],['current']]]],['blur',[['$forceUpdate']]]]}}" value="{{current.maxApplicants}}" bindinput="__e" bindblur="__e"/></view><view class="form-group data-v-f4037574"><text class="form-label data-v-f4037574">代办物品</text><view class="goods-list data-v-f4037574"><block wx:for="{{current.goods}}" wx:for-item="g" wx:for-index="i" wx:key="i"><view class="goods-item data-v-f4037574"><input class="goods-input data-v-f4037574" placeholder="物品名称" data-event-opts="{{[['input',[['__set_model',['$0','name','$event',[]],[[['current.goods','',i]]]]]]]}}" value="{{g.name}}" bindinput="__e"/><input class="goods-input data-v-f4037574" type="number" placeholder="单价" data-event-opts="{{[['input',[['__set_model',['$0','price','$event',['number']],[[['current.goods','',i]]]]]],['blur',[['$forceUpdate']]]]}}" value="{{g.price}}" bindinput="__e" bindblur="__e"/><button data-event-opts="{{[['tap',[['removeGoods',[i]]]]]}}" class="remove-btn data-v-f4037574" bindtap="__e">删除</button></view></block><button data-event-opts="{{[['tap',[['addGoods',['$event']]]]]}}" class="add-goods-btn data-v-f4037574" bindtap="__e">+ 添加物品</button></view></view><view class="form-group data-v-f4037574"><text class="form-label data-v-f4037574">是否需要收件信息</text><switch checked="{{current.needReceiver}}" data-event-opts="{{[['change',[['e0',['$event']]]]]}}" bindchange="__e" class="data-v-f4037574"></switch></view><view class="form-group data-v-f4037574"><button data-event-opts="{{[['tap',[['saveProject',['$event']]]]]}}" class="popup-btn primary data-v-f4037574" bindtap="__e">保存</button></view></view></uni-popup></view>