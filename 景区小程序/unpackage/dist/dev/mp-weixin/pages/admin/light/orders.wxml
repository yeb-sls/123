<view class="admin-container data-v-369509f7"><view class="page-header data-v-369509f7"><view class="header-content data-v-369509f7"><view class="header-left data-v-369509f7"><text class="page-title data-v-369509f7">供灯订单管理</text><text class="page-desc data-v-369509f7">查看和管理供灯祈福订单</text></view><view class="header-actions data-v-369509f7"><button data-event-opts="{{[['tap',[['exportOrders',['$event']]]]]}}" class="export-btn data-v-369509f7" bindtap="__e"><text class="btn-icon data-v-369509f7">📊</text><text class="data-v-369509f7">导出订单</text></button></view></view></view><view class="stats-card data-v-369509f7"><view class="stat-item data-v-369509f7"><text class="stat-number data-v-369509f7">{{$root.g0}}</text><text class="stat-label data-v-369509f7">总订单数</text></view><view class="stat-item data-v-369509f7"><text class="stat-number data-v-369509f7">{{pendingCount}}</text><text class="stat-label data-v-369509f7">待处理</text></view><view class="stat-item data-v-369509f7"><text class="stat-number data-v-369509f7">{{completedCount}}</text><text class="stat-label data-v-369509f7">已完成</text></view><view class="stat-item data-v-369509f7"><text class="stat-number data-v-369509f7">{{totalRevenue}}</text><text class="stat-label data-v-369509f7">总收入(元)</text></view></view><view class="filter-section data-v-369509f7"><view class="filter-group data-v-369509f7"><text class="filter-label data-v-369509f7">状态筛选：</text><picker class="filter-picker data-v-369509f7" value="{{statusIndex}}" range="{{statusOptions}}" data-event-opts="{{[['change',[['onStatusChange',['$event']]]]]}}" bindchange="__e"><view class="picker-display data-v-369509f7"><text class="data-v-369509f7">{{statusOptions[statusIndex]}}</text><text class="picker-arrow data-v-369509f7">▼</text></view></picker></view></view><view class="orders-list data-v-369509f7"><view class="list-header data-v-369509f7"><text class="list-title data-v-369509f7">💡 供灯订单列表</text><text class="list-subtitle data-v-369509f7">{{"共 "+$root.g1+" 个订单"}}</text></view><block wx:if="{{$root.g2===0}}"><view class="empty-state data-v-369509f7"><text class="empty-icon data-v-369509f7">💡</text><text class="empty-title data-v-369509f7">暂无订单</text><text class="empty-desc data-v-369509f7">当前筛选条件下没有找到订单</text></view></block><block wx:else><view class="order-items data-v-369509f7"><block wx:for="{{$root.l0}}" wx:for-item="order" wx:for-index="index" wx:key="_id"><view class="{{['order-item','data-v-369509f7',(order.$orig.status==='待处理')?'order-pending':'',(order.$orig.status==='已完成')?'order-completed':'']}}"><view class="order-info data-v-369509f7"><view class="info-header data-v-369509f7"><text class="order-id data-v-369509f7">{{"订单号："+order.$orig.orderNo}}</text><text class="{{['order-status','data-v-369509f7',order.$orig.status==='待处理'?'status-pending':'status-completed']}}">{{order.$orig.status}}</text></view><view class="order-details data-v-369509f7"><view class="detail-row data-v-369509f7"><text class="detail-label data-v-369509f7">供灯人：</text><text class="detail-value data-v-369509f7">{{order.$orig.applicantName}}</text></view><view class="detail-row data-v-369509f7"><text class="detail-label data-v-369509f7">灯塔：</text><text class="detail-value data-v-369509f7">{{order.$orig.towerName}}</text></view><view class="detail-row data-v-369509f7"><text class="detail-label data-v-369509f7">楼层：</text><text class="detail-value data-v-369509f7">{{order.$orig.floorName}}</text></view><view class="detail-row data-v-369509f7"><text class="detail-label data-v-369509f7">许愿语：</text><text class="detail-value data-v-369509f7">{{order.$orig.wish||'无'}}</text></view><view class="detail-row data-v-369509f7"><text class="detail-label data-v-369509f7">功德金：</text><text class="detail-value price data-v-369509f7">{{"¥"+order.$orig.amount}}</text></view><view class="detail-row data-v-369509f7"><text class="detail-label data-v-369509f7">创建时间：</text><text class="detail-value data-v-369509f7">{{order.m0}}</text></view></view><view class="order-actions data-v-369509f7"><view class="action-group data-v-369509f7"><button data-event-opts="{{[['tap',[['viewOrderDetail',['$0'],[[['filteredOrders','_id',order.$orig._id]]]]]]]}}" class="detail-btn data-v-369509f7" bindtap="__e"><text class="action-icon data-v-369509f7">👁️</text><text class="data-v-369509f7">查看详情</text></button><block wx:if="{{order.$orig.status==='待处理'}}"><button data-event-opts="{{[['tap',[['completeOrder',['$0'],[[['filteredOrders','_id',order.$orig._id]]]]]]]}}" class="complete-btn data-v-369509f7" bindtap="__e"><text class="action-icon data-v-369509f7">✅</text><text class="data-v-369509f7">确认完成</text></button></block></view><view class="note-section data-v-369509f7"><input class="note-input data-v-369509f7" placeholder="添加备注..." data-event-opts="{{[['blur',[['updateOrderNote',['$0'],[[['filteredOrders','_id',order.$orig._id]]]]]],['input',[['__set_model',['$0','note','$event',[]],[[['filteredOrders','_id',order.$orig._id]]]]]]]}}" value="{{order.$orig.note}}" bindblur="__e" bindinput="__e"/></view></view></view></view></block></view></block></view><uni-popup vue-id="c7e69422-1" show="{{showDetailPopup}}" type="center" data-event-opts="{{[['^close',[['closeDetailPopup']]]]}}" bind:close="__e" class="data-v-369509f7" bind:__l="__l" vue-slots="{{['default']}}"><view class="popup-content detail-popup data-v-369509f7"><view class="popup-header data-v-369509f7"><text class="popup-title data-v-369509f7">订单详情</text><button data-event-opts="{{[['tap',[['closeDetailPopup',['$event']]]]]}}" class="close-btn data-v-369509f7" bindtap="__e">×</button></view><block wx:if="{{currentOrder}}"><view class="detail-container data-v-369509f7"><view class="detail-section data-v-369509f7"><text class="section-title data-v-369509f7">基本信息</text><view class="detail-grid data-v-369509f7"><view class="detail-item data-v-369509f7"><text class="item-label data-v-369509f7">订单号</text><text class="item-value data-v-369509f7">{{currentOrder.orderNo}}</text></view><view class="detail-item data-v-369509f7"><text class="item-label data-v-369509f7">状态</text><text class="{{['item-value','data-v-369509f7',currentOrder.status==='待处理'?'status-pending':'status-completed']}}">{{currentOrder.status}}</text></view><view class="detail-item data-v-369509f7"><text class="item-label data-v-369509f7">供灯人</text><text class="item-value data-v-369509f7">{{currentOrder.applicantName}}</text></view><view class="detail-item data-v-369509f7"><text class="item-label data-v-369509f7">联系电话</text><text class="item-value data-v-369509f7">{{currentOrder.phone}}</text></view></view></view><view class="detail-section data-v-369509f7"><text class="section-title data-v-369509f7">供灯信息</text><view class="detail-grid data-v-369509f7"><view class="detail-item data-v-369509f7"><text class="item-label data-v-369509f7">灯塔</text><text class="item-value data-v-369509f7">{{currentOrder.towerName}}</text></view><view class="detail-item data-v-369509f7"><text class="item-label data-v-369509f7">楼层</text><text class="item-value data-v-369509f7">{{currentOrder.floorName}}</text></view><view class="detail-item data-v-369509f7"><text class="item-label data-v-369509f7">许愿语</text><text class="item-value data-v-369509f7">{{currentOrder.wish||'无'}}</text></view><view class="detail-item data-v-369509f7"><text class="item-label data-v-369509f7">功德金</text><text class="item-value price data-v-369509f7">{{"¥"+currentOrder.amount}}</text></view></view></view><block wx:if="{{currentOrder.receiverInfo}}"><view class="detail-section data-v-369509f7"><text class="section-title data-v-369509f7">收件信息</text><view class="detail-grid data-v-369509f7"><view class="detail-item data-v-369509f7"><text class="item-label data-v-369509f7">收件人</text><text class="item-value data-v-369509f7">{{currentOrder.receiverInfo.name}}</text></view><view class="detail-item data-v-369509f7"><text class="item-label data-v-369509f7">联系电话</text><text class="item-value data-v-369509f7">{{currentOrder.receiverInfo.phone}}</text></view><view class="detail-item data-v-369509f7"><text class="item-label data-v-369509f7">收件地址</text><text class="item-value data-v-369509f7">{{currentOrder.receiverInfo.address}}</text></view></view></view></block><view class="detail-section data-v-369509f7"><text class="section-title data-v-369509f7">时间信息</text><view class="detail-grid data-v-369509f7"><view class="detail-item data-v-369509f7"><text class="item-label data-v-369509f7">创建时间</text><text class="item-value data-v-369509f7">{{$root.m1}}</text></view><block wx:if="{{currentOrder.completeTime}}"><view class="detail-item data-v-369509f7"><text class="item-label data-v-369509f7">完成时间</text><text class="item-value data-v-369509f7">{{$root.m2}}</text></view></block></view></view></view></block></view></uni-popup><block wx:if="{{loading}}"><view class="loading-overlay data-v-369509f7"><view class="loading-content data-v-369509f7"><text class="loading-icon data-v-369509f7">⏳</text><text class="loading-text data-v-369509f7">加载中...</text></view></view></block></view>