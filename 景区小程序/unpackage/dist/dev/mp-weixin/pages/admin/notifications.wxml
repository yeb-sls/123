<view class="admin-container data-v-8ef43982"><view class="page-header data-v-8ef43982"><text class="page-title data-v-8ef43982">管理员通知</text><text class="page-desc data-v-8ef43982">查看系统通知和提醒</text><view class="header-actions data-v-8ef43982"><button data-event-opts="{{[['tap',[['markAllAsRead',['$event']]]]]}}" class="mark-all-read-btn data-v-8ef43982" bindtap="__e">全部已读</button><button data-event-opts="{{[['tap',[['loadNotifications',['$event']]]]]}}" class="refresh-btn data-v-8ef43982" bindtap="__e">刷新</button><button data-event-opts="{{[['tap',[['toggleDebugInfo',['$event']]]]]}}" class="debug-btn data-v-8ef43982" bindtap="__e">调试信息</button></view></view><block wx:if="{{showDebug}}"><view class="debug-section data-v-8ef43982"><view class="debug-header data-v-8ef43982"><text class="debug-title data-v-8ef43982">🔧 调试信息</text><button data-event-opts="{{[['tap',[['hideDebugInfo',['$event']]]]]}}" class="close-debug-btn data-v-8ef43982" bindtap="__e">关闭</button></view><view class="debug-content data-v-8ef43982"><view class="debug-item data-v-8ef43982"><text class="debug-label data-v-8ef43982">通知总数：</text><text class="debug-value data-v-8ef43982">{{$root.g0}}</text></view><view class="debug-item data-v-8ef43982"><text class="debug-label data-v-8ef43982">未读数量：</text><text class="debug-value data-v-8ef43982">{{unreadCount}}</text></view><view class="debug-item data-v-8ef43982"><text class="debug-label data-v-8ef43982">有订单号的通知：</text><text class="debug-value data-v-8ef43982">{{$root.g1}}</text></view><view class="debug-item data-v-8ef43982"><text class="debug-label data-v-8ef43982">通知类型统计：</text><text class="debug-value data-v-8ef43982">{{notificationTypeStats}}</text></view><view class="debug-item data-v-8ef43982"><text class="debug-label data-v-8ef43982">最后更新时间：</text><text class="debug-value data-v-8ef43982">{{lastUpdateTime}}</text></view><view class="debug-item data-v-8ef43982"><text class="debug-label data-v-8ef43982">云对象状态：</text><text class="debug-value data-v-8ef43982">{{cloudObjectStatus}}</text></view></view><view class="debug-details data-v-8ef43982"><text class="debug-subtitle data-v-8ef43982">📋 通知详细数据</text><block wx:for="{{$root.l0}}" wx:for-item="notification" wx:for-index="index" wx:key="index"><view class="debug-notification data-v-8ef43982"><text class="debug-notification-title data-v-8ef43982">{{"通知 "+(index+1)+":"}}</text><view class="debug-notification-data data-v-8ef43982"><text class="debug-data-item data-v-8ef43982">{{"ID: "+notification.$orig._id}}</text><text class="debug-data-item data-v-8ef43982">{{"标题: "+notification.$orig.title}}</text><text class="debug-data-item data-v-8ef43982">{{"类型: "+notification.$orig.type}}</text><text class="debug-data-item data-v-8ef43982">{{"order_id: "+(notification.$orig.order_id||'undefined')}}</text><text class="debug-data-item data-v-8ef43982">{{"orderNo: "+(notification.$orig.orderNo||'undefined')}}</text><text class="debug-data-item data-v-8ef43982">{{"已读: "+(notification.$orig.is_read?'是':'否')}}</text><text class="debug-data-item data-v-8ef43982">{{"创建时间: "+notification.m0}}</text></view></view></block></view></view></block><view class="notifications-list data-v-8ef43982"><block wx:for="{{$root.l1}}" wx:for-item="notification" wx:for-index="__i0__" wx:key="_id"><view class="{{['notification-card','data-v-8ef43982',(!notification.$orig.is_read)?'unread':'']}}"><view class="notification-header data-v-8ef43982"><view class="notification-info data-v-8ef43982"><text class="notification-title data-v-8ef43982">{{notification.$orig.title}}</text><text class="notification-time data-v-8ef43982">{{notification.m1}}</text></view><view class="notification-status data-v-8ef43982"><block wx:if="{{!notification.$orig.is_read}}"><text class="unread-badge data-v-8ef43982">未读</text></block><block wx:if="{{notification.$orig.priority==='high'}}"><text class="priority-badge data-v-8ef43982">重要</text></block></view></view><view class="notification-content data-v-8ef43982"><text class="content-text data-v-8ef43982">{{notification.$orig.content}}</text><block wx:if="{{notification.$orig.order_id}}"><view class="order-info data-v-8ef43982"><text class="order-label data-v-8ef43982">订单号：</text><text class="order-number data-v-8ef43982">{{notification.$orig.order_id}}</text></view></block><block wx:if="{{notification.$orig.orderNo}}"><view class="order-info data-v-8ef43982"><text class="order-label data-v-8ef43982">订单号：</text><text class="order-number data-v-8ef43982">{{notification.$orig.orderNo}}</text></view></block></view><view class="notification-actions data-v-8ef43982"><block wx:if="{{!notification.$orig.is_read}}"><button data-event-opts="{{[['tap',[['markAsRead',['$0'],[[['notifications','_id',notification.$orig._id,'_id']]]]]]]}}" class="mark-read-btn data-v-8ef43982" bindtap="__e">标记已读</button></block><block wx:if="{{notification.$orig.type==='joint_order_paid'}}"><button data-event-opts="{{[['tap',[['viewOrder',['$0'],[[['notifications','_id',notification.$orig._id,'order_id']]]]]]]}}" class="view-order-btn data-v-8ef43982" bindtap="__e">查看订单</button></block></view></view></block><block wx:if="{{$root.g2===0}}"><view class="empty-state data-v-8ef43982"><text class="empty-text data-v-8ef43982">暂无通知</text></view></block></view></view>