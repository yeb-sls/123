<view class="admin-container data-v-7318ea34"><view class="page-header data-v-7318ea34"><view class="header-content data-v-7318ea34"><view class="header-left data-v-7318ea34"><text class="page-title data-v-7318ea34">活动配置管理</text><text class="page-desc data-v-7318ea34">管理活动项目和报名配置</text></view><view class="header-actions data-v-7318ea34"><button data-event-opts="{{[['tap',[['showAddModal',['$event']]]]]}}" class="add-btn data-v-7318ea34" bindtap="__e"><text class="btn-icon data-v-7318ea34">➕</text><text class="data-v-7318ea34">添加活动</text></button></view></view></view><view class="stats-card data-v-7318ea34"><view class="stat-item data-v-7318ea34"><text class="stat-number data-v-7318ea34">{{$root.g0}}</text><text class="stat-label data-v-7318ea34">总活动数</text></view><view class="stat-item data-v-7318ea34"><text class="stat-number data-v-7318ea34">{{enabledCount}}</text><text class="stat-label data-v-7318ea34">已启用</text></view><view class="stat-item data-v-7318ea34"><text class="stat-number data-v-7318ea34">{{disabledCount}}</text><text class="stat-label data-v-7318ea34">已禁用</text></view></view><view class="activity-list data-v-7318ea34"><view class="list-header data-v-7318ea34"><text class="list-title data-v-7318ea34">🎯 活动项目列表</text><text class="list-subtitle data-v-7318ea34">{{"共 "+$root.g1+" 个活动"}}</text></view><block wx:if="{{$root.g2===0}}"><view class="empty-state data-v-7318ea34"><text class="empty-icon data-v-7318ea34">🎯</text><text class="empty-title data-v-7318ea34">暂无活动</text><text class="empty-desc data-v-7318ea34">点击上方"添加活动"按钮开始创建</text><button data-event-opts="{{[['tap',[['showAddModal',['$event']]]]]}}" class="empty-btn data-v-7318ea34" bindtap="__e">添加第一个活动</button></view></block><block wx:else><view class="activity-items data-v-7318ea34"><block wx:for="{{activityItems}}" wx:for-item="item" wx:for-index="index" wx:key="_id"><view class="{{['activity-item','data-v-7318ea34',(item.status!=='启用')?'activity-disabled':'']}}"><view class="activity-info data-v-7318ea34"><view class="info-header data-v-7318ea34"><text class="activity-title data-v-7318ea34">{{item.name||'未设置名称'}}</text><text class="activity-price data-v-7318ea34">{{"¥"+item.price}}</text></view><text class="activity-desc data-v-7318ea34">{{item.description||'未设置描述'}}</text><view class="activity-meta data-v-7318ea34"><text class="activity-time data-v-7318ea34">{{"时间："+item.startTime+" - "+item.endTime}}</text><text class="activity-limit data-v-7318ea34">{{"人数限制："+(item.maxParticipants||'无限制')}}</text></view><text class="activity-category data-v-7318ea34">{{"类型："+(item.needShipping?'需要邮寄':'无需邮寄')}}</text><view class="activity-actions data-v-7318ea34"><view class="action-group data-v-7318ea34"><button data-event-opts="{{[['tap',[['editActivityItem',[index]]]]]}}" class="edit-btn data-v-7318ea34" bindtap="__e"><text class="action-icon data-v-7318ea34">✏️</text><text class="data-v-7318ea34">编辑</text></button><button data-event-opts="{{[['tap',[['deleteActivityItem',[index]]]]]}}" class="delete-btn data-v-7318ea34" bindtap="__e"><text class="action-icon data-v-7318ea34">🗑️</text><text class="data-v-7318ea34">删除</text></button></view><view class="toggle-group data-v-7318ea34"><text class="toggle-label data-v-7318ea34">状态</text><switch checked="{{item.status==='启用'}}" color="#007aff" data-event-opts="{{[['change',[['toggleActivityItemStatus',['$0','$event'],[[['activityItems','_id',item._id]]]]]]]}}" bindchange="__e" class="data-v-7318ea34"></switch></view></view></view></view></block></view></block></view><uni-popup vue-id="07fe52e0-1" show="{{showActivityPopup}}" type="center" data-event-opts="{{[['^close',[['closePopup']]]]}}" bind:close="__e" class="data-v-7318ea34" bind:__l="__l" vue-slots="{{['default']}}"><view class="popup-content data-v-7318ea34"><view class="popup-header data-v-7318ea34"><text class="popup-title data-v-7318ea34">{{isEdit?'编辑活动':'添加活动'}}</text><button data-event-opts="{{[['tap',[['closePopup',['$event']]]]]}}" class="close-btn data-v-7318ea34" bindtap="__e">×</button></view><view class="form-container data-v-7318ea34"><view class="form-group data-v-7318ea34"><text class="form-label data-v-7318ea34">活动名称 *</text><input class="form-input data-v-7318ea34" placeholder="请输入活动名称" maxlength="50" data-event-opts="{{[['input',[['__set_model',['$0','name','$event',[]],['currentActivityItem']]]]]}}" value="{{currentActivityItem.name}}" bindinput="__e"/><text class="form-tip data-v-7318ea34">{{$root.g3+"/50"}}</text></view><view class="form-group data-v-7318ea34"><text class="form-label data-v-7318ea34">活动描述</text><textarea class="form-textarea data-v-7318ea34" placeholder="请输入活动描述" maxlength="200" data-event-opts="{{[['input',[['__set_model',['$0','description','$event',[]],['currentActivityItem']]]]]}}" value="{{currentActivityItem.description}}" bindinput="__e"></textarea><text class="form-tip data-v-7318ea34">{{$root.g4+"/200"}}</text></view><view class="form-group data-v-7318ea34"><text class="form-label data-v-7318ea34">开始时间 *</text><picker class="form-picker data-v-7318ea34" mode="date" value="{{currentActivityItem.startTime}}" data-event-opts="{{[['change',[['onStartTimeChange',['$event']]]]]}}" bindchange="__e"><view class="picker-display data-v-7318ea34"><text class="data-v-7318ea34">{{currentActivityItem.startTime||'请选择开始时间'}}</text><text class="picker-arrow data-v-7318ea34">▼</text></view></picker></view><view class="form-group data-v-7318ea34"><text class="form-label data-v-7318ea34">结束时间 *</text><picker class="form-picker data-v-7318ea34" mode="date" value="{{currentActivityItem.endTime}}" data-event-opts="{{[['change',[['onEndTimeChange',['$event']]]]]}}" bindchange="__e"><view class="picker-display data-v-7318ea34"><text class="data-v-7318ea34">{{currentActivityItem.endTime||'请选择结束时间'}}</text><text class="picker-arrow data-v-7318ea34">▼</text></view></picker></view><view class="form-group data-v-7318ea34"><text class="form-label data-v-7318ea34">活动费用 *</text><input class="form-input data-v-7318ea34" placeholder="请输入活动费用" type="number" data-event-opts="{{[['input',[['__set_model',['$0','price','$event',[]],['currentActivityItem']]]]]}}" value="{{currentActivityItem.price}}" bindinput="__e"/><text class="form-tip data-v-7318ea34">单位：元</text></view><view class="form-group data-v-7318ea34"><text class="form-label data-v-7318ea34">人数限制</text><input class="form-input data-v-7318ea34" placeholder="请输入人数限制（可选）" type="number" data-event-opts="{{[['input',[['__set_model',['$0','maxParticipants','$event',[]],['currentActivityItem']]]]]}}" value="{{currentActivityItem.maxParticipants}}" bindinput="__e"/><text class="form-tip data-v-7318ea34">留空表示无限制</text></view><view class="form-group data-v-7318ea34"><text class="form-label data-v-7318ea34">是否需要邮寄</text><switch checked="{{currentActivityItem.needShipping}}" color="#007aff" data-event-opts="{{[['change',[['onShippingChange',['$event']]]]]}}" bindchange="__e" class="data-v-7318ea34"></switch><text class="form-tip data-v-7318ea34">{{currentActivityItem.needShipping?'需要收集收件信息':'无需收集收件信息'}}</text></view></view><view class="popup-buttons data-v-7318ea34"><button data-event-opts="{{[['tap',[['closePopup',['$event']]]]]}}" class="popup-btn cancel-btn data-v-7318ea34" bindtap="__e">取消</button><button class="popup-btn primary-btn data-v-7318ea34" disabled="{{loading}}" data-event-opts="{{[['tap',[['saveActivityItem',['$event']]]]]}}" bindtap="__e"><block wx:if="{{loading}}"><text class="data-v-7318ea34">保存中...</text></block><block wx:else><text class="data-v-7318ea34">{{isEdit?'更新':'保存'}}</text></block></button></view></view></uni-popup><block wx:if="{{loading}}"><view class="loading-overlay data-v-7318ea34"><view class="loading-content data-v-7318ea34"><text class="loading-icon data-v-7318ea34">⏳</text><text class="loading-text data-v-7318ea34">加载中...</text></view></view></block></view>