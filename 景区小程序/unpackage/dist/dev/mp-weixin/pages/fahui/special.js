(global["webpackJsonp"] = global["webpackJsonp"] || []).push([["pages/fahui/special"],{

/***/ 304:
/*!****************************************************************************************************!*\
  !*** C:/Users/qub/Documents/HBuilderProjects/123/景区小程序/main.js?{"page":"pages%2Ffahui%2Fspecial"} ***!
  \****************************************************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
/* WEBPACK VAR INJECTION */(function(wx, createPage) {

var _interopRequireDefault = __webpack_require__(/*! @babel/runtime/helpers/interopRequireDefault */ 4);
__webpack_require__(/*! uni-pages */ 26);
__webpack_require__(/*! @dcloudio/vue-cli-plugin-uni/packages/uni-cloud/dist/index.js */ 27);
var _vue = _interopRequireDefault(__webpack_require__(/*! vue */ 25));
var _special = _interopRequireDefault(__webpack_require__(/*! ./pages/fahui/special.vue */ 305));
// @ts-ignore
wx.__webpack_require_UNI_MP_PLUGIN__ = __webpack_require__;
createPage(_special.default);
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(/*! ./node_modules/@dcloudio/uni-mp-weixin/dist/wx.js */ 1)["default"], __webpack_require__(/*! ./node_modules/@dcloudio/uni-mp-weixin/dist/index.js */ 3)["createPage"]))

/***/ }),

/***/ 305:
/*!*********************************************************************************!*\
  !*** C:/Users/qub/Documents/HBuilderProjects/123/景区小程序/pages/fahui/special.vue ***!
  \*********************************************************************************/
/*! no static exports found */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _special_vue_vue_type_template_id_497fb5e2_scoped_true___WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./special.vue?vue&type=template&id=497fb5e2&scoped=true& */ 306);
/* harmony import */ var _special_vue_vue_type_script_lang_js___WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./special.vue?vue&type=script&lang=js& */ 308);
/* harmony reexport (unknown) */ for(var __WEBPACK_IMPORT_KEY__ in _special_vue_vue_type_script_lang_js___WEBPACK_IMPORTED_MODULE_1__) if(["default"].indexOf(__WEBPACK_IMPORT_KEY__) < 0) (function(key) { __webpack_require__.d(__webpack_exports__, key, function() { return _special_vue_vue_type_script_lang_js___WEBPACK_IMPORTED_MODULE_1__[key]; }) }(__WEBPACK_IMPORT_KEY__));
/* harmony import */ var _special_vue_vue_type_style_index_0_id_497fb5e2_scoped_true_lang_css___WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./special.vue?vue&type=style&index=0&id=497fb5e2&scoped=true&lang=css& */ 310);
/* harmony import */ var _Desktop_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_runtime_componentNormalizer_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../../../../Desktop/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js */ 44);

var renderjs





/* normalize component */

var component = Object(_Desktop_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_runtime_componentNormalizer_js__WEBPACK_IMPORTED_MODULE_3__["default"])(
  _special_vue_vue_type_script_lang_js___WEBPACK_IMPORTED_MODULE_1__["default"],
  _special_vue_vue_type_template_id_497fb5e2_scoped_true___WEBPACK_IMPORTED_MODULE_0__["render"],
  _special_vue_vue_type_template_id_497fb5e2_scoped_true___WEBPACK_IMPORTED_MODULE_0__["staticRenderFns"],
  false,
  null,
  "497fb5e2",
  null,
  false,
  _special_vue_vue_type_template_id_497fb5e2_scoped_true___WEBPACK_IMPORTED_MODULE_0__["components"],
  renderjs
)

component.options.__file = "pages/fahui/special.vue"
/* harmony default export */ __webpack_exports__["default"] = (component.exports);

/***/ }),

/***/ 306:
/*!****************************************************************************************************************************!*\
  !*** C:/Users/qub/Documents/HBuilderProjects/123/景区小程序/pages/fahui/special.vue?vue&type=template&id=497fb5e2&scoped=true& ***!
  \****************************************************************************************************************************/
/*! exports provided: render, staticRenderFns, recyclableRender, components */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _Desktop_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_loaders_templateLoader_js_vue_loader_options_Desktop_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_17_0_Desktop_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_template_js_Desktop_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_uni_app_loader_page_meta_js_Desktop_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_index_js_vue_loader_options_Desktop_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_special_vue_vue_type_template_id_497fb5e2_scoped_true___WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! -!../../../../../../Desktop/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../../Desktop/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--17-0!../../../../../../Desktop/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../../Desktop/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../../../Desktop/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib??vue-loader-options!../../../../../../Desktop/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./special.vue?vue&type=template&id=497fb5e2&scoped=true& */ 307);
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "render", function() { return _Desktop_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_loaders_templateLoader_js_vue_loader_options_Desktop_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_17_0_Desktop_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_template_js_Desktop_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_uni_app_loader_page_meta_js_Desktop_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_index_js_vue_loader_options_Desktop_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_special_vue_vue_type_template_id_497fb5e2_scoped_true___WEBPACK_IMPORTED_MODULE_0__["render"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "staticRenderFns", function() { return _Desktop_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_loaders_templateLoader_js_vue_loader_options_Desktop_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_17_0_Desktop_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_template_js_Desktop_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_uni_app_loader_page_meta_js_Desktop_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_index_js_vue_loader_options_Desktop_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_special_vue_vue_type_template_id_497fb5e2_scoped_true___WEBPACK_IMPORTED_MODULE_0__["staticRenderFns"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "recyclableRender", function() { return _Desktop_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_loaders_templateLoader_js_vue_loader_options_Desktop_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_17_0_Desktop_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_template_js_Desktop_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_uni_app_loader_page_meta_js_Desktop_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_index_js_vue_loader_options_Desktop_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_special_vue_vue_type_template_id_497fb5e2_scoped_true___WEBPACK_IMPORTED_MODULE_0__["recyclableRender"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "components", function() { return _Desktop_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_loaders_templateLoader_js_vue_loader_options_Desktop_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_17_0_Desktop_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_template_js_Desktop_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_uni_app_loader_page_meta_js_Desktop_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_index_js_vue_loader_options_Desktop_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_special_vue_vue_type_template_id_497fb5e2_scoped_true___WEBPACK_IMPORTED_MODULE_0__["components"]; });



/***/ }),

/***/ 307:
/*!****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--17-0!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib??vue-loader-options!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!C:/Users/qub/Documents/HBuilderProjects/123/景区小程序/pages/fahui/special.vue?vue&type=template&id=497fb5e2&scoped=true& ***!
  \****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/*! exports provided: render, staticRenderFns, recyclableRender, components */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "render", function() { return render; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "staticRenderFns", function() { return staticRenderFns; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "recyclableRender", function() { return recyclableRender; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "components", function() { return components; });
var components
var render = function () {
  var _vm = this
  var _h = _vm.$createElement
  var _c = _vm._self._c || _h
  var l0 = _vm.__map(_vm.fahuiProjects, function (project, index) {
    var $orig = _vm.__get_orig(project)
    var m0 = _vm.getPriceText(project)
    var m1 = _vm.getRemainingText(project)
    return {
      $orig: $orig,
      m0: m0,
      m1: m1,
    }
  })
  var g0 =
    _vm.selectedProjectIndex === 0
      ? _vm.genderOptions.indexOf(_vm.spouse.gender)
      : null
  var g1 =
    _vm.selectedProjectIndex === 0
      ? _vm.birthTimeOptions.indexOf(_vm.spouse.birthTime)
      : null
  var g2 =
    _vm.selectedProjectIndex === 1
      ? _vm.chaoduTypes.indexOf(_vm.chaoduType)
      : null
  var l1 =
    _vm.selectedProjectIndex === 1
      ? _vm.__map(_vm.deceasedList, function (deceased, index) {
          var $orig = _vm.__get_orig(deceased)
          var g3 = _vm.deceasedList.length
          var g4 = _vm.relationOptions.indexOf(deceased.relation)
          return {
            $orig: $orig,
            g3: g3,
            g4: g4,
          }
        })
      : null
  var g5 = _vm.selectedProjectIndex === 1 ? _vm.deceasedList.length : null
  var l2 = _vm.showGoods
    ? _vm.__map(_vm.goodsList, function (item, index) {
        var $orig = _vm.__get_orig(item)
        var m2 = _vm.getGoodsPriceText(item)
        return {
          $orig: $orig,
          m2: m2,
        }
      })
    : null
  var m3 = _vm.showGoods ? _vm.getGoodsTotalPriceText() : null
  var g6 = _vm.showHistoryDialog ? _vm.filteredHistory.length : null
  var l3 =
    _vm.showHistoryDialog && !(g6 === 0)
      ? _vm.__map(_vm.filteredHistory, function (item, idx) {
          var $orig = _vm.__get_orig(item)
          var g7 = _vm.batchDeleteSet.has(idx)
          var m4 = _vm.getHistoryDetailText(item)
          var g8 = _vm.batchDeleteMode ? _vm.batchDeleteSet.has(idx) : null
          return {
            $orig: $orig,
            g7: g7,
            m4: m4,
            g8: g8,
          }
        })
      : null
  var m5 = _vm.showHistoryDialog ? _vm.getBatchDeleteButtonText() : null
  var m6 =
    _vm.showHistoryDialog && _vm.batchDeleteMode && _vm.batchDeleteSet.size
      ? _vm.getConfirmDeleteButtonText()
      : null
  if (!_vm._isMounted) {
    _vm.e0 = function ($event) {
      _vm.showHistoryDialog = false
    }
    _vm.e1 = function ($event, idx) {
      var _temp = arguments[arguments.length - 1].currentTarget.dataset,
        _temp2 = _temp.eventParams || _temp["event-params"],
        idx = _temp2.idx
      var _temp, _temp2
      _vm.hoverIdx = idx
    }
    _vm.e2 = function ($event) {
      _vm.hoverIdx = -1
    }
    _vm.e3 = function ($event) {
      _vm.showHistoryDialog = false
    }
  }
  _vm.$mp.data = Object.assign(
    {},
    {
      $root: {
        l0: l0,
        g0: g0,
        g1: g1,
        g2: g2,
        l1: l1,
        g5: g5,
        l2: l2,
        m3: m3,
        g6: g6,
        l3: l3,
        m5: m5,
        m6: m6,
      },
    }
  )
}
var recyclableRender = false
var staticRenderFns = []
render._withStripped = true



/***/ }),

/***/ 308:
/*!**********************************************************************************************************!*\
  !*** C:/Users/qub/Documents/HBuilderProjects/123/景区小程序/pages/fahui/special.vue?vue&type=script&lang=js& ***!
  \**********************************************************************************************************/
/*! no static exports found */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _Desktop_HBuilderX_plugins_uniapp_cli_node_modules_babel_loader_lib_index_js_Desktop_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_13_1_Desktop_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_script_js_Desktop_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_index_js_vue_loader_options_Desktop_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_special_vue_vue_type_script_lang_js___WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! -!../../../../../../Desktop/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib!../../../../../../Desktop/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--13-1!../../../../../../Desktop/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../Desktop/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib??vue-loader-options!../../../../../../Desktop/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./special.vue?vue&type=script&lang=js& */ 309);
/* harmony import */ var _Desktop_HBuilderX_plugins_uniapp_cli_node_modules_babel_loader_lib_index_js_Desktop_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_13_1_Desktop_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_script_js_Desktop_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_index_js_vue_loader_options_Desktop_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_special_vue_vue_type_script_lang_js___WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_Desktop_HBuilderX_plugins_uniapp_cli_node_modules_babel_loader_lib_index_js_Desktop_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_13_1_Desktop_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_script_js_Desktop_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_index_js_vue_loader_options_Desktop_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_special_vue_vue_type_script_lang_js___WEBPACK_IMPORTED_MODULE_0__);
/* harmony reexport (unknown) */ for(var __WEBPACK_IMPORT_KEY__ in _Desktop_HBuilderX_plugins_uniapp_cli_node_modules_babel_loader_lib_index_js_Desktop_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_13_1_Desktop_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_script_js_Desktop_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_index_js_vue_loader_options_Desktop_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_special_vue_vue_type_script_lang_js___WEBPACK_IMPORTED_MODULE_0__) if(["default"].indexOf(__WEBPACK_IMPORT_KEY__) < 0) (function(key) { __webpack_require__.d(__webpack_exports__, key, function() { return _Desktop_HBuilderX_plugins_uniapp_cli_node_modules_babel_loader_lib_index_js_Desktop_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_13_1_Desktop_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_script_js_Desktop_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_index_js_vue_loader_options_Desktop_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_special_vue_vue_type_script_lang_js___WEBPACK_IMPORTED_MODULE_0__[key]; }) }(__WEBPACK_IMPORT_KEY__));
 /* harmony default export */ __webpack_exports__["default"] = (_Desktop_HBuilderX_plugins_uniapp_cli_node_modules_babel_loader_lib_index_js_Desktop_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_13_1_Desktop_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_script_js_Desktop_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_index_js_vue_loader_options_Desktop_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_special_vue_vue_type_script_lang_js___WEBPACK_IMPORTED_MODULE_0___default.a); 

/***/ }),

/***/ 309:
/*!*****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/babel-loader/lib!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--13-1!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib??vue-loader-options!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!C:/Users/qub/Documents/HBuilderProjects/123/景区小程序/pages/fahui/special.vue?vue&type=script&lang=js& ***!
  \*****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
/* WEBPACK VAR INJECTION */(function(uniCloud, uni) {

var _interopRequireDefault = __webpack_require__(/*! @babel/runtime/helpers/interopRequireDefault */ 4);
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;
var _regenerator = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/regenerator */ 28));
var _defineProperty2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/defineProperty */ 11));
var _asyncToGenerator2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/asyncToGenerator */ 31));
function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }
function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { (0, _defineProperty2.default)(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }
var ParticipantForm = function ParticipantForm() {
  __webpack_require__.e(/*! require.ensure | components/ParticipantForm */ "components/ParticipantForm").then((function () {
    return resolve(__webpack_require__(/*! @/components/ParticipantForm.vue */ 769));
  }).bind(null, __webpack_require__)).catch(__webpack_require__.oe);
};
// 导入云对象
var fahuiManagement = uniCloud.importObject('fahui-management');
var _default = {
  components: {
    ParticipantForm: ParticipantForm
  },
  data: function data() {
    return {
      bannerImage: '',
      bannerDesc: '',
      specialIntro: {
        content: '',
        image: ''
      },
      applicants: [this.getEmptyApplicant()],
      fahuiProjects: [],
      // 改为动态获取
      selectedProjectIndex: -1,
      spouse: {
        name: '',
        gender: '',
        phone: '',
        lunarBirthday: '',
        birthTime: '',
        address: ''
      },
      chaoduTypes: ['超度法会', '超度牌位', '超度功德'],
      chaoduType: '',
      relationOptions: ['先曾祖父', '先曾祖母', '先祖父', '先祖母', '外祖父', '外祖母', '先父', '先母', '岳父', '岳母', '先夫', '先妻', '故爱子', '故爱女', '好友', '恩师', '其他'],
      deceasedList: [this.getEmptyDeceased()],
      showGoods: false,
      goodsList: [],
      showReceiver: false,
      // 默认不显示
      receiver: {
        name: '',
        phone: '',
        address: ''
      },
      genderOptions: ['男', '女'],
      birthTimeOptions: ['子时', '丑时', '寅时', '卯时', '辰时', '巳时', '午时', '未时', '申时', '酉时', '戌时', '亥时'],
      showHistoryDialog: false,
      historyParticipants: [],
      historySelectIndex: -1,
      historySearch: '',
      hoverIdx: -1,
      batchDeleteMode: false,
      batchDeleteSet: new Set(),
      showImportInput: false,
      refreshing: false // 新增：控制下拉刷新状态
    };
  },

  computed: {
    goodsTotalPrice: function goodsTotalPrice() {
      return this.goodsList.reduce(function (sum, item) {
        var price = Number(item.price) || 0;
        var qty = Number(item.qty) || 0;
        return sum + price * qty;
      }, 0);
    },
    totalPrice: function totalPrice() {
      var basePrice = this.selectedProjectIndex >= 0 ? this.fahuiProjects[this.selectedProjectIndex].price : 0;
      var applicantCount = this.applicants.length;
      return basePrice * applicantCount + this.goodsTotalPrice;
    },
    totalPriceFormatted: function totalPriceFormatted() {
      return this.totalPrice.toFixed(2); // 保留两位小数
    },
    filteredHistory: function filteredHistory() {
      if (!this.historySearch) return this.historyParticipants;
      var kw = this.historySearch.trim();
      return this.historyParticipants.filter(function (item) {
        return item.name.includes(kw) || item.phone && item.phone.includes(kw);
      });
    }
  },
  methods: {
    showError: function showError(msg) {
      uni.showToast({
        title: msg,
        icon: 'none'
      });
      return false;
    },
    loadBanner: function loadBanner() {
      var _this = this;
      return (0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee() {
        var result, bannerData, image, desc, tempRes;
        return _regenerator.default.wrap(function _callee$(_context) {
          while (1) {
            switch (_context.prev = _context.next) {
              case 0:
                _context.prev = 0;
                _context.next = 3;
                return fahuiManagement.getBanners();
              case 3:
                result = _context.sent;
                console.log('云函数返回：', result);
                if (!(result.success && result.data && result.data.length > 0)) {
                  _context.next = 21;
                  break;
                }
                bannerData = result.data[0];
                console.log('Banner数据详情：', bannerData);
                image = bannerData.image;
                desc = bannerData.description || bannerData.desc || bannerData.title || ''; // fileID 转临时链接
                if (!(image && !/^https?:\/\//.test(image))) {
                  _context.next = 15;
                  break;
                }
                _context.next = 13;
                return uniCloud.getTempFileURL({
                  fileList: [image]
                });
              case 13:
                tempRes = _context.sent;
                if (tempRes.fileList && tempRes.fileList[0] && tempRes.fileList[0].tempFileURL) {
                  image = tempRes.fileList[0].tempFileURL;
                }
              case 15:
                _this.bannerImage = image;
                _this.bannerDesc = desc;
                console.log('最终显示图片：', image);
                console.log('最终显示描述：', desc);
                _context.next = 24;
                break;
              case 21:
                _this.bannerImage = '';
                _this.bannerDesc = '';
                console.log('没有找到banner数据');
              case 24:
                _context.next = 31;
                break;
              case 26:
                _context.prev = 26;
                _context.t0 = _context["catch"](0);
                _this.bannerImage = '';
                _this.bannerDesc = '';
                console.error('加载头图失败', _context.t0);
              case 31:
              case "end":
                return _context.stop();
            }
          }
        }, _callee, null, [[0, 26]]);
      }))();
    },
    loadSpecialIntro: function loadSpecialIntro() {
      var _this2 = this;
      return (0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee2() {
        var _result$data, _result$data2, result;
        return _regenerator.default.wrap(function _callee2$(_context2) {
          while (1) {
            switch (_context2.prev = _context2.next) {
              case 0:
                _context2.prev = 0;
                console.log('🔍 === 开始加载专场法会介绍数据 ===');
                console.log('🔍 调用 fahuiManagement.getSpecialIntro()');
                _context2.next = 5;
                return fahuiManagement.getSpecialIntro();
              case 5:
                result = _context2.sent;
                console.log('🔍 云函数返回结果:', result);
                console.log('🔍 返回数据详情:', result.data);
                console.log('🔍 返回数据内容:', (_result$data = result.data) === null || _result$data === void 0 ? void 0 : _result$data.content);
                console.log('🔍 返回数据启用状态:', (_result$data2 = result.data) === null || _result$data2 === void 0 ? void 0 : _result$data2.enabled);
                if (result.success && result.data) {
                  console.log('🔍 数据获取成功，更新 specialIntro');
                  console.log('🔍 更新前的 specialIntro:', _this2.specialIntro);
                  _this2.specialIntro = result.data;
                  console.log('🔍 更新后的 specialIntro:', _this2.specialIntro);
                  console.log('🔍 更新后的内容:', _this2.specialIntro.content);
                  console.log('🔍 更新后的启用状态:', _this2.specialIntro.enabled);
                  console.log('🔍 更新后的图片:', _this2.specialIntro.image);
                } else {
                  console.log('🔍 数据获取失败或为空，使用默认数据');
                  console.log('🔍 失败原因:', result.message);
                  _this2.specialIntro = {
                    content: '',
                    image: ''
                  };
                }
                console.log('🔍 === 专场法会介绍数据加载完成 ===');
                _context2.next = 19;
                break;
              case 14:
                _context2.prev = 14;
                _context2.t0 = _context2["catch"](0);
                console.error('🔍 加载专场法会介绍失败:', _context2.t0);
                console.error('🔍 错误详情:', _context2.t0.message);
                _this2.specialIntro = {
                  content: '',
                  image: ''
                };
              case 19:
              case "end":
                return _context2.stop();
            }
          }
        }, _callee2, null, [[0, 14]]);
      }))();
    },
    loadFahuiProjects: function loadFahuiProjects() {
      var _this3 = this;
      return (0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee3() {
        var result, last, idx;
        return _regenerator.default.wrap(function _callee3$(_context3) {
          while (1) {
            switch (_context3.prev = _context3.next) {
              case 0:
                _context3.prev = 0;
                _context3.next = 3;
                return fahuiManagement.getProjects({
                  type: 'special'
                });
              case 3:
                result = _context3.sent;
                if (result.success && result.data) {
                  _this3.fahuiProjects = result.data.map(function (p) {
                    return _objectSpread(_objectSpread({}, p), {}, {
                      price: Number(p.price) || 0
                    });
                  });
                } else {
                  _this3.fahuiProjects = [];
                }
                // 恢复上次选中
                last = uni.getStorageSync('fahuiForm');
                if (last && last.fahuiProject) {
                  idx = _this3.fahuiProjects.findIndex(function (p) {
                    return p._id === last.fahuiProject._id;
                  });
                  _this3.selectedProjectIndex = idx >= 0 ? idx : -1;
                } else {
                  _this3.selectedProjectIndex = -1;
                }
                _context3.next = 13;
                break;
              case 9:
                _context3.prev = 9;
                _context3.t0 = _context3["catch"](0);
                _this3.fahuiProjects = [];
                uni.showToast({
                  title: '获取法会项目失败',
                  icon: 'none'
                });
              case 13:
              case "end":
                return _context3.stop();
            }
          }
        }, _callee3, null, [[0, 9]]);
      }))();
    },
    loadGoodsConfig: function loadGoodsConfig() {
      var _this4 = this;
      return (0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee4() {
        var result;
        return _regenerator.default.wrap(function _callee4$(_context4) {
          while (1) {
            switch (_context4.prev = _context4.next) {
              case 0:
                _context4.prev = 0;
                _context4.next = 3;
                return fahuiManagement.getGoodsConfig();
              case 3:
                result = _context4.sent;
                if (result.success && result.data) {
                  _this4.showGoods = !!result.data.enabled && Array.isArray(result.data.goods) && result.data.goods.length > 0;
                  _this4.goodsList = Array.isArray(result.data.goods) ? result.data.goods.filter(function (g) {
                    return g.enabled;
                  }).map(function (g) {
                    return _objectSpread(_objectSpread({}, g), {}, {
                      qty: Number(g.qty) || 0
                    });
                  }) : [];
                } else {
                  _this4.showGoods = false;
                  _this4.goodsList = [];
                }
                _context4.next = 12;
                break;
              case 7:
                _context4.prev = 7;
                _context4.t0 = _context4["catch"](0);
                _this4.showGoods = false;
                _this4.goodsList = [];
                console.error('加载代办物品配置失败:', _context4.t0);
              case 12:
              case "end":
                return _context4.stop();
            }
          }
        }, _callee4, null, [[0, 7]]);
      }))();
    },
    getReceiverConfig: function getReceiverConfig() {
      var _this5 = this;
      return (0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee5() {
        var result, enabled;
        return _regenerator.default.wrap(function _callee5$(_context5) {
          while (1) {
            switch (_context5.prev = _context5.next) {
              case 0:
                _context5.prev = 0;
                _context5.next = 3;
                return fahuiManagement.getReceiverConfig();
              case 3:
                result = _context5.sent;
                // 兼容 enabled 字段在 result 或根对象
                enabled = result.success && result.data ? result.data.enabled : false;
                _this5.showReceiver = !!enabled;
                _context5.next = 12;
                break;
              case 8:
                _context5.prev = 8;
                _context5.t0 = _context5["catch"](0);
                _this5.showReceiver = false;
                console.error('获取收件人配置失败:', _context5.t0);
              case 12:
              case "end":
                return _context5.stop();
            }
          }
        }, _callee5, null, [[0, 8]]);
      }))();
    },
    getEmptyApplicant: function getEmptyApplicant() {
      return {
        name: '',
        gender: '',
        phone: '',
        lunarBirthday: '',
        birthTime: '',
        address: ''
      };
    },
    getEmptyDeceased: function getEmptyDeceased() {
      return {
        name: '',
        relation: '',
        lunarBirthday: '',
        deathDate: ''
      };
    },
    onParticipantsChange: function onParticipantsChange(participants) {
      // 只在数据变化时赋值，避免深度响应式卡顿
      if (JSON.stringify(this.applicants) !== JSON.stringify(participants)) {
        this.applicants = participants.slice ? participants.slice() : participants;
      }
    },
    selectProject: function selectProject(index) {
      console.log('选中项目index:', index);
      this.selectedProjectIndex = index;
    },
    onSpouseGenderChange: function onSpouseGenderChange(e) {
      this.spouse.gender = this.genderOptions[e.detail.value];
    },
    onSpouseBirthdayChange: function onSpouseBirthdayChange(e) {
      this.spouse.lunarBirthday = e.detail.value;
    },
    onSpouseBirthTimeChange: function onSpouseBirthTimeChange(e) {
      this.spouse.birthTime = this.birthTimeOptions[e.detail.value];
    },
    onChaoduTypeChange: function onChaoduTypeChange(e) {
      this.chaoduType = this.chaoduTypes[e.detail.value];
    },
    addDeceased: function addDeceased() {
      if (this.deceasedList.length < 5) {
        this.deceasedList.push(this.getEmptyDeceased());
      }
    },
    removeDeceased: function removeDeceased(index) {
      if (this.deceasedList.length > 1) {
        this.deceasedList.splice(index, 1);
      }
    },
    onRelationChange: function onRelationChange(index, e) {
      this.deceasedList[index].relation = this.relationOptions[e.detail.value];
    },
    onDeceasedBirthdayChange: function onDeceasedBirthdayChange(index, e) {
      this.deceasedList[index].lunarBirthday = e.detail.value;
    },
    onDeceasedDeathChange: function onDeceasedDeathChange(index, e) {
      this.deceasedList[index].deathDate = e.detail.value;
    },
    increaseGoodsQty: function increaseGoodsQty(index) {
      this.goodsList[index].qty++;
    },
    decreaseGoodsQty: function decreaseGoodsQty(index) {
      if (this.goodsList[index].qty > 0) {
        this.goodsList[index].qty--;
      }
    },
    // 历史报名人弹窗
    openHistoryDialog: function openHistoryDialog(index) {
      this.historySelectIndex = index;
      this.historyParticipants = uni.getStorageSync('historyParticipants') || [];
      this.showHistoryDialog = true;
    },
    selectHistoryParticipant: function selectHistoryParticipant(item) {
      if (this.historySelectIndex >= 0) {
        this.$set(this.applicants, this.historySelectIndex, _objectSpread({}, item));
      }
      this.showHistoryDialog = false;
      this.historySelectIndex = -1;
    },
    // 报名成功后保存历史报名人
    saveHistoryParticipants: function saveHistoryParticipants() {
      var history = uni.getStorageSync('historyParticipants') || [];
      this.applicants.forEach(function (p) {
        if (!history.some(function (h) {
          return h.name === p.name && h.phone === p.phone;
        })) {
          history.push(_objectSpread({}, p));
        }
      });
      // 最多保存20条
      if (history.length > 20) history = history.slice(-20);
      uni.setStorageSync('historyParticipants', history);
    },
    // 增强校验：姓名、手机号不能重复
    validate: function validate() {
      // 校验报名人数量
      if (!this.applicants || this.applicants.length === 0) {
        return this.showError('请添加至少一位报名人');
      }
      if (this.applicants.length > 5) {
        return this.showError('最多添加5位报名人');
      }
      // 校验报名人信息
      var nameSet = new Set();
      var phoneSet = new Set();
      for (var i = 0; i < this.applicants.length; i++) {
        var p = this.applicants[i];
        if (!p.name) return this.showError("\u8BF7\u8F93\u5165\u7B2C".concat(i + 1, "\u4F4D\u62A5\u540D\u4EBA\u59D3\u540D"));
        if (!p.gender) return this.showError("\u8BF7\u9009\u62E9\u7B2C".concat(i + 1, "\u4F4D\u62A5\u540D\u4EBA\u6027\u522B"));
        if (!p.phone) return this.showError("\u8BF7\u8F93\u5165\u7B2C".concat(i + 1, "\u4F4D\u62A5\u540D\u4EBA\u7535\u8BDD"));
        if (!/^1[3-9]\d{9}$/.test(p.phone)) return this.showError("\u7B2C".concat(i + 1, "\u4F4D\u62A5\u540D\u4EBA\u7535\u8BDD\u683C\u5F0F\u4E0D\u6B63\u786E"));
        if (!p.lunarBirthday) return this.showError("\u8BF7\u9009\u62E9\u7B2C".concat(i + 1, "\u4F4D\u62A5\u540D\u4EBA\u519C\u5386\u751F\u65E5"));
        if (!p.birthTime) return this.showError("\u8BF7\u9009\u62E9\u7B2C".concat(i + 1, "\u4F4D\u62A5\u540D\u4EBA\u51FA\u751F\u65F6\u8FB0"));
        if (!p.address) return this.showError("\u8BF7\u8F93\u5165\u7B2C".concat(i + 1, "\u4F4D\u62A5\u540D\u4EBA\u5E38\u4F4F\u5730\u5740"));
        if (nameSet.has(p.name)) return this.showError("\u7B2C".concat(i + 1, "\u4F4D\u62A5\u540D\u4EBA\u59D3\u540D\u91CD\u590D"));
        if (phoneSet.has(p.phone)) return this.showError("\u7B2C".concat(i + 1, "\u4F4D\u62A5\u540D\u4EBA\u7535\u8BDD\u91CD\u590D"));
        nameSet.add(p.name);
        phoneSet.add(p.phone);
      }
      // 校验法会项目
      if (this.selectedProjectIndex === -1) {
        return this.showError('请选择法会项目');
      }
      // 校验超度法会
      if (this.selectedProjectIndex === 1) {
        if (!this.chaoduType) return this.showError('请选择超度类型');
        if (!this.deceasedList || this.deceasedList.length === 0) return this.showError('请添加至少一位已故亲人');
        for (var _i = 0; _i < this.deceasedList.length; _i++) {
          var d = this.deceasedList[_i];
          if (!d.name) return this.showError("\u8BF7\u8F93\u5165\u7B2C".concat(_i + 1, "\u4F4D\u5DF2\u6545\u4EB2\u4EBA\u59D3\u540D"));
          if (!d.relation) return this.showError("\u8BF7\u9009\u62E9\u7B2C".concat(_i + 1, "\u4F4D\u5DF2\u6545\u4EB2\u4EBA\u5173\u7CFB"));
        }
      }
      // 校验收件信息（如显示时，全部填写或全部为空）
      if (this.showReceiver) {
        var _this$receiver = this.receiver,
          name = _this$receiver.name,
          phone = _this$receiver.phone,
          address = _this$receiver.address;
        var filled = name || phone || address;
        var allFilled = name && phone && address;
        if (filled && !allFilled) return this.showError('请完整填写收件人、电话和地址');
        if (phone && !/^1[3-9]\d{9}$/.test(phone)) return this.showError('收件人电话格式不正确');
      }
      return true;
    },
    nextStep: function nextStep() {
      if (!this.validate()) return;

      // 构建表单数据
      var formData = {
        applicants: this.applicants,
        fahuiProject: _objectSpread(_objectSpread({}, this.fahuiProjects[this.selectedProjectIndex]), {}, {
          price: Number(this.fahuiProjects[this.selectedProjectIndex].price) || 0
        }),
        spouse: this.selectedProjectIndex === 0 ? this.spouse : null,
        chaoduType: this.selectedProjectIndex === 1 ? this.chaoduType : null,
        deceasedList: this.selectedProjectIndex === 1 ? this.deceasedList : null,
        goods: this.goodsList.filter(function (item) {
          return item.qty > 0;
        }),
        receiver: this.receiver,
        totalPrice: this.totalPrice,
        timestamp: new Date().getTime()
      };

      // 收件信息自动保存到数据库
      if (this.showReceiver && this.receiver.name && this.receiver.phone && this.receiver.address) {
        fahuiManagement.addReceiver(_objectSpread({}, this.receiver)).catch(function (e) {
          console.error('保存收件信息失败:', e);
        });
      }

      // 保存到本地存储
      uni.setStorageSync('fahuiForm', formData);
      this.saveHistoryParticipants();

      // 跳转到确认页
      uni.navigateTo({
        url: '/pages/fahui/confirm',
        success: function success() {
          console.log('跳转到专场法会确认页成功');
        },
        fail: function fail(err) {
          console.error('跳转失败:', err);
          uni.showToast({
            title: '页面跳转失败',
            icon: 'none'
          });
        }
      });
    },
    showProjectIntro: function showProjectIntro(index) {
      var project = this.fahuiProjects[index];
      if (project) {
        uni.showModal({
          title: project.name + '简介',
          content: project.description || '暂无简介'
        });
      }
    },
    getRemainingText: function getRemainingText(project) {
      if (project.maxApplicants) {
        var remaining = project.maxApplicants - (project.currentApplicants || 0);
        return remaining.toString();
      }
      return '不限';
    },
    getPriceText: function getPriceText(project) {
      return project.price ? '¥' + project.price : '¥0';
    },
    getGoodsPriceText: function getGoodsPriceText(item) {
      return item.price ? '¥' + item.price : '¥0';
    },
    getGoodsTotalPriceText: function getGoodsTotalPriceText() {
      return '¥' + this.goodsTotalPrice;
    },
    getHistoryDetailText: function getHistoryDetailText(item) {
      var parts = [];
      if (item.gender) parts.push(item.gender);
      if (item.lunarBirthday) parts.push(item.lunarBirthday);
      if (item.birthTime) parts.push(item.birthTime);
      if (item.address) parts.push(item.address);
      return parts.join(' | ');
    },
    getBatchDeleteButtonText: function getBatchDeleteButtonText() {
      return this.batchDeleteMode ? '取消批量' : '批量删除';
    },
    getConfirmDeleteButtonText: function getConfirmDeleteButtonText() {
      return "\u786E\u8BA4\u5220\u9664(".concat(this.batchDeleteSet.size, ")");
    },
    onHistorySearch: function onHistorySearch() {
      this.hoverIdx = -1;
    },
    clearHistorySearch: function clearHistorySearch() {
      this.historySearch = '';
    },
    deleteHistoryParticipant: function deleteHistoryParticipant(idx) {
      var _this6 = this;
      var item = this.filteredHistory[idx];
      uni.showModal({
        title: '确认删除',
        content: "\u786E\u5B9A\u8981\u5220\u9664\u201C".concat(item.name, "\u201D\u7684\u5386\u53F2\u4FE1\u606F\u5417\uFF1F"),
        success: function success(res) {
          if (res.confirm) {
            // 从原始数组删除
            var realIdx = _this6.historyParticipants.findIndex(function (h) {
              return h.name === item.name && h.phone === item.phone;
            });
            if (realIdx !== -1) {
              _this6.historyParticipants.splice(realIdx, 1);
              uni.setStorageSync('historyParticipants', _this6.historyParticipants);
            }
          }
        }
      });
    },
    onHistoryKeydown: function onHistoryKeydown(e) {
      if (!this.showHistoryDialog) return;
      if (e.key === 'ArrowDown') {
        if (this.filteredHistory.length) {
          this.hoverIdx = (this.hoverIdx + 1) % this.filteredHistory.length;
        }
        e.preventDefault();
      } else if (e.key === 'ArrowUp') {
        if (this.filteredHistory.length) {
          this.hoverIdx = (this.hoverIdx - 1 + this.filteredHistory.length) % this.filteredHistory.length;
        }
        e.preventDefault();
      } else if (e.key === 'Enter') {
        if (this.hoverIdx >= 0 && this.hoverIdx < this.filteredHistory.length && !this.batchDeleteMode) {
          this.selectHistoryParticipant(this.filteredHistory[this.hoverIdx]);
        }
      } else if (e.key === 'Escape') {
        this.showHistoryDialog = false;
      }
    },
    onHistoryItemClick: function onHistoryItemClick(idx, item) {
      if (this.batchDeleteMode) {
        this.toggleBatchDelete(idx);
      } else {
        this.selectHistoryParticipant(item);
      }
    },
    toggleBatchDeleteMode: function toggleBatchDeleteMode() {
      this.batchDeleteMode = !this.batchDeleteMode;
      this.batchDeleteSet = new Set();
    },
    toggleBatchDelete: function toggleBatchDelete(idx) {
      if (this.batchDeleteSet.has(idx)) {
        this.batchDeleteSet.delete(idx);
      } else {
        this.batchDeleteSet.add(idx);
      }
    },
    confirmBatchDelete: function confirmBatchDelete() {
      var _this7 = this;
      if (!this.batchDeleteSet.size) return;
      uni.showModal({
        title: '批量删除',
        content: "\u786E\u5B9A\u8981\u5220\u9664\u9009\u4E2D\u7684".concat(this.batchDeleteSet.size, "\u6761\u5386\u53F2\u62A5\u540D\u4EBA\u5417\uFF1F"),
        success: function success(res) {
          if (res.confirm) {
            var toDelete = Array.from(_this7.batchDeleteSet).map(function (i) {
              return _this7.filteredHistory[i];
            });
            _this7.historyParticipants = _this7.historyParticipants.filter(function (h) {
              return !toDelete.some(function (d) {
                return d.name === h.name && d.phone === h.phone;
              });
            });
            uni.setStorageSync('historyParticipants', _this7.historyParticipants);
            _this7.batchDeleteSet = new Set();
            _this7.batchDeleteMode = false;
          }
        }
      });
    },
    exportHistory: function exportHistory() {
      var data = JSON.stringify(this.historyParticipants, null, 2);
      var blob = new Blob([data], {
        type: 'application/json'
      });
      var url = URL.createObjectURL(blob);
      var a = document.createElement('a');
      a.href = url;
      a.download = 'historyParticipants.json';
      a.click();
      URL.revokeObjectURL(url);
    },
    importHistory: function importHistory() {
      var _this8 = this;
      // 触发文件选择
      this.showImportInput = true;
      this.$nextTick(function () {
        _this8.$refs.importFile && _this8.$refs.importFile.click();
      });
    },
    onImportFile: function onImportFile(e) {
      var _this9 = this;
      var file = e.target.files[0];
      if (!file) return;
      var reader = new FileReader();
      reader.onload = function (evt) {
        try {
          var arr = JSON.parse(evt.target.result);
          if (Array.isArray(arr)) {
            // 合并去重
            arr.forEach(function (p) {
              if (!_this9.historyParticipants.some(function (h) {
                return h.name === p.name && h.phone === p.phone;
              })) {
                _this9.historyParticipants.push(p);
              }
            });
            uni.setStorageSync('historyParticipants', _this9.historyParticipants);
            uni.showToast({
              title: '导入成功',
              icon: 'success'
            });
          } else {
            uni.showToast({
              title: '格式错误',
              icon: 'none'
            });
          }
        } catch (_unused) {
          uni.showToast({
            title: '解析失败',
            icon: 'none'
          });
        }
      };
      reader.readAsText(file);
      this.showImportInput = false;
    },
    // 强制刷新所有数据
    forceRefreshAll: function forceRefreshAll() {
      console.log('🔍 === 强制刷新所有数据 ===');
      // 清除所有缓存数据
      this.bannerImage = '';
      this.bannerDesc = '';
      this.specialIntro = {
        content: '',
        image: ''
      };
      this.fahuiProjects = [];
      this.goodsList = [];

      // 重新加载所有数据
      this.loadBanner();
      this.loadSpecialIntro();
      this.loadFahuiProjects();
      this.loadGoodsConfig();
      uni.showToast({
        title: '所有数据已强制刷新',
        icon: 'none'
      });
    },
    // 新增：下拉刷新
    onRefresh: function onRefresh() {
      var _this10 = this;
      return (0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee6() {
        return _regenerator.default.wrap(function _callee6$(_context6) {
          while (1) {
            switch (_context6.prev = _context6.next) {
              case 0:
                _this10.refreshing = true;
                _context6.next = 3;
                return _this10.loadBanner();
              case 3:
                _context6.next = 5;
                return _this10.loadSpecialIntro();
              case 5:
                _context6.next = 7;
                return _this10.loadFahuiProjects();
              case 7:
                _context6.next = 9;
                return _this10.loadGoodsConfig();
              case 9:
                _this10.refreshing = false;
              case 10:
              case "end":
                return _context6.stop();
            }
          }
        }, _callee6);
      }))();
    }
  },
  onLoad: function onLoad() {
    var _this11 = this;
    this.getReceiverConfig();
    this.loadBanner();
    this.loadSpecialIntro();
    this.loadFahuiProjects(); // 新增
    this.loadGoodsConfig();
    // 自动填充上次填写
    var last = uni.getStorageSync('fahuiForm');
    if (last) {
      this.applicants = last.applicants || [this.getEmptyApplicant()];
      this.selectedProjectIndex = this.fahuiProjects.findIndex(function (p) {
        var _last$fahuiProject;
        return p._id === ((_last$fahuiProject = last.fahuiProject) === null || _last$fahuiProject === void 0 ? void 0 : _last$fahuiProject.id);
      });
      this.spouse = last.spouse || this.spouse;
      this.chaoduType = last.chaoduType || '';
      this.deceasedList = last.deceasedList || [this.getEmptyDeceased()];
      this.receiver = last.receiver || this.receiver;

      // 恢复商品选择
      if (last.goods) {
        last.goods.forEach(function (selected) {
          var index = _this11.goodsList.findIndex(function (item) {
            return item.id === selected.id;
          });
          if (index !== -1) {
            _this11.goodsList[index].qty = selected.qty;
          }
        });
      }
    }
  },
  onShow: function onShow() {
    // 移除重复的 getReceiverConfig() 调用，避免重复执行
    try {
      uni.removeStorageSync('fahuiBannerCache');
    } catch (e) {}
    this.loadBanner();
    this.loadFahuiProjects(); // 新增，确保每次进入都刷新
    this.loadGoodsConfig();
  }
};
exports.default = _default;
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(/*! ./node_modules/@dcloudio/vue-cli-plugin-uni/packages/uni-cloud/dist/index.js */ 27)["uniCloud"], __webpack_require__(/*! ./node_modules/@dcloudio/uni-mp-weixin/dist/index.js */ 3)["default"]))

/***/ }),

/***/ 310:
/*!******************************************************************************************************************************************!*\
  !*** C:/Users/qub/Documents/HBuilderProjects/123/景区小程序/pages/fahui/special.vue?vue&type=style&index=0&id=497fb5e2&scoped=true&lang=css& ***!
  \******************************************************************************************************************************************/
/*! no static exports found */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _Desktop_HBuilderX_plugins_uniapp_cli_node_modules_mini_css_extract_plugin_dist_loader_js_ref_6_oneOf_1_0_Desktop_HBuilderX_plugins_uniapp_cli_node_modules_css_loader_dist_cjs_js_ref_6_oneOf_1_1_Desktop_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_loaders_stylePostLoader_js_Desktop_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_6_oneOf_1_2_Desktop_HBuilderX_plugins_uniapp_cli_node_modules_postcss_loader_src_index_js_ref_6_oneOf_1_3_Desktop_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_index_js_vue_loader_options_Desktop_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_special_vue_vue_type_style_index_0_id_497fb5e2_scoped_true_lang_css___WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! -!../../../../../../Desktop/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../../../Desktop/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../../../Desktop/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../Desktop/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--6-oneOf-1-2!../../../../../../Desktop/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src??ref--6-oneOf-1-3!../../../../../../Desktop/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib??vue-loader-options!../../../../../../Desktop/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./special.vue?vue&type=style&index=0&id=497fb5e2&scoped=true&lang=css& */ 311);
/* harmony import */ var _Desktop_HBuilderX_plugins_uniapp_cli_node_modules_mini_css_extract_plugin_dist_loader_js_ref_6_oneOf_1_0_Desktop_HBuilderX_plugins_uniapp_cli_node_modules_css_loader_dist_cjs_js_ref_6_oneOf_1_1_Desktop_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_loaders_stylePostLoader_js_Desktop_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_6_oneOf_1_2_Desktop_HBuilderX_plugins_uniapp_cli_node_modules_postcss_loader_src_index_js_ref_6_oneOf_1_3_Desktop_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_index_js_vue_loader_options_Desktop_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_special_vue_vue_type_style_index_0_id_497fb5e2_scoped_true_lang_css___WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_Desktop_HBuilderX_plugins_uniapp_cli_node_modules_mini_css_extract_plugin_dist_loader_js_ref_6_oneOf_1_0_Desktop_HBuilderX_plugins_uniapp_cli_node_modules_css_loader_dist_cjs_js_ref_6_oneOf_1_1_Desktop_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_loaders_stylePostLoader_js_Desktop_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_6_oneOf_1_2_Desktop_HBuilderX_plugins_uniapp_cli_node_modules_postcss_loader_src_index_js_ref_6_oneOf_1_3_Desktop_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_index_js_vue_loader_options_Desktop_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_special_vue_vue_type_style_index_0_id_497fb5e2_scoped_true_lang_css___WEBPACK_IMPORTED_MODULE_0__);
/* harmony reexport (unknown) */ for(var __WEBPACK_IMPORT_KEY__ in _Desktop_HBuilderX_plugins_uniapp_cli_node_modules_mini_css_extract_plugin_dist_loader_js_ref_6_oneOf_1_0_Desktop_HBuilderX_plugins_uniapp_cli_node_modules_css_loader_dist_cjs_js_ref_6_oneOf_1_1_Desktop_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_loaders_stylePostLoader_js_Desktop_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_6_oneOf_1_2_Desktop_HBuilderX_plugins_uniapp_cli_node_modules_postcss_loader_src_index_js_ref_6_oneOf_1_3_Desktop_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_index_js_vue_loader_options_Desktop_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_special_vue_vue_type_style_index_0_id_497fb5e2_scoped_true_lang_css___WEBPACK_IMPORTED_MODULE_0__) if(["default"].indexOf(__WEBPACK_IMPORT_KEY__) < 0) (function(key) { __webpack_require__.d(__webpack_exports__, key, function() { return _Desktop_HBuilderX_plugins_uniapp_cli_node_modules_mini_css_extract_plugin_dist_loader_js_ref_6_oneOf_1_0_Desktop_HBuilderX_plugins_uniapp_cli_node_modules_css_loader_dist_cjs_js_ref_6_oneOf_1_1_Desktop_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_loaders_stylePostLoader_js_Desktop_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_6_oneOf_1_2_Desktop_HBuilderX_plugins_uniapp_cli_node_modules_postcss_loader_src_index_js_ref_6_oneOf_1_3_Desktop_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_index_js_vue_loader_options_Desktop_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_special_vue_vue_type_style_index_0_id_497fb5e2_scoped_true_lang_css___WEBPACK_IMPORTED_MODULE_0__[key]; }) }(__WEBPACK_IMPORT_KEY__));
 /* harmony default export */ __webpack_exports__["default"] = (_Desktop_HBuilderX_plugins_uniapp_cli_node_modules_mini_css_extract_plugin_dist_loader_js_ref_6_oneOf_1_0_Desktop_HBuilderX_plugins_uniapp_cli_node_modules_css_loader_dist_cjs_js_ref_6_oneOf_1_1_Desktop_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_loaders_stylePostLoader_js_Desktop_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_6_oneOf_1_2_Desktop_HBuilderX_plugins_uniapp_cli_node_modules_postcss_loader_src_index_js_ref_6_oneOf_1_3_Desktop_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_index_js_vue_loader_options_Desktop_HBuilderX_plugins_uniapp_cli_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_special_vue_vue_type_style_index_0_id_497fb5e2_scoped_true_lang_css___WEBPACK_IMPORTED_MODULE_0___default.a); 

/***/ }),

/***/ 311:
/*!**********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!./node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--6-oneOf-1-2!./node_modules/postcss-loader/src??ref--6-oneOf-1-3!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib??vue-loader-options!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!C:/Users/qub/Documents/HBuilderProjects/123/景区小程序/pages/fahui/special.vue?vue&type=style&index=0&id=497fb5e2&scoped=true&lang=css& ***!
  \**********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

// extracted by mini-css-extract-plugin
    if(false) { var cssReload; }
  

/***/ })

},[[304,"common/runtime","common/vendor"]]]);
//# sourceMappingURL=../../../.sourcemap/mp-weixin/pages/fahui/special.js.map