<view class="form-bg data-v-c581a09e"><view class="form-container data-v-c581a09e"><view class="step-bar data-v-c581a09e"><view class="step active data-v-c581a09e">1. 选择供品</view><view class="step data-v-c581a09e">2. 信息确认</view><view class="step data-v-c581a09e">3. 支付</view></view><view class="card data-v-c581a09e"><view class="card-title data-v-c581a09e"><text class="icon data-v-c581a09e">🏛️</text>选择殿堂<text class="required data-v-c581a09e">*</text></view><view class="form-group data-v-c581a09e"><picker range="{{halls}}" value="{{hallIndex}}" data-event-opts="{{[['change',[['onSelectHall',['$event']]]]]}}" bindchange="__e" class="data-v-c581a09e"><view class="picker data-v-c581a09e"><text class="icon data-v-c581a09e">🏛️</text>殿堂：<block wx:if="{{hallIndex>=0}}"><text class="data-v-c581a09e">{{halls[hallIndex]}}</text></block><block wx:else><text class="placeholder data-v-c581a09e">请选择殿堂</text></block><text class="arrow data-v-c581a09e">▼</text></view></picker><block wx:if="{{errors.hallIndex}}"><view class="error-tip data-v-c581a09e">{{errors.hallIndex}}</view></block></view></view><view class="card data-v-c581a09e"><view class="card-title data-v-c581a09e"><text class="icon data-v-c581a09e">🕯️</text>选择供品<text class="required data-v-c581a09e">*</text></view><view class="offerings-list data-v-c581a09e"><block wx:for="{{offerings}}" wx:for-item="offering" wx:for-index="index" wx:key="index"><view class="offering-item data-v-c581a09e"><view class="offering-info data-v-c581a09e"><view class="offering-header data-v-c581a09e"><text class="offering-icon data-v-c581a09e">{{offering.icon}}</text><view class="offering-details data-v-c581a09e"><view class="offering-name data-v-c581a09e">{{offering.name}}</view><view class="offering-desc data-v-c581a09e">{{offering.description}}</view></view></view><view class="offering-price data-v-c581a09e">{{"¥"+offering.price+"/"+offering.unit}}</view></view><view class="offering-control data-v-c581a09e"><button class="qty-btn data-v-c581a09e" disabled="{{offering.qty<=0}}" data-event-opts="{{[['tap',[['decreaseQty',[index]]]]]}}" bindtap="__e">-</button><text class="qty-value data-v-c581a09e">{{offering.qty}}</text><button data-event-opts="{{[['tap',[['increaseQty',[index]]]]]}}" class="qty-btn data-v-c581a09e" bindtap="__e">+</button></view></view></block></view><block wx:if="{{errors.offerings}}"><view class="error-tip data-v-c581a09e">{{errors.offerings}}</view></block><block wx:if="{{totalPrice>0}}"><view class="price-preview data-v-c581a09e"><view class="price-item data-v-c581a09e"><text class="data-v-c581a09e">供品费用：</text><text class="price data-v-c581a09e">{{"¥"+totalPrice}}</text></view><view class="price-total data-v-c581a09e"><text class="data-v-c581a09e">总计：</text><text class="total-price data-v-c581a09e">{{"¥"+totalPrice}}</text></view></view></block></view><view class="card data-v-c581a09e"><view class="card-title data-v-c581a09e"><text class="icon data-v-c581a09e">👤</text>供奉者信息<text class="required data-v-c581a09e">*</text></view><view class="form-group data-v-c581a09e"><input class="input data-v-c581a09e" placeholder="请输入姓名" maxlength="10" data-event-opts="{{[['input',[['__set_model',['$0','name','$event',[]],['form']]]]]}}" value="{{form.name}}" bindinput="__e"/><block wx:if="{{errors.name}}"><view class="error-tip data-v-c581a09e">{{errors.name}}</view></block></view><view class="form-group data-v-c581a09e"><input class="input data-v-c581a09e" placeholder="请输入联系电话" maxlength="11" data-event-opts="{{[['input',[['__set_model',['$0','phone','$event',[]],['form']]]]]}}" value="{{form.phone}}" bindinput="__e"/><block wx:if="{{errors.phone}}"><view class="error-tip data-v-c581a09e">{{errors.phone}}</view></block></view><view class="form-group data-v-c581a09e"><input class="input data-v-c581a09e" placeholder="请输入身份证号" maxlength="18" data-event-opts="{{[['input',[['__set_model',['$0','idCard','$event',[]],['form']]]]]}}" value="{{form.idCard}}" bindinput="__e"/><block wx:if="{{errors.idCard}}"><view class="error-tip data-v-c581a09e">{{errors.idCard}}</view></block></view><view class="form-group data-v-c581a09e"><textarea class="textarea data-v-c581a09e" placeholder="请输入联系地址" maxlength="50" data-event-opts="{{[['input',[['__set_model',['$0','address','$event',[]],['form']]]]]}}" value="{{form.address}}" bindinput="__e"></textarea><block wx:if="{{errors.address}}"><view class="error-tip data-v-c581a09e">{{errors.address}}</view></block></view></view><view class="card data-v-c581a09e"><view class="card-title data-v-c581a09e"><text class="icon data-v-c581a09e">🙏</text>祈福语（可选）</view><view class="form-group data-v-c581a09e"><textarea class="textarea data-v-c581a09e" placeholder="请输入您的祈福愿望（最多100字）" maxlength="100" data-event-opts="{{[['input',[['__set_model',['$0','wish','$event',[]],['form']],['onWishInput',['$event']]]]]}}" value="{{form.wish}}" bindinput="__e"></textarea><view class="word-count data-v-c581a09e">{{$root.g0+"/100"}}</view></view></view><block wx:if="{{showReceiver}}"><view class="card data-v-c581a09e"><view class="card-title data-v-c581a09e"><text class="icon data-v-c581a09e">📦</text>收件信息</view><view class="form-group data-v-c581a09e"><input class="input data-v-c581a09e" placeholder="收件人姓名" maxlength="10" data-event-opts="{{[['input',[['__set_model',['$0','name','$event',[]],['form.receiver']]]]]}}" value="{{form.receiver.name}}" bindinput="__e"/></view><view class="form-group data-v-c581a09e"><input class="input data-v-c581a09e" placeholder="收件人电话" maxlength="11" data-event-opts="{{[['input',[['__set_model',['$0','phone','$event',[]],['form.receiver']]]]]}}" value="{{form.receiver.phone}}" bindinput="__e"/></view><view class="form-group data-v-c581a09e"><textarea class="textarea data-v-c581a09e" placeholder="详细收件地址" maxlength="100" data-event-opts="{{[['input',[['__set_model',['$0','address','$event',[]],['form.receiver']]]]]}}" value="{{form.receiver.address}}" bindinput="__e"></textarea></view><view class="form-group data-v-c581a09e"><input class="input data-v-c581a09e" placeholder="备注信息（可选）" maxlength="50" data-event-opts="{{[['input',[['__set_model',['$0','remark','$event',[]],['form.receiver']]]]]}}" value="{{form.receiver.remark}}" bindinput="__e"/></view></view></block><view class="btn-group data-v-c581a09e"><button class="form-btn data-v-c581a09e" type="primary" loading="{{loading}}" data-event-opts="{{[['tap',[['nextStep',['$event']]]]]}}" bindtap="__e"><block wx:if="{{!loading}}"><text class="data-v-c581a09e">下一步</text></block><block wx:else><text class="data-v-c581a09e">提交中...</text></block></button><button class="form-btn reset data-v-c581a09e" type="default" data-event-opts="{{[['tap',[['resetForm',['$event']]]]]}}" bindtap="__e">重置</button></view><view class="back-section data-v-c581a09e"><button data-event-opts="{{[['tap',[['goBack',['$event']]]]]}}" class="back-btn data-v-c581a09e" bindtap="__e">返回上页</button></view></view></view>