{"version":3,"sources":["uni-app:///main.js","webpack:///C:/Users/qub/Documents/HBuilderProjects/123/景区小程序/pages/fahui/joint/confirm.vue?23a0","webpack:///C:/Users/qub/Documents/HBuilderProjects/123/景区小程序/pages/fahui/joint/confirm.vue?3345","webpack:///C:/Users/qub/Documents/HBuilderProjects/123/景区小程序/pages/fahui/joint/confirm.vue?774a","webpack:///C:/Users/qub/Documents/HBuilderProjects/123/景区小程序/pages/fahui/joint/confirm.vue?e309","uni-app:///pages/fahui/joint/confirm.vue","webpack:///C:/Users/qub/Documents/HBuilderProjects/123/景区小程序/pages/fahui/joint/confirm.vue?9b30","webpack:///C:/Users/qub/Documents/HBuilderProjects/123/景区小程序/pages/fahui/joint/confirm.vue?35f6"],"names":["wx","__webpack_require_UNI_MP_PLUGIN__","__webpack_require__","createPage","Page","data","orderData","isSubmitting","onLoad","console","onShow","setTimeout","methods","loadOrderData","jointDataManager","uni","title","icon","delta","convertDraftToOrder","projectName","applicantCount","applicants","selectedItems","receiver","activityFee","goodsFee","totalFee","spouse","deceasedList","chaoduType","goBack","refreshData","showDebugInfo","content","showCancel","testOrderCreation","name","gender","phone","lunarBirthday","birthTime","address","price","count","fahuiType","status","createTime","jointManagement","result","orderResult","orderId","confirmData","confirmTime","url","success","fail","confirmOrder"],"mappings":";;;;;;;;;;;;;AAAA;AAE2D;AAC3D;AACA;AAHA;AACAA,EAAE,CAACC,iCAAiC,GAAGC,mBAAmB;AAG1DC,UAAU,CAACC,gBAAI,CAAC,C;;;;;;;;;;;;;ACLhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAgI;AAChI;AAC2D;AACL;AACqC;;;AAG3F;AACoL;AACpL,gBAAgB,qLAAU;AAC1B,EAAE,6EAAM;AACR,EAAE,8FAAM;AACR,EAAE,uGAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,kGAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACvBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACnBA;AAAA;AAAA;AAAA;AAAyrB,CAAgB,ypBAAG,EAAC,C;;;;;;;;;;;;;;;;;;;;;;;AC0M7sB;AAAA;AAAA;AAEA;AACA;AAAA,eAEA;EACAC;IACA;MACAC;MACAC;IACA;EACA;EAEAC;IACAC;IACAA;IACA;IACAA;EACA;EAEAC;IAAA;IACA;IACAD;;IAEA;IACA;;IAEA;IACA;;IAEA;IACAE;MACA;IACA;;IAEA;IACAA;MACA;IACA;EACA;EAEAC;IACAC;MACA;QACAJ;;QAEA;QACA;QACAA;;QAEA;QACA;UACA;UACA;YACAA;YACA;YACAH;UACA;QACA;QAEA;UACA;UACA;YACAG;YACA;YACA;cACAH;YACA;cACA;YACA;UACA;;UAEA;UACA;UAEAG;UACAA;UACAA;UACAA;UACAA;UACAA;UACAA;UACAA;UACAA;UACAA;UACAA;;UAEA;UACA;YACAA;YACA;cACAA;YACA;UACA;;UAEA;UACA;YACAA;YACA;cACAA;YACA;UACA;;UAEA;UACAK;;UAEA;UACA;QACA;UACAL;UACAM;YACAC;YACAC;UACA;UACAN;YACAI;cACAG;YACA;UACA;QACA;MACA;QACAT;QACAM;UACAC;UACAC;QACA;QACAN;UACAI;QACA;MACA;IACA;IAEA;IACAI;MACA;MACA;MACA;QACAC;QAAA;QACAC;QACAC;QACAC;QACAC;QACAC;QAAA;QACAC;QAAA;QACAC;QAAA;QACAC;QACAC;QACAC;MACA;IACA;IAEAC;MACAtB;MACAM;IACA;IAEA;IACAiB;MACAvB;MACA;MACAM;QACAC;QACAC;MACA;IACA;IAEA;IACAgB;MACA;MAEAxB;MAEAM;QACAC;QACAkB;QACAC;MACA;IACA;IAEA;IACAC;MAAA;MAAA;QAAA;QAAA;UAAA;YAAA;cAAA;gBACA3B;gBACA;gBAAA;gBAEAH;kBACAc;kBACAC;kBACAC;oBACAe;oBACAC;oBACAC;oBACAC;oBACAC;oBACAC;kBACA;kBACAnB;oBACAc;oBACAM;oBACAC;kBACA;kBACApB;oBACAa;oBACAE;oBACAG;kBACA;kBACAjB;kBACAC;kBACAC;kBACAC;kBACAC;kBACAC;kBACAe;kBACAC;kBACAC;gBACA;gBAEAtC;;gBAEA;gBAAA,IACAH;kBAAA;kBAAA;gBAAA;gBAAA,MACA;cAAA;gBAAA,MAEA;kBAAA;kBAAA;gBAAA;gBAAA,MACA;cAAA;gBAAA,MAEA;kBAAA;kBAAA;gBAAA;gBAAA,MACA;cAAA;gBAGAG;gBACAA;kBAAAH;gBAAA;;gBAEA;gBAAA;gBAGAG;gBAAA;gBAAA,OACAuC;kBACA1C;gBACA;cAAA;gBAFA2C;gBAGAxC;gBACAA;gBACAA;gBAAA;gBAAA;cAAA;gBAAA;gBAAA;gBAEAA;gBACAA;gBACAA;gBAAA;cAAA;gBAIA;gBACAyC;gBACAzC;gBAAA,MAEAyC;kBAAA;kBAAA;gBAAA;gBACAzC;gBACA;gBACA0C;gBACA1C;gBACAM;;gBAEA;gBACAqC,8CACA9C;kBACA6C;kBACAE;gBAAA;gBAEA5C;gBACAM;gBAEAN;gBACA;gBACAM;kBACAuC;kBACAC;oBACA9C;kBACA;kBACA+C;oBACA/C;oBACAM;sBACAC;sBACAC;oBACA;kBACA;gBACA;gBAAA;gBAAA;cAAA;gBAEAR;gBAAA,MACA;cAAA;gBAAA;gBAAA;cAAA;gBAAA;gBAAA;gBAIAA;gBACAM;kBACAC;kBACAC;gBACA;cAAA;gBAAA;gBAEA;gBACAR;gBAAA;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IAEA;IAEAgD;MAAA;MAAA;QAAA;QAAA;UAAA;YAAA;cAAA;gBACAhD;gBACAA;gBACAA;gBACAA;gBACAA;gBAEA;gBAAA;gBAGAA;gBACAA;;gBAEA;gBACAH,4CACA;kBACAuC;kBAAA;kBACAC;kBACA;kBACAC;kBACA;kBACA3B;kBACAO;kBACAF;kBACAC;kBACA;kBACAH;gBAAA;gBAGAd;gBAEAA;gBACAA;gBACAA;gBACAA;gBACAA;gBACAA;gBACAA;gBACAA;gBACAA;gBACAA;;gBAEA;gBAAA,IACAH;kBAAA;kBAAA;gBAAA;gBAAA,MACA;cAAA;gBAAA,MAEA;kBAAA;kBAAA;gBAAA;gBAAA,MACA;cAAA;gBAAA,MAEA;kBAAA;kBAAA;gBAAA;gBAAA,MACA;cAAA;gBAGAG;gBACAA;kBAAAH;gBAAA;;gBAEA;gBAAA;gBAGAG;gBAAA;gBAAA,OACAuC;kBACA1C;gBACA;cAAA;gBAFA2C;gBAGAxC;gBACAA;gBACAA;gBAAA;gBAAA;cAAA;gBAAA;gBAAA;gBAEAA;gBACAA;gBACAA;gBAAA;cAAA;gBAIA;gBACAyC;gBACAzC;gBAAA,MAEAyC;kBAAA;kBAAA;gBAAA;gBACAzC;gBACA;gBACA0C;gBACA1C;gBACAM;;gBAEA;gBACAqC,8CACA9C;kBACA6C;kBACAE;gBAAA;gBAEA5C;gBACAM;gBAEAN;gBACA;gBACAM;kBACAuC;kBACAC;oBACA9C;kBACA;kBACA+C;oBACA/C;oBACAM;sBACAC;sBACAC;oBACA;kBACA;gBACA;gBAAA;gBAAA;cAAA;gBAEAR;gBAAA,MACA;cAAA;gBAAA;gBAAA;cAAA;gBAAA;gBAAA;gBAIAA;gBACAM;kBACAC;kBACAC;gBACA;cAAA;gBAAA;gBAEA;gBACAR;gBAAA;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IAEA;EACA;AACA;AAAA,2B;;;;;;;;;;;;;ACpnBA;AAAA;AAAA;AAAA;AAAsgC,CAAgB,s7BAAG,EAAC,C;;;;;;;;;;;ACA1hC;AACA,OAAO,KAAU,EAAE,kBAKd","file":"pages/fahui/joint/confirm.js","sourcesContent":["import 'uni-pages';\n// @ts-ignore\nwx.__webpack_require_UNI_MP_PLUGIN__ = __webpack_require__;import '@dcloudio/vue-cli-plugin-uni/packages/uni-cloud/dist/index.js';\nimport Vue from 'vue'\nimport Page from './pages/fahui/joint/confirm.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./confirm.vue?vue&type=template&id=3b3c55a4&scoped=true&\"\nvar renderjs\nimport script from \"./confirm.vue?vue&type=script&lang=js&\"\nexport * from \"./confirm.vue?vue&type=script&lang=js&\"\nimport style0 from \"./confirm.vue?vue&type=style&index=0&id=3b3c55a4&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../../Desktop/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"3b3c55a4\",\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages/fahui/joint/confirm.vue\"\nexport default component.exports","export * from \"-!../../../../../../../Desktop/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../../../Desktop/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--17-0!../../../../../../../Desktop/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../../../Desktop/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../../../../Desktop/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../Desktop/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./confirm.vue?vue&type=template&id=3b3c55a4&scoped=true&\"","var components\nvar render = function () {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  var g0 = _vm.orderData.deceasedList && _vm.orderData.deceasedList.length > 0\n  var g1 = _vm.orderData.selectedItems && _vm.orderData.selectedItems.length > 0\n  _vm.$mp.data = Object.assign(\n    {},\n    {\n      $root: {\n        g0: g0,\n        g1: g1,\n      },\n    }\n  )\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../../../../Desktop/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../Desktop/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../../../../../Desktop/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../Desktop/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../Desktop/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./confirm.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../../../Desktop/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../Desktop/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../../../../../Desktop/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../Desktop/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../Desktop/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./confirm.vue?vue&type=script&lang=js&\"","<template>\n  <view class=\"confirm-page\">\n    <!-- 调试区域 - 放在最顶部 -->\n    <view style=\"background: #ff4757; padding: 30rpx; margin: 20rpx; border-radius: 15rpx; text-align: center; border: 3rpx solid #fff;\">\n      <text style=\"color: white; font-size: 36rpx; font-weight: bold; display: block; margin-bottom: 20rpx;\">🔧 调试工具</text>\n      <view style=\"display: flex; justify-content: center; gap: 20rpx; flex-wrap: wrap;\">\n        <button @click=\"showDebugInfo\" style=\"background: #2ed573; color: white; padding: 25rpx 40rpx; border-radius: 10rpx; font-size: 30rpx; border: none; min-width: 200rpx;\">\n          📊 显示调试信息\n        </button>\n        <button @click=\"refreshData\" style=\"background: #ffa502; color: white; padding: 25rpx 40rpx; border-radius: 10rpx; font-size: 30rpx; border: none; min-width: 200rpx;\">\n          🔄 强制刷新数据\n        </button>\n        <button @click=\"testOrderCreation\" style=\"background: #00d2d3; color: white; padding: 25rpx 40rpx; border-radius: 10rpx; font-size: 30rpx; border: none; min-width: 200rpx;\">\n          🧪 测试订单创建\n        </button>\n      </view>\n    </view>\n    \n    <!-- 简单调试按钮 - 备用 -->\n    <view style=\"background: #ff0000; padding: 20rpx; margin: 20rpx; text-align: center;\">\n      <button @click=\"showDebugInfo\" style=\"background: #00ff00; color: #000; padding: 20rpx; font-size: 32rpx; border: none;\">\n        调试按钮\n      </button>\n    </view>\n    \n    <view class=\"confirm-header\">\n      <view class=\"header-title\">报名确认</view>\n      <view class=\"header-subtitle\">请仔细核对以下信息</view>\n    </view>\n\n    <!-- 法会项目信息 -->\n    <view class=\"section\">\n      <view class=\"section-title\">法会项目信息</view>\n      <view class=\"info-card\">\n        <view class=\"info-row\">\n          <text class=\"info-label\">法会项目：</text>\n          <text class=\"info-value\">{{ orderData.projectName }}</text>\n        </view>\n        <view class=\"info-row\">\n          <text class=\"info-label\">法会日期：</text>\n          <text class=\"info-value\">{{ orderData.selectedDate || '待确认' }}</text>\n        </view>\n        <view class=\"info-row\">\n          <text class=\"info-label\">报名人数：</text>\n          <text class=\"info-value\">{{ orderData.applicantCount }}人</text>\n        </view>\n        <view v-if=\"orderData.chaoduType\" class=\"info-row\">\n          <text class=\"info-label\">超度类型：</text>\n          <text class=\"info-value\">{{ orderData.chaoduType }}</text>\n        </view>\n      </view>\n    </view>\n\n    <!-- 报名人信息 -->\n    <view class=\"section\">\n      <view class=\"section-title\">报名人信息</view>\n      <view class=\"applicant-list\">\n        <view v-for=\"(applicant, index) in orderData.applicants\" :key=\"'applicant-' + index\" class=\"applicant-card\">\n          <view class=\"applicant-header\">\n            <text class=\"applicant-name\">{{ applicant.name }}</text>\n            <text class=\"applicant-number\">第{{ index + 1 }}位</text>\n          </view>\n          <view class=\"applicant-info\">\n            <text class=\"info-item\">性别：{{ applicant.gender }}</text>\n            <text class=\"info-item\">电话：{{ applicant.phone }}</text>\n            <text class=\"info-item\">农历生日：{{ applicant.lunarBirthday }}</text>\n            <text class=\"info-item\">出生时辰：{{ applicant.birthTime }}</text>\n            <text class=\"info-item\">常住地址：{{ applicant.address }}</text>\n          </view>\n        </view>\n      </view>\n    </view>\n\n    <!-- 配偶信息（姻缘和合法会） -->\n    <view v-if=\"orderData.spouse && orderData.spouse.name\" class=\"section\">\n      <view class=\"section-title\">配偶信息</view>\n      <view class=\"spouse-card\">\n        <view class=\"spouse-info\">\n          <view class=\"info-row\">\n            <text class=\"info-label\">姓名：</text>\n            <text class=\"info-value\">{{ orderData.spouse.name }}</text>\n          </view>\n          <view class=\"info-row\">\n            <text class=\"info-label\">性别：</text>\n            <text class=\"info-value\">{{ orderData.spouse.gender }}</text>\n          </view>\n          <view class=\"info-row\">\n            <text class=\"info-label\">农历生日：</text>\n            <text class=\"info-value\">{{ orderData.spouse.lunarBirthday || '未填写' }}</text>\n          </view>\n          <view class=\"info-row\">\n            <text class=\"info-label\">出生时辰：</text>\n            <text class=\"info-value\">{{ orderData.spouse.birthTime || '未填写' }}</text>\n          </view>\n        </view>\n      </view>\n    </view>\n\n    <!-- 已故亲人信息（超度法会） -->\n    <view v-if=\"orderData.deceasedList && orderData.deceasedList.length > 0\" class=\"section\">\n      <view class=\"section-title\">已故亲人信息</view>\n      <view class=\"deceased-list\">\n        <view v-for=\"(deceased, index) in orderData.deceasedList\" :key=\"'deceased-' + index\" class=\"deceased-card\">\n          <view class=\"deceased-header\">\n            <text class=\"deceased-name\">{{ deceased.name }}</text>\n            <text class=\"deceased-number\">第{{ index + 1 }}位</text>\n          </view>\n          <view class=\"deceased-info\">\n            <text class=\"info-item\">关系：{{ deceased.relation }}</text>\n            <text v-if=\"deceased.lunarBirthday\" class=\"info-item\">出生农历：{{ deceased.lunarBirthday }}</text>\n            <text v-if=\"deceased.deathDate\" class=\"info-item\">去世农历：{{ deceased.deathDate }}</text>\n          </view>\n        </view>\n      </view>\n    </view>\n\n    <!-- 代办物品 -->\n    <view v-if=\"orderData.selectedItems && orderData.selectedItems.length > 0\" class=\"section\">\n      <view class=\"section-title\">代办物品</view>\n      <view class=\"goods-list\">\n        <view v-for=\"(item, index) in orderData.selectedItems\" :key=\"'goods-' + index\" class=\"goods-item\">\n          <view class=\"goods-info\">\n            <text class=\"goods-name\">{{ item.name }}</text>\n            <text class=\"goods-price\">¥{{ item.price }}/件</text>\n          </view>\n          <view class=\"goods-count\">\n            <text class=\"count-label\">数量：</text>\n            <text class=\"count-value\">{{ item.count }}件</text>\n          </view>\n          <view class=\"goods-total\">\n            <text class=\"total-label\">小计：</text>\n            <text class=\"total-value\">¥{{ item.price * item.count }}</text>\n          </view>\n        </view>\n      </view>\n    </view>\n\n    <!-- 收件信息 -->\n    <view v-if=\"orderData.receiver && orderData.receiver.name\" class=\"section\">\n      <view class=\"section-title\">收件信息</view>\n      <view class=\"receiver-card\">\n        <view class=\"info-row\">\n          <text class=\"info-label\">收件人：</text>\n          <text class=\"info-value\">{{ orderData.receiver.name }}</text>\n        </view>\n        <view class=\"info-row\">\n          <text class=\"info-label\">联系电话：</text>\n          <text class=\"info-value\">{{ orderData.receiver.phone }}</text>\n        </view>\n        <view class=\"info-row\">\n          <text class=\"info-label\">收件地址：</text>\n          <text class=\"info-value\">{{ orderData.receiver.address }}</text>\n        </view>\n      </view>\n    </view>\n\n    <!-- 费用明细 -->\n    <view class=\"section\">\n      <view class=\"section-title\">费用明细</view>\n      <view class=\"fee-card\">\n        <view class=\"fee-row\">\n          <text class=\"fee-label\">活动费用：</text>\n          <text class=\"fee-value\">¥{{ orderData.activityFee }}</text>\n        </view>\n        <view v-if=\"orderData.goodsFee > 0\" class=\"fee-row\">\n          <text class=\"fee-label\">代办费用：</text>\n          <text class=\"fee-value\">¥{{ orderData.goodsFee }}</text>\n        </view>\n        <view class=\"fee-divider\"></view>\n        <view class=\"fee-row total\">\n          <text class=\"fee-label\">总计：</text>\n          <text class=\"fee-value total-value\">¥{{ orderData.totalFee }}</text>\n        </view>\n      </view>\n    </view>\n\n    <!-- 操作按钮 -->\n    <view class=\"action-buttons\">\n      <button class=\"btn-secondary\" @click=\"goBack\">返回修改</button>\n      <button class=\"btn-primary\" @click=\"confirmOrder\" :disabled=\"isSubmitting\">\n        <view v-if=\"isSubmitting\" class=\"btn-loading\">\n          <view class=\"btn-spinner\"></view>\n          <text>提交中...</text>\n        </view>\n        <text v-else>确认报名</text>\n      </button>\n    </view>\n    \n    <!-- 调试按钮 -->\n    <view class=\"debug-section\" style=\"padding: 20rpx; background: #f0f0f0; margin: 20rpx; border-radius: 10rpx;\">\n      <text style=\"display: block; font-size: 24rpx; color: #666; margin-bottom: 10rpx;\">调试工具：</text>\n      <button class=\"debug-btn\" @click=\"refreshData\" style=\"background: #ff6b6b; color: white; margin: 10rpx; padding: 15rpx 30rpx; border-radius: 8rpx; font-size: 28rpx;\">\n        强制刷新数据\n      </button>\n      <button class=\"debug-btn\" @click=\"showDebugInfo\" style=\"background: #4ecdc4; color: white; margin: 10rpx; padding: 15rpx 30rpx; border-radius: 8rpx; font-size: 28rpx;\">\n        显示调试信息\n      </button>\n    </view>\n  </view>\n</template>\n\n<script>\nimport jointDataManager from '@/utils/jointDataManager.js'\n\n// 导入云对象\nconst jointManagement = uniCloud.importObject('joint-management')\n\nexport default {\n  data() {\n    return {\n      orderData: {},\n      isSubmitting: false\n    }\n  },\n  \n  onLoad() {\n    console.log('🔄 合坛法会确认页面加载开始')\n    console.log('🔄 页面参数:', getCurrentPages()[getCurrentPages().length - 1].options)\n    this.loadOrderData()\n    console.log('🔄 合坛法会确认页面加载完成')\n  },\n  \n  onShow() {\n    // 每次显示页面时重新加载数据，确保数据是最新的\n    console.log('🔄 合坛法会确认页面显示，重新加载数据')\n    \n    // 强制清除可能的缓存\n    this.orderData = {}\n    \n    // 立即加载数据\n    this.loadOrderData()\n    \n    // 添加延迟刷新，确保数据更新\n    setTimeout(() => {\n      this.loadOrderData()\n    }, 100)\n    \n    // 再次延迟刷新，确保数据完全更新\n    setTimeout(() => {\n      this.loadOrderData()\n    }, 500)\n  },\n  \n  methods: {\n    loadOrderData() {\n      try {\n        console.log('📋 开始加载合坛法会订单数据...')\n        \n        // 使用数据管理器获取最新数据\n        let orderData = jointDataManager.getOrderData()\n        console.log('📋 从数据管理器获取的订单数据:', orderData)\n        \n        // 如果没有订单数据，尝试从草稿获取\n        if (!orderData) {\n          const draft = jointDataManager.getDraftData()\n          if (draft) {\n            console.log('📋 从草稿获取数据:', draft)\n            // 将草稿数据转换为订单格式\n            orderData = this.convertDraftToOrder(draft)\n          }\n        }\n        \n        if (orderData) {\n          // 验证数据完整性\n          if (!jointDataManager.validateOrderData(orderData)) {\n            console.log('❌ 订单数据验证失败，尝试从草稿恢复')\n            const draft = jointDataManager.getDraftData()\n            if (draft) {\n              orderData = this.convertDraftToOrder(draft)\n            } else {\n              throw new Error('订单数据不完整且无草稿数据')\n            }\n          }\n          \n          // 清理和标准化数据\n          this.orderData = jointDataManager.cleanOrderData(orderData)\n          \n          console.log('📋 订单数据加载成功，当前orderData:', this.orderData)\n          console.log('📋 订单详情:')\n          console.log('  - 项目名称:', this.orderData.projectName)\n          console.log('  - 报名人数:', this.orderData.applicantCount)\n          console.log('  - 活动费用:', this.orderData.activityFee)\n          console.log('  - 代办费用:', this.orderData.goodsFee)\n          console.log('  - 总费用:', this.orderData.totalFee)\n          console.log('  - 报名人数量:', this.orderData.applicants ? this.orderData.applicants.length : 0)\n          console.log('  - 代办物品数量:', this.orderData.selectedItems ? this.orderData.selectedItems.length : 0)\n          console.log('  - 收件信息:', this.orderData.receiver)\n          console.log('  - 创建时间:', this.orderData.createTime ? new Date(this.orderData.createTime).toLocaleString() : '无')\n          \n          // 详细输出报名人信息\n          if (this.orderData.applicants && this.orderData.applicants.length > 0) {\n            console.log('📋 报名人详细信息:')\n            this.orderData.applicants.forEach((applicant, index) => {\n              console.log(`  - 第${index + 1}位: ${applicant.name}, ${applicant.gender}, ${applicant.phone}`)\n            })\n          }\n          \n          // 详细输出代办物品信息\n          if (this.orderData.selectedItems && this.orderData.selectedItems.length > 0) {\n            console.log('📋 代办物品详细信息:')\n            this.orderData.selectedItems.forEach((item, index) => {\n              console.log(`  - 第${index + 1}件: ${item.name}, ¥${item.price}, ${item.count}件`)\n            })\n          }\n          \n          // 重新保存到本地存储，确保数据是最新的\n          jointDataManager.saveOrderData(this.orderData)\n          \n          // 强制更新视图\n          this.$forceUpdate()\n        } else {\n          console.log('❌ 订单数据不存在')\n          uni.showToast({\n            title: '订单数据不存在，请重新填写',\n            icon: 'none'\n          })\n          setTimeout(() => {\n            uni.navigateBack({\n              delta: 2 // 返回到表单页面\n            })\n          }, 1500)\n        }\n      } catch (error) {\n        console.error('❌ 加载订单数据失败:', error)\n        uni.showToast({\n          title: '加载订单数据失败',\n          icon: 'none'\n        })\n        setTimeout(() => {\n          uni.navigateBack()\n        }, 1500)\n      }\n    },\n    \n    // 将草稿数据转换为订单格式\n    convertDraftToOrder(draft) {\n      // 这里需要根据实际的草稿数据结构来转换\n      // 由于草稿数据可能不完整，需要重新计算费用等\n      return {\n        projectName: '合坛法会', // 默认值\n        applicantCount: draft.applicants ? draft.applicants.length : 0,\n        applicants: draft.applicants || [],\n        selectedItems: draft.items || [],\n        receiver: draft.receiver || null,\n        activityFee: 0, // 需要重新计算\n        goodsFee: 0, // 需要重新计算\n        totalFee: 0, // 需要重新计算\n        spouse: draft.spouse || null,\n        deceasedList: draft.deceasedList || [],\n        chaoduType: draft.chaoduType || ''\n      }\n    },\n    \n    goBack() {\n      console.log('⬅️ 用户点击返回修改按钮')\n      uni.navigateBack()\n    },\n    \n    // 强制刷新数据\n    refreshData() {\n      console.log('🔄 强制刷新数据...')\n      this.loadOrderData()\n      uni.showToast({\n        title: '数据已刷新',\n        icon: 'success'\n      })\n    },\n    \n    // 显示调试信息\n    showDebugInfo() {\n      const debugInfo = jointDataManager.getDebugInfo()\n      \n      console.log('🔍 调试信息:', debugInfo)\n      \n      uni.showModal({\n        title: '调试信息',\n        content: `订单数据: ${debugInfo.orderData ? '存在' : '不存在'}\\n草稿数据: ${debugInfo.draftData ? '存在' : '不存在'}\\n当前数据: ${this.orderData ? '已加载' : '未加载'}`,\n        showCancel: false\n      })\n    },\n\n    // 测试订单创建\n    async testOrderCreation() {\n      console.log('🧪 开始测试订单创建...')\n      this.isSubmitting = true\n      try {\n        const orderData = {\n          projectName: '合坛法会',\n          applicantCount: 1,\n          applicants: [{\n            name: '测试用户',\n            gender: '男',\n            phone: '13800138000',\n            lunarBirthday: '2000-01-01',\n            birthTime: '08:00',\n            address: '测试地址'\n          }],\n          selectedItems: [{\n            name: '代办物品A',\n            price: 100,\n            count: 1\n          }],\n          receiver: {\n            name: '收件人',\n            phone: '13900139000',\n            address: '测试收件地址'\n          },\n          activityFee: 1000,\n          goodsFee: 500,\n          totalFee: 1500,\n          spouse: null,\n          deceasedList: [],\n          chaoduType: '',\n          fahuiType: 'joint',\n          status: '待支付',\n          createTime: new Date().getTime()\n        }\n\n        console.log('🔍 调试信息 - 测试订单数据:', orderData)\n\n        // 验证关键数据\n        if (!orderData.projectName) {\n          throw new Error('项目名称不能为空')\n        }\n        if (!orderData.applicants || orderData.applicants.length === 0) {\n          throw new Error('报名人信息不能为空')\n        }\n        if (!orderData.totalFee || orderData.totalFee <= 0) {\n          throw new Error('总费用必须大于0')\n        }\n\n        console.log('🚀 开始调用云对象创建订单...')\n        console.log('🔍 调试信息 - 云对象调用参数:', { orderData: orderData })\n        \n        // 创建订单 - 使用云对象\n        let result\n        try {\n          console.log('📞 调用 jointManagement.createOrder...')\n          result = await jointManagement.createOrder({\n            orderData: orderData\n          })\n          console.log('✅ 云对象调用成功')\n          console.log('📊 云对象返回结果类型:', typeof result)\n          console.log('📊 云对象返回结果:', result)\n        } catch (error) {\n          console.error('❌ 云对象调用失败:', error)\n          console.error('❌ 错误详情:', error.message)\n          console.error('❌ 错误堆栈:', error.stack)\n          throw error\n        }\n        \n        // 处理云对象返回结果\n        const orderResult = result\n        console.log('🚀 云对象返回结果:', result)\n        \n        if (orderResult.success && orderResult.orderId) {\n          console.log('✅ 订单创建成功')\n          // 保存订单ID\n          const orderId = orderResult.orderId\n          console.log('📋 订单ID:', orderId)\n          uni.setStorageSync('joint_fahui_order_id', orderId)\n          \n          // 保存确认数据到本地存储，供支付页面使用\n          const confirmData = {\n            ...orderData,\n            orderId: orderId,\n            confirmTime: new Date().getTime()\n          }\n          console.log('💾 保存确认数据到本地存储:', confirmData)\n          uni.setStorageSync('joint_fahui_confirm', confirmData)\n          \n          console.log('🔄 准备跳转到支付页面...')\n          // 跳转到支付页面\n          uni.navigateTo({\n            url: '/pages/fahui/joint/pay',\n            success: () => {\n              console.log('✅ 跳转到合坛法会支付页成功')\n            },\n            fail: (err) => {\n              console.error('❌ 跳转到支付页面失败:', err)\n              uni.showToast({\n                title: '页面跳转失败',\n                icon: 'none'\n              })\n            }\n          })\n        } else {\n          console.error('❌ 订单创建失败:', orderResult.message)\n          throw new Error(orderResult.message || '创建订单失败')\n        }\n        \n      } catch (error) {\n        console.error('❌ 测试订单创建失败:', error)\n        uni.showToast({\n          title: error.message || '测试订单创建失败，请重试',\n          icon: 'none'\n        })\n      } finally {\n        this.isSubmitting = false\n        console.log('🏁 测试订单创建流程结束')\n      }\n    },\n    \n    async confirmOrder() {\n      console.log('✅ 用户点击确认报名按钮')\n      console.log('🔍 调试信息 - 当前页面数据:')\n      console.log('  - orderData:', this.orderData)\n      console.log('  - 页面路径:', '/pages/fahui/joint/confirm')\n      console.log('  - 云对象导入状态:', typeof jointManagement)\n      \n      this.isSubmitting = true\n      \n      try {\n        console.log('📝 开始准备订单数据...')\n        console.log('🔍 调试信息 - 原始orderData:', this.orderData)\n        \n        // 准备订单数据\n        const orderData = {\n          ...this.orderData,\n          fahuiType: 'joint', // 添加法会类型字段\n          status: '待支付',\n          // 保持原有的创建时间，不要覆盖\n          createTime: this.orderData.createTime || new Date().getTime(),\n          // 确保字段名称统一\n          projectName: this.orderData.projectName || this.orderData.project_name,\n          totalFee: this.orderData.totalFee || this.orderData.total_fee,\n          activityFee: this.orderData.activityFee || this.orderData.activity_fee,\n          goodsFee: this.orderData.goodsFee || this.orderData.goods_fee,\n          // 确保代办物品字段统一\n          selectedItems: this.orderData.selectedItems || this.orderData.goods || []\n        }\n        \n        console.log('🔍 调试信息 - 处理后的orderData:', orderData)\n        \n        console.log('📝 准备发送的订单数据:', orderData)\n        console.log('📝 订单数据详情:')\n        console.log('  - 法会类型:', orderData.fahuiType)\n        console.log('  - 项目名称:', orderData.projectName)\n        console.log('  - 总费用:', orderData.totalFee)\n        console.log('  - 活动费用:', orderData.activityFee)\n        console.log('  - 代办费用:', orderData.goodsFee)\n        console.log('  - 代办物品数量:', orderData.goods ? orderData.goods.length : 0)\n        console.log('  - 报名人数量:', orderData.applicants ? orderData.applicants.length : 0)\n        console.log('  - 报名人详情:', orderData.applicants)\n        \n        // 验证关键数据\n        if (!orderData.projectName) {\n          throw new Error('项目名称不能为空')\n        }\n        if (!orderData.applicants || orderData.applicants.length === 0) {\n          throw new Error('报名人信息不能为空')\n        }\n        if (!orderData.totalFee || orderData.totalFee <= 0) {\n          throw new Error('总费用必须大于0')\n        }\n        \n        console.log('🚀 开始调用云对象创建订单...')\n        console.log('🔍 调试信息 - 云对象调用参数:', { orderData: orderData })\n        \n        // 创建订单 - 使用云对象\n        let result\n        try {\n          console.log('📞 调用 jointManagement.createOrder...')\n          result = await jointManagement.createOrder({\n            orderData: orderData\n          })\n          console.log('✅ 云对象调用成功')\n          console.log('📊 云对象返回结果类型:', typeof result)\n          console.log('📊 云对象返回结果:', result)\n        } catch (error) {\n          console.error('❌ 云对象调用失败:', error)\n          console.error('❌ 错误详情:', error.message)\n          console.error('❌ 错误堆栈:', error.stack)\n          throw error\n        }\n        \n        // 处理云对象返回结果\n        const orderResult = result\n        console.log('🚀 云对象返回结果:', result)\n        \n        if (orderResult.success && orderResult.orderId) {\n          console.log('✅ 订单创建成功')\n          // 保存订单ID\n          const orderId = orderResult.orderId\n          console.log('📋 订单ID:', orderId)\n          uni.setStorageSync('joint_fahui_order_id', orderId)\n          \n          // 保存确认数据到本地存储，供支付页面使用\n          const confirmData = {\n            ...orderData,\n            orderId: orderId,\n            confirmTime: new Date().getTime()\n          }\n          console.log('💾 保存确认数据到本地存储:', confirmData)\n          uni.setStorageSync('joint_fahui_confirm', confirmData)\n          \n          console.log('🔄 准备跳转到支付页面...')\n          // 跳转到支付页面\n          uni.navigateTo({\n            url: '/pages/fahui/joint/pay',\n            success: () => {\n              console.log('✅ 跳转到合坛法会支付页成功')\n            },\n            fail: (err) => {\n              console.error('❌ 跳转到支付页面失败:', err)\n              uni.showToast({\n                title: '页面跳转失败',\n                icon: 'none'\n              })\n            }\n          })\n        } else {\n          console.error('❌ 订单创建失败:', orderResult.message)\n          throw new Error(orderResult.message || '创建订单失败')\n        }\n        \n      } catch (error) {\n        console.error('❌ 确认订单失败:', error)\n        uni.showToast({\n          title: error.message || '确认订单失败，请重试',\n          icon: 'none'\n        })\n      } finally {\n        this.isSubmitting = false\n        console.log('🏁 确认订单流程结束')\n      }\n    }\n  }\n}\n</script>\n\n<style scoped>\n.confirm-page {\n  min-height: 100vh;\n  background: linear-gradient(180deg, #e0eaff 0%, #f8f8f8 100%);\n  padding-bottom: 120rpx;\n}\n\n.confirm-header {\n  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n  padding: 48rpx 24rpx 32rpx 24rpx;\n  text-align: center;\n  color: #fff;\n}\n\n.header-title {\n  font-size: 36rpx;\n  font-weight: bold;\n  margin-bottom: 12rpx;\n}\n\n.header-subtitle {\n  font-size: 26rpx;\n  opacity: 0.9;\n}\n\n.section {\n  margin: 24rpx;\n}\n\n.section-title {\n  font-size: 32rpx;\n  font-weight: bold;\n  color: #333;\n  margin-bottom: 16rpx;\n  display: flex;\n  align-items: center;\n}\n\n.section-title::before {\n  content: '';\n  width: 8rpx;\n  height: 32rpx;\n  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n  border-radius: 4rpx;\n  margin-right: 16rpx;\n}\n\n.info-card, .receiver-card, .fee-card {\n  background: #fff;\n  border-radius: 16rpx;\n  padding: 24rpx;\n  box-shadow: 0 4rpx 16rpx rgba(0,0,0,0.08);\n}\n\n.info-row, .fee-row {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 12rpx 0;\n  border-bottom: 1rpx solid #f0f0f0;\n}\n\n.info-row:last-child, .fee-row:last-child {\n  border-bottom: none;\n}\n\n.info-label, .fee-label {\n  font-size: 28rpx;\n  color: #666;\n  min-width: 160rpx;\n}\n\n.info-value, .fee-value {\n  font-size: 28rpx;\n  color: #333;\n  font-weight: bold;\n  text-align: right;\n  flex: 1;\n}\n\n.fee-divider {\n  height: 1rpx;\n  background: #e0e0e0;\n  margin: 16rpx 0;\n}\n\n.fee-row.total {\n  border-bottom: none;\n  padding-top: 16rpx;\n}\n\n.total-value {\n  color: #ff6b35;\n  font-size: 32rpx;\n}\n\n.applicant-list, .deceased-list {\n  display: flex;\n  flex-direction: column;\n  gap: 16rpx;\n}\n\n.applicant-card, .deceased-card {\n  background: #fff;\n  border-radius: 16rpx;\n  padding: 24rpx;\n  box-shadow: 0 4rpx 16rpx rgba(0,0,0,0.08);\n}\n\n.applicant-header, .deceased-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 16rpx;\n}\n\n.applicant-name, .deceased-name {\n  font-size: 28rpx;\n  font-weight: bold;\n  color: #333;\n}\n\n.applicant-number, .deceased-number {\n  font-size: 24rpx;\n  color: #667eea;\n  background: rgba(102, 126, 234, 0.1);\n  padding: 8rpx 16rpx;\n  border-radius: 20rpx;\n}\n\n.applicant-info, .deceased-info {\n  display: flex;\n  flex-direction: column;\n  gap: 8rpx;\n}\n\n.info-item {\n  font-size: 26rpx;\n  color: #666;\n}\n\n.goods-list {\n  display: flex;\n  flex-direction: column;\n  gap: 16rpx;\n}\n\n.goods-item {\n  background: #fff;\n  border-radius: 16rpx;\n  padding: 24rpx;\n  box-shadow: 0 4rpx 16rpx rgba(0,0,0,0.08);\n}\n\n.goods-info {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 12rpx;\n}\n\n.goods-name {\n  font-size: 28rpx;\n  font-weight: bold;\n  color: #333;\n}\n\n.goods-price {\n  font-size: 26rpx;\n  color: #ff6b35;\n}\n\n.goods-count {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 8rpx;\n}\n\n.count-label {\n  font-size: 26rpx;\n  color: #666;\n}\n\n.count-value {\n  font-size: 26rpx;\n  color: #333;\n  font-weight: bold;\n}\n\n.goods-total {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n}\n\n.total-label {\n  font-size: 26rpx;\n  color: #666;\n}\n\n.total-value {\n  font-size: 26rpx;\n  color: #ff6b35;\n  font-weight: bold;\n}\n\n.action-buttons {\n  position: fixed;\n  bottom: 0;\n  left: 0;\n  right: 0;\n  background: #fff;\n  padding: 24rpx;\n  box-shadow: 0 -4rpx 16rpx rgba(0,0,0,0.1);\n  display: flex;\n  gap: 16rpx;\n}\n\n.btn-secondary, .btn-primary {\n  flex: 1;\n  padding: 24rpx;\n  border-radius: 50rpx;\n  font-size: 32rpx;\n  font-weight: bold;\n  border: none;\n}\n\n.btn-secondary {\n  background: #f5f5f5;\n  color: #666;\n}\n\n.btn-primary {\n  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n  color: #fff;\n  box-shadow: 0 8rpx 32rpx rgba(102, 126, 234, 0.3);\n}\n\n.btn-loading {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n\n.btn-spinner {\n  width: 32rpx;\n  height: 32rpx;\n  border: 4rpx solid rgba(255,255,255,0.3);\n  border-top: 4rpx solid #fff;\n  border-radius: 50%;\n  animation: spin 1s linear infinite;\n  margin-right: 12rpx;\n}\n\n@keyframes spin {\n  0% { transform: rotate(0deg); }\n  100% { transform: rotate(360deg); }\n}\n</style> ","import mod from \"-!../../../../../../../Desktop/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../../../../Desktop/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../../../../Desktop/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../Desktop/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-2!../../../../../../../Desktop/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../../../../Desktop/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../Desktop/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./confirm.vue?vue&type=style&index=0&id=3b3c55a4&scoped=true&lang=css&\"; export default mod; export * from \"-!../../../../../../../Desktop/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../../../../Desktop/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../../../../Desktop/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../Desktop/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-2!../../../../../../../Desktop/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../../../../Desktop/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../Desktop/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./confirm.vue?vue&type=style&index=0&id=3b3c55a4&scoped=true&lang=css&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1754022713995\n      var cssReload = require(\"C:/Users/qub/Desktop/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"/\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}