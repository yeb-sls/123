{"version":3,"sources":["uni-app:///main.js","webpack:///C:/Users/qub/Documents/HBuilderProjects/123/景区小程序/pages/fahui/joint/form.vue?0d02","webpack:///C:/Users/qub/Documents/HBuilderProjects/123/景区小程序/pages/fahui/joint/form.vue?9192","webpack:///C:/Users/qub/Documents/HBuilderProjects/123/景区小程序/pages/fahui/joint/form.vue?9b67","webpack:///C:/Users/qub/Documents/HBuilderProjects/123/景区小程序/pages/fahui/joint/form.vue?9ee1","uni-app:///pages/fahui/joint/form.vue","webpack:///C:/Users/qub/Documents/HBuilderProjects/123/景区小程序/pages/fahui/joint/form.vue?e2b3","webpack:///C:/Users/qub/Documents/HBuilderProjects/123/景区小程序/pages/fahui/joint/form.vue?e2bb"],"names":["wx","__webpack_require_UNI_MP_PLUGIN__","__webpack_require__","createPage","Page","components","uniPopup","data","isLoading","isSubmitting","projectId","applicants","editApplicant","editIndex","jointProjects","jointProjectIdx","currentProject","selectedDateIdx","selectedDate","spouse","name","gender","lunarBirthday","birthTime","editSpouse","chaoduType","chaoduTypes","deceasedList","editDeceased","editDeceasedIndex","items","showItems","receiver","phone","address","showReceiver","receiverConfig","genderOptions","birthTimeOptions","deceasedRelationOptions","computed","hasSelectedItems","projectNames","genderIndex","birthTimeIndex","chaoduTypeIndex","spouseGenderIndex","spouseBirthTimeIndex","deceasedRelationIndex","hasProjectDates","showSpouseInfo","isYinyuanProject","isChaoduProject","onLoad","console","onShow","methods","loadData","index","uni","title","icon","loadJointProjects","jointManagement","result","_id","price","description","category","deadline","dates","maxApplicants","loadItemsConfig","moduleResult","moduleEnabled","item","count","loadReceiverConfig","oldShowReceiver","getReceiverConfig","checkModuleConfig","checkResult","projectInfo","projectItems","itemsResult","message","content","showCancel","checkReceiverConfig","receiverResult","addApplicant","removeApplicant","openApplicantDialog","saveApplicant","setTimeout","duration","closePopup","onGenderChange","onLunarBirthdayChange","onBirthTimeChange","onProjectChange","onDateChange","onChaoduTypeChange","addDeceased","deathDate","relation","removeDeceased","openDeceasedDialog","saveDeceased","closeDeceasedPopup","onDeceasedLunarBirthdayChange","onDeceasedDeathDateChange","onDeceasedRelationChange","openSpouseDialog","saveSpouse","closeSpousePopup","onSpouseGenderChange","onSpouseLunarBirthdayChange","onSpouseBirthTimeChange","validateName","validatePhone","checkAndClearOldData","success","saveDraft","loadDraft","validateForm","i","applicant","missingFields","confirmText","deceased","nextStep","activityFee","goodsFee","selectedItems","orderData","type","projectName","projectPrice","totalFee","applicantCount","createTime","jointDataManager","url","fail","debugData","debugApplicants","cancelText","forceRefreshData","quickFix"],"mappings":";;;;;;;;;;;;;AAAA;AAE2D;AAC3D;AACA;AAHA;AACAA,EAAE,CAACC,iCAAiC,GAAGC,mBAAmB;AAG1DC,UAAU,CAACC,aAAI,CAAC,C;;;;;;;;;;;;;ACLhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAA6H;AAC7H;AACwD;AACL;AACqC;;;AAGxF;AACoL;AACpL,gBAAgB,qLAAU;AAC1B,EAAE,0EAAM;AACR,EAAE,2FAAM;AACR,EAAE,oGAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,+FAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACvBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA,aAAa,8LAEN;AACP,KAAK;AACL;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;AC5EA;AAAA;AAAA;AAAA;AAAsrB,CAAgB,spBAAG,EAAC,C;;;;;;;;;;;;;;;;;;;;;;ACgT1sB;AAAA;AAAA;AAAA;EAAA;IAAA;EAAA;AAAA;AAEA;AACA;AAAA,eAEA;EACAC;IACAC;EACA;EACAC;IACA;MACAC;MACAC;MACAC;MAEA;MACAC;MACAC;MACAC;MAEA;MACAC;MACAC;MACAC;MACAC;MACAC;MAEA;MACAC;QACAC;QACAC;QACAC;QACAC;MACA;MACAC;MAEA;MACAC;MACAC;MACAC;MACAC;MACAC;MAEA;MACAC;MACAC;MAEA;MACAC;QACAZ;QACAa;QACAC;MACA;MACAC;MACAC;MAEA;MACAC;MACAC;MACAC;IACA;EACA;EAEAC;IACAC;MACA;QAAA;MAAA;IACA;IACAC;MACA;QAAA;MAAA;IACA;IACAC;MACA;IACA;IACAC;MACA;IACA;IACAC;MACA;IACA;IACAC;MACA;IACA;IACAC;MACA;IACA;IACAC;MACA;IACA;IACAC;MACA;IACA;IACAC;MACA;IACA;IACAC;MACA;IACA;IACAC;MACA;IACA;EACA;EAEAC;IACAC;IACAA;IACAA;IACAA;IAEA;MACA;MACAA;IACA;IAEAA;IACA;IACAA;EACA;EAEAC;IACAD;IACAA;IACAA;IAEAA;IACA;IACAA;IAEAA;IACA;IACAA;IAEAA;EACA;EAEAE;IACAC;MAAA;MAAA;QAAA;QAAA;UAAA;YAAA;cAAA;gBACAH;gBAAA;gBAEA;gBACAA;;gBAEA;gBACAA;gBAAA;gBAAA,OACA;cAAA;gBACAA;;gBAEA;gBACAA;gBAAA;gBAAA,OACA;cAAA;gBACAA;;gBAEA;gBAAA,KACA;kBAAA;kBAAA;gBAAA;gBACAA;gBACAI;kBAAA;gBAAA;gBAAA,MACAA;kBAAA;kBAAA;gBAAA;gBACA;gBACA;gBACAJ;gBACA;gBAAA;gBAAA,OACA;cAAA;gBAAA;gBAAA;cAAA;gBAEAA;cAAA;gBAIA;gBACAA;gBACA;kBACAA;kBACA;kBACAA;gBACA;kBACAA;kBACAA;gBACA;gBAEAA;gBACAA;gBACAA;gBACAA;gBACAA;gBACAA;gBACAA;gBACAA;gBACAA;gBAEA;gBACAA;gBAAA;gBAAA;cAAA;gBAAA;gBAAA;gBAEAA;gBACAK;kBACAC;kBACAC;gBACA;gBACA;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IAEA;IAEAC;MAAA;MAAA;QAAA;QAAA;UAAA;YAAA;cAAA;gBAAA;gBAAA;gBAAA,OAEAC;cAAA;gBAAAC;gBAEA;kBACA;gBACA;kBACA;kBACA,wBACA;oBACAC;oBACA7C;oBACA8C;oBACAC;oBACAC;oBACAC;oBACAC;oBACAC;kBACA,GACA;oBACAN;oBACA7C;oBACA8C;oBACAC;oBACAC;oBACAC;oBACAC;oBACAC;kBACA,GACA;oBACAN;oBACA7C;oBACA8C;oBACAC;oBACAC;oBACAC;oBACAC;oBACAC;kBACA,EACA;gBACA;gBAAA;gBAAA;cAAA;gBAAA;gBAAA;gBAEAjB;gBAAA;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IAGA;IAEAkB;MAAA;MAAA;QAAA;QAAA;UAAA;YAAA;cAAA;gBAAA,IACA9D;kBAAA;kBAAA;gBAAA;gBACA4C;gBACA;gBACA;gBAAA;cAAA;gBAAA;gBAKAA;;gBAEA;gBAAA;gBAAA,OACAS;cAAA;gBAAAU;gBAEAnB;gBAEAoB;gBACA;kBACAA;kBACApB;gBACA;kBACAA;gBACA;;gBAEA;gBAAA,IACAoB;kBAAA;kBAAA;gBAAA;gBACApB;gBACA;gBACA;gBAAA;cAAA;gBAIAA;;gBAEA;gBAAA;gBAAA,OACAS;kBAAArD;gBAAA;cAAA;gBAAAsD;gBAEAV;gBAEA;kBACAA;kBACA;kBACA;oBAAA,uCACAqB;sBACAC;oBAAA;kBAAA,CACA;gBACA;kBACAtB;kBACA;kBACA;gBACA;gBAAA;gBAAA;cAAA;gBAAA;gBAAA;gBAEAA;gBACA;gBACA;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IAEA;IAEAuB;MAAA;MAAA;QAAA;QAAA;UAAA;YAAA;cAAA;gBAAA;gBAEAvB;gBACAA;gBAAA;gBAAA,OAEAS;cAAA;gBAAAC;gBAEAV;gBACAA;gBAEA;kBACA;kBACAwB;kBACA;kBACAxB;kBACAA;kBACAA;kBACAA;gBACA;kBACAwB;kBACA;kBACA;kBACAxB;kBACAA;kBACAA;gBACA;gBAEAA;gBAAA;gBAAA;cAAA;gBAAA;gBAAA;gBAEAA;gBACAA;gBACAwB;gBACA;gBACA;gBACAxB;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IAEA;IAEAyB;MAAA;QAAA;QAAA;UAAA;YAAA;cAAA;gBAAA;gBAEAzB;gBAAA;gBAAA,OACAS;cAAA;gBAAAC;gBAEAV;gBAAA,MAEAU;kBAAA;kBAAA;gBAAA;gBACAV;gBAAA,kCACAU;cAAA;gBAEAV;gBAAA,kCACA;cAAA;gBAAA;gBAAA;gBAEAA;gBAAA,kCACA;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IAEA;IAEA0B;MAAA;MAAA;QAAA;QAAA;UAAA;YAAA;cAAA;gBAAA;gBAEA1B;;gBAEA;gBAAA;gBAAA,OACAS;cAAA;gBAAAU;gBACAnB;;gBAEA;gBAAA;gBAAA,OACAS;cAAA;gBAAAkB;gBACA3B;;gBAEA;gBACA4B;gBACA;kBACAA;gBACA;;gBAEA;gBACAC;gBAAA,MACA;kBAAA;kBAAA;gBAAA;gBAAA;gBAAA;gBAAA,OAEApB;kBAAArD;gBAAA;cAAA;gBAAA0E;gBACA;kBACAD;gBACA;gBAAA;gBAAA;cAAA;gBAAA;gBAAA;gBAEAA;cAAA;gBAIA;gBACAE;gBACAA;gBACAA;gBACAA;gBACAA;gBACAA;gBACAA;gBACAA;gBAEA1B;kBACAC;kBACA0B;kBACAC;gBACA;gBAAA;gBAAA;cAAA;gBAAA;gBAAA;gBAGAjC;gBACAK;kBACAC;kBACAC;gBACA;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IAEA;IAEA2B;MAAA;MAAA;QAAA;QAAA;UAAA;YAAA;cAAA;gBAAA;gBAEAlC;;gBAEA;gBAAA;gBAAA,OACAS;cAAA;gBAAA0B;gBACAnC;;gBAEA;gBAAA;gBAAA,OACAS;cAAA;gBAAAkB;gBACA3B;;gBAEA;gBACA+B;gBACAA;gBACAA;gBACAA;gBACAA;gBACAA;gBACAA;gBACAA;gBACAA;gBACAA;gBACAA;gBACAA;gBACAA;gBAEA1B;kBACAC;kBACA0B;kBACAC;gBACA;gBAAA;gBAAA;cAAA;gBAAA;gBAAA;gBAGAjC;gBACAK;kBACAC;kBACAC;gBACA;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IAEA;IAEA;IACA6B;MACApC;MACAA;MAEA;QACAA;QACAK;UACAC;UACAC;QACA;QACA;MACA;MAEA;QACAzC;QACAC;QACAY;QACAX;QACAC;QACAW;MACA;MAEAoB;MACA;MACAA;MAEA;MACAA;IACA;IAEAqC;MACA;MACA;IACA;IAEAC;MACAtC;MACAA;MAEA;MACA;MAEAA;MACAA;MAEA;IACA;IAEAuC;MAAA;MACAvC;MACAA;MACAA;MAEA;QACAK;UACAC;UACAC;QACA;QACA;MACA;MAEA;QACAF;UACAC;UACAC;QACA;QACA;MACA;MAEA;QACAF;UACAC;UACAC;QACA;QACA;MACA;MAEA;QACAF;UACAC;UACAC;QACA;QACA;MACA;MAEA;QACAF;UACAC;UACAC;QACA;QACA;MACA;MAEA;QACAF;UACAC;UACAC;QACA;QACA;MACA;;MAEA;MACAP;;MAEA;MACA;;MAEA;MACA;QACA;MACA;QACA;QACA;MACA;;MAEA;MACAA;MACAA;MACAA;;MAEA;MACA;MAEA;MACA;;MAEA;MACAwC;QACAxC;QACAA;;QAEA;QACAK;UACAC;UACAC;UACAkC;QACA;MACA;MAEAzC;IACA;IAEA0C;MACA;MACA;MACA;IACA;IAEA;IACAC;MACA;IACA;IAEAC;MACA;IACA;IAEAC;MACA;IACA;IAEAC;MAAA;MAAA;QAAA;UAAA;YAAA;cAAA;gBACA;gBACA;gBACA9C;gBACAA;gBACAA;gBAEA;gBACA;gBACA;gBACA;;gBAEA;gBAAA,MACA;kBAAA;kBAAA;gBAAA;gBACAA;gBAAA;gBAAA,OACA;cAAA;gBAAA;gBAAA;cAAA;gBAEAA;gBACA;gBACA;cAAA;gBAGA;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IACA;IAEA+C;MACA;MACA;MACA;IACA;IAEAC;MACA;MACA;IACA;IAEA;IACAC;MACA;QACA5C;UACAC;UACAC;QACA;QACA;MACA;MAEA;QACAzC;QACAE;QACAkF;QACAC;MACA;MACA;IACA;IAEAC;MACA;MACA;IACA;IAEAC;MACA;MACA;MACA;IACA;IAEAC;MACA;QACAjD;UACAC;UACAC;QACA;QACA;MACA;MAEA;QACAF;UACAC;UACAC;QACA;QACA;MACA;MAEA;MACA;MACA;IACA;IAEAgD;MACA;MACA;MACA;IACA;IAEAC;MACA;IACA;IAEAC;MACA;IACA;IAEAC;MACA;IACA;IAEA;IACAC;MACA;MACA;IACA;IAEAC;MACA;MACA;MACA;IACA;IAEAC;MACA;MACA;IACA;IAEAC;MACA;IACA;IAEAC;MACA;IACA;IAEAC;MACA;IACA;IAEA;IACAC;MACA;QACA5D;UACAC;UACAC;QACA;MACA;IACA;IAEA2D;MACA;QACA7D;UACAC;UACAC;QACA;MACA;IACA;IAEA;IACA4D;MACA;QACA;QACA;QACA;UACA;UACA;UACA;;UAEA;UACA;YACAnE;YACA;UACA;UAEAA;UACAK;YACAC;YACA0B;YACAoC;cACA;gBACA;gBACA/D;gBACAA;gBACAA;gBACAL;gBACAK;kBACAC;kBACAC;gBACA;cACA;YACA;UACA;QACA;MACA;QACAP;MACA;IACA;IAEA;IACAqE;MACArE;MACAA;MAEA;QACA3C;QACAI;QACAE;QACAC;QACAC;QACAM;QACAE;QACAG;QACAE;MACA;MAEAsB;MAEA;QACAK;QACAL;;QAEA;QACA;QACAA;QACAA;MACA;QACAA;MACA;IACA;IAEAsE;MACA;QACAtE;QACA;QAEA;QACAA;QAEA;UACAA;UAEA;UACA;UACA;UACA;UACA;YAAAlC;YAAAC;YAAAC;YAAAC;UAAA;UACA;UACA;UACA;UACA;YAAAH;YAAAa;YAAAC;UAAA;UAEA;YACA;UACA;UAEAoB;UACAA;UACAA;UACAA;QACA;UACAA;QACA;MACA;QACAA;MACA;IACA;IAEA;IACAuE;MAAA;MAAA;QAAA;QAAA;UAAA;YAAA;cAAA;gBACAvE;gBACAA;gBACAA;gBAAA,MAEA;kBAAA;kBAAA;gBAAA;gBACAA;gBACAK;kBACAC;kBACAC;gBACA;gBAAA,kCACA;cAAA;gBAGAiE;cAAA;gBAAA;kBAAA;kBAAA;gBAAA;gBACAC;gBACAzE;gBACAA;gBACAA;gBACAA;gBACAA;gBACAA;gBACAA;gBACAA;gBAAA,MAEA,4DACA;kBAAA;kBAAA;gBAAA;gBACAA;;gBAEA;gBACA0E;gBACA;gBACA;gBACA;gBACA;gBACA;gBACA;gBAEArE;kBACAC;kBACA0B;kBACAC;kBACA0C;gBACA;gBAAA,kCACA;cAAA;gBA9BAH;gBAAA;gBAAA;cAAA;gBAAA,IAkCA;kBAAA;kBAAA;gBAAA;gBACAnE;kBACAC;kBACAC;gBACA;gBAAA,kCACA;cAAA;gBAAA,MAGA;kBAAA;kBAAA;gBAAA;gBAAA,IACA;kBAAA;kBAAA;gBAAA;gBACAF;kBACAC;kBACAC;gBACA;gBAAA,kCACA;cAAA;gBAAA,MAGA;kBAAA;kBAAA;gBAAA;gBACAF;kBACAC;kBACAC;gBACA;gBAAA,kCACA;cAAA;gBAGAiE;cAAA;gBAAA;kBAAA;kBAAA;gBAAA;gBACAI;gBAAA,MACA;kBAAA;kBAAA;gBAAA;gBACAvE;kBACAC;kBACAC;gBACA;gBAAA,kCACA;cAAA;gBAPAiE;gBAAA;gBAAA;cAAA;gBAYA;gBACAxE;gBAAA,KACA;kBAAA;kBAAA;gBAAA;gBACAA;gBAAA;gBAAA,OACA;cAAA;gBAAAlB;gBACAkB;gBAAA,KAEAlB;kBAAA;kBAAA;gBAAA;gBACAkB;gBAAA,MACAlB;kBAAA;kBAAA;gBAAA;gBACAkB;gBACAK;kBACAC;kBACAC;gBACA;gBAAA,kCACA;cAAA;gBAGAP;gBAAA,MACAlB;kBAAA;kBAAA;gBAAA;gBACAkB;gBACAK;kBACAC;kBACAC;gBACA;gBAAA,kCACA;cAAA;gBAGAP;gBAAA,MACAlB;kBAAA;kBAAA;gBAAA;gBACAkB;gBACAK;kBACAC;kBACAC;gBACA;gBAAA,kCACA;cAAA;gBAGAP;gBAAA;gBAAA;cAAA;gBAEAA;cAAA;gBAAA;gBAAA;cAAA;gBAGAA;cAAA;gBAAA,kCAGA;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IACA;IAEA;IACA6E;MAAA;MAAA;QAAA;QAAA;UAAA;YAAA;cAAA;gBACA7E;gBACAA;gBACAA;gBACAA;gBACAA;gBAAA;gBAAA,OAEA;cAAA;gBAAA;kBAAA;kBAAA;gBAAA;gBAAA;cAAA;gBAIA;gBAEA;kBACA;kBACA8E;kBACAC;kBACAC,oBAEA;kBACA;oBACA;oBACAF;kBACA;oBACA;oBACAA;kBACA;kBAEA;oBACA;sBACA;wBACAC;wBACAC;0BACAlH;0BACA8C;0BACAU;wBACA;sBACA;oBACA;kBACA;;kBAEA;kBACA2D;oBACAC;oBACA9H;oBACA+H;oBACAC;oBACAxH;oBACAO;oBACAd;oBACAQ;oBACAQ;oBACA2G;oBACAtG;oBACAoG;oBACAC;oBACAM;oBACAC;oBACAC;kBACA;;kBAEAvF;;kBAEA;kBACAA;;kBAEA;kBACAwF;;kBAEA;kBACAA;;kBAEA;kBACAnF;oBACAoF;oBACArB;sBACApE;oBACA;oBACA0F;sBACA1F;sBACAK;wBACAC;wBACAC;sBACA;oBACA;kBACA;gBAEA;kBACAP;kBACAK;oBACAC;oBACAC;kBACA;gBACA;kBACA;gBACA;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IACA;IAEA;IACAoF;MACA3F;MACAA;MACAA;MACAA;MACAA;MAEA;MACAA;;MAEA;MACA;MACAA;IACA;IAEA;IACA4F;MAAA;MACA5F;MACAA;MACAA;MAEA;QACAA;QACAA;QACAA;QACAA;QACAA;QACAA;QACAA;MACA;;MAEA;MACA;QACA;QACAA;QACAA;MACA;QACAA;MACA;;MAEA;MACA;MACA+B;MAEA;QACAA;QACAA;QACAA;QACAA;QACAA;QACAA;QACAA;MACA;MAEA1B;QACAC;QACA0B;QACAC;QACA4D;QACAlB;QACAP;UACA;YACA;UACA;QACA;MACA;IACA;IAEA;IACA0B;MAAA;MACA9F;;MAEA;MACA;;MAEA;MACA;;MAEA;MACAwC;QACAxC;QAEAK;UACAC;UACAC;UACAkC;QACA;MACA;IACA;IAEA;IACAsD;MACA/F;;MAEA;MACA;QACAA;QACA;UACAlC;UACAC;UACAY;UACAX;UACAC;UACAW;QACA;MACA;QACAoB;QACA;QACA;UAAA;YACAlC;YACAC;YACAY;YACAX;YACAC;YACAW;UACA;QAAA;MACA;;MAEA;MACA;;MAEA;MACA;MAEAoB;MAEAK;QACAC;QACA0B;QACAC;QACA0C;MACA;IACA;EACA;AACA;AAAA,2B;;;;;;;;;;;;;ACrhDA;AAAA;AAAA;AAAA;AAAmgC,CAAgB,m7BAAG,EAAC,C;;;;;;;;;;;ACAvhC;AACA,OAAO,KAAU,EAAE,kBAKd","file":"pages/fahui/joint/form.js","sourcesContent":["import 'uni-pages';\n// @ts-ignore\nwx.__webpack_require_UNI_MP_PLUGIN__ = __webpack_require__;import '@dcloudio/vue-cli-plugin-uni/packages/uni-cloud/dist/index.js';\nimport Vue from 'vue'\nimport Page from './pages/fahui/joint/form.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./form.vue?vue&type=template&id=4bb6e490&scoped=true&\"\nvar renderjs\nimport script from \"./form.vue?vue&type=script&lang=js&\"\nexport * from \"./form.vue?vue&type=script&lang=js&\"\nimport style0 from \"./form.vue?vue&type=style&index=0&id=4bb6e490&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../../Desktop/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"4bb6e490\",\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages/fahui/joint/form.vue\"\nexport default component.exports","export * from \"-!../../../../../../../Desktop/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../../../Desktop/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--17-0!../../../../../../../Desktop/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../../../Desktop/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../../../../Desktop/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../Desktop/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./form.vue?vue&type=template&id=4bb6e490&scoped=true&\"","var components\ntry {\n  components = {\n    uniPopup: function () {\n      return import(\n        /* webpackChunkName: \"components/uni-popup/uni-popup\" */ \"@/components/uni-popup/uni-popup.vue\"\n      )\n    },\n  }\n} catch (e) {\n  if (\n    e.message.indexOf(\"Cannot find module\") !== -1 &&\n    e.message.indexOf(\".vue\") !== -1\n  ) {\n    console.error(e.message)\n    console.error(\"1. 排查组件名称拼写是否正确\")\n    console.error(\n      \"2. 排查组件是否符合 easycom 规范，文档：https://uniapp.dcloud.net.cn/collocation/pages?id=easycom\"\n    )\n    console.error(\n      \"3. 若组件不符合 easycom 规范，需手动引入，并在 components 中注册该组件\"\n    )\n  } else {\n    throw e\n  }\n}\nvar render = function () {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  var g0 = !_vm.isLoading ? _vm.applicants.length : null\n  var l0 = !_vm.isLoading\n    ? _vm.__map(_vm.applicants, function (applicant, idx) {\n        var $orig = _vm.__get_orig(applicant)\n        var g1 = _vm.applicants.length\n        return {\n          $orig: $orig,\n          g1: g1,\n        }\n      })\n    : null\n  var g2 = !_vm.isLoading ? _vm.applicants.length : null\n  var l1 =\n    !_vm.isLoading && _vm.isChaoduProject\n      ? _vm.__map(_vm.deceasedList, function (deceased, idx) {\n          var $orig = _vm.__get_orig(deceased)\n          var g3 = _vm.deceasedList.length\n          return {\n            $orig: $orig,\n            g3: g3,\n          }\n        })\n      : null\n  var g4 =\n    !_vm.isLoading && _vm.isChaoduProject ? _vm.deceasedList.length : null\n  var g5 = !_vm.isLoading && true ? _vm.applicants.length : null\n  var g6 = !_vm.isLoading && true ? _vm.deceasedList.length : null\n  var g7 = !_vm.isLoading && true ? _vm.items.length : null\n  _vm.$mp.data = Object.assign(\n    {},\n    {\n      $root: {\n        g0: g0,\n        l0: l0,\n        g2: g2,\n        l1: l1,\n        g4: g4,\n        g5: g5,\n        g6: g6,\n        g7: g7,\n      },\n    }\n  )\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../../../../Desktop/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../Desktop/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../../../../../Desktop/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../Desktop/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../Desktop/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./form.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../../../Desktop/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../Desktop/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../../../../../Desktop/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../Desktop/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../Desktop/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./form.vue?vue&type=script&lang=js&\"","<template>\r\n  <view class=\"form-bg\">\r\n    <!-- 加载状态 -->\r\n    <view v-if=\"isLoading\" class=\"loading-container\">\r\n      <view class=\"loading-spinner\"></view>\r\n      <text class=\"loading-text\">加载中...</text>\r\n    </view>\r\n    \r\n    <view v-else class=\"form-container\">\r\n      <view class=\"form-title\">合坛法会报名</view>\r\n      <view class=\"form-help\">\r\n        <text>📝 请仔细填写所有必填信息，确保信息准确完整</text>\r\n        <text>👥 可添加最多5位报名人，每人信息需完整</text>\r\n        <text>💝 不同法会类型有特殊要求，请按提示填写</text>\r\n        <text>💾 数据会自动保存，可随时返回继续填写</text>\r\n      </view>\r\n\r\n      <!-- 报名人信息管理 -->\r\n      <view class=\"section-title\">报名人信息 <text class=\"section-tip\">（最多5人，每人信息需完整）</text></view>\r\n      <view class=\"section-tip-full\">点击\"编辑\"按钮可修改报名人信息</view>\r\n      \r\n      <!-- 调试信息显示 -->\r\n      <view class=\"debug-info\">\r\n        <text class=\"debug-text\">调试信息：报名人数量 {{ applicants.length }}</text>\r\n        <text class=\"debug-text\">当前项目：{{ currentProject ? currentProject.name : '未选择' }}</text>\r\n      </view>\r\n      <view class=\"applicant-list\">\r\n        <view v-for=\"(applicant, idx) in applicants\" :key=\"idx\" class=\"applicant-card\">\r\n          <view class=\"applicant-header\">\r\n            <text class=\"applicant-name\">{{ applicant.name || '未填写' }}</text>\r\n            <view class=\"applicant-actions\">\r\n              <button class=\"mini-btn\" size=\"mini\" @click=\"openApplicantDialog(idx)\">编辑</button>\r\n              <button v-if=\"applicants.length > 1\" class=\"mini-btn danger\" size=\"mini\" @click=\"removeApplicant(idx)\">删除</button>\r\n            </view>\r\n          </view>\r\n          <!-- 调试信息 -->\r\n          <view class=\"debug-applicant\">\r\n            <text class=\"debug-applicant-text\">调试：姓名=\"{{ applicant.name }}\" 性别=\"{{ applicant.gender }}\" 电话=\"{{ applicant.phone }}\"</text>\r\n          </view>\r\n          <view class=\"applicant-info-row\">\r\n            <text>性别：</text><text class=\"info-value\">{{ applicant.gender || '未选' }}</text>\r\n            <text>电话：</text><text class=\"info-value\">{{ applicant.phone || '未填' }}</text>\r\n          </view>\r\n          <view class=\"applicant-info-row\">\r\n            <text>农历生日：</text><text class=\"info-value\">{{ applicant.lunarBirthday || '未选' }}</text>\r\n            <text>出生时辰：</text><text class=\"info-value\">{{ applicant.birthTime || '未选' }}</text>\r\n          </view>\r\n          <view class=\"applicant-info-row\">\r\n            <text>常住地址：</text><text class=\"info-value\">{{ applicant.address || '未填' }}</text>\r\n          </view>\r\n        </view>\r\n      </view>\r\n      <button class=\"add-btn\" @click=\"addApplicant\" :disabled=\"applicants.length>=5\" size=\"mini\">+ 添加报名人</button>\r\n      \r\n      <!-- 调试按钮 -->\r\n      <button class=\"debug-btn\" @click=\"debugApplicants\" size=\"mini\">调试报名人数据</button>\r\n      <button class=\"fix-btn\" @click=\"quickFix\" size=\"mini\">快速修复数据</button>\r\n\r\n      <!-- 报名人弹窗 -->\r\n      <uni-popup ref=\"popup\" type=\"center\">\r\n        <view class=\"popup-content\">\r\n          <view class=\"popup-title\">报名者信息</view>\r\n          <view class=\"popup-tip\">带 * 的字段为必填项</view>\r\n          <input v-model=\"editApplicant.name\" placeholder=\"* 姓名（必填）\" class=\"input\" maxlength=\"20\" @blur=\"validateName\" @input=\"saveDraft\" />\r\n          <picker :range=\"genderOptions\" @change=\"onGenderChange\" :value=\"genderIndex\">\r\n            <view class=\"picker\">\r\n              <text class=\"picker-label\">* 性别：</text>\r\n              <text class=\"picker-value\">{{ editApplicant.gender || '请选择' }}</text>\r\n              <text class=\"picker-arrow\">▼</text>\r\n            </view>\r\n          </picker>\r\n                      <input v-model=\"editApplicant.phone\" placeholder=\"* 联系电话（必填）\" class=\"input\" type=\"tel\" maxlength=\"11\" @blur=\"validatePhone\" @input=\"saveDraft\" />\r\n          <picker mode=\"date\" @change=\"onLunarBirthdayChange\" :value=\"editApplicant.lunarBirthday\">\r\n            <view class=\"picker\">\r\n              <text class=\"picker-label\">* 农历生日：</text>\r\n              <text class=\"picker-value\">{{ editApplicant.lunarBirthday || '请选择' }}</text>\r\n              <text class=\"picker-arrow\">▼</text>\r\n            </view>\r\n          </picker>\r\n          <picker :range=\"birthTimeOptions\" @change=\"onBirthTimeChange\" :value=\"birthTimeIndex\">\r\n            <view class=\"picker\">\r\n              <text class=\"picker-label\">* 出生时辰：</text>\r\n              <text class=\"picker-value\">{{ editApplicant.birthTime || '请选择' }}</text>\r\n              <text class=\"picker-arrow\">▼</text>\r\n            </view>\r\n          </picker>\r\n          <input v-model=\"editApplicant.address\" placeholder=\"* 常住地址（必填）\" class=\"input\" @input=\"saveDraft\" />\r\n          <view class=\"popup-btns\">\r\n            <button class=\"popup-btn primary\" @click=\"saveApplicant\">保存</button>\r\n            <button class=\"popup-btn\" @click=\"closePopup\">取消</button>\r\n          </view>\r\n        </view>\r\n      </uni-popup>\r\n\r\n      <!-- 法会信息 -->\r\n      <view class=\"section-title\">法会项目信息</view>\r\n      <view class=\"card\">\r\n        <picker :range=\"projectNames\" @change=\"onProjectChange\" :value=\"jointProjectIdx\">\r\n          <view class=\"picker\">\r\n            <text class=\"picker-label\">法会项目：</text>\r\n            <text class=\"picker-value\">{{ currentProject ? currentProject.name : '请选择' }}</text>\r\n            <text class=\"picker-arrow\">▼</text>\r\n          </view>\r\n        </picker>\r\n        <picker v-if=\"hasProjectDates\" :range=\"currentProject.dates\" @change=\"onDateChange\" :value=\"selectedDateIdx\">\r\n          <view class=\"picker\">\r\n            <text class=\"picker-label\">法会日期：</text>\r\n            <text class=\"picker-value\">{{ selectedDate || '请选择' }}</text>\r\n            <text class=\"picker-arrow\">▼</text>\r\n          </view>\r\n        </picker>\r\n        <view v-else class=\"fahui-tip\">法会日期：<text class=\"info-value\">预订成功后道长与您联系确认</text></view>\r\n      </view>\r\n      \r\n      <!-- 配偶信息显示，紧跟法会信息卡片下方 -->\r\n      <view v-if=\"showSpouseInfo\" style=\"margin-top: 10rpx; margin-bottom: 10rpx;\">\r\n        <view class=\"section-title\" style=\"margin-bottom: 8rpx;\">配偶信息</view>\r\n        <view class=\"card\" style=\"margin-bottom: 0;\">\r\n          <view class=\"spouse-info\">\r\n            <view class=\"info-row\">\r\n              <text class=\"info-label\">姓名：</text>\r\n              <text class=\"info-value\">{{ spouse.name }}</text>\r\n            </view>\r\n            <view class=\"info-row\">\r\n              <text class=\"info-label\">性别：</text>\r\n              <text class=\"info-value\">{{ spouse.gender }}</text>\r\n            </view>\r\n            <view class=\"info-row\">\r\n              <text class=\"info-label\">农历生日：</text>\r\n              <text class=\"info-value\">{{ spouse.lunarBirthday || '未填写' }}</text>\r\n            </view>\r\n            <view class=\"info-row\">\r\n              <text class=\"info-label\">出生时辰：</text>\r\n              <text class=\"info-value\">{{ spouse.birthTime || '未填写' }}</text>\r\n            </view>\r\n          </view>\r\n          <button class=\"mini-btn\" size=\"mini\" @click=\"openSpouseDialog\">修改配偶信息</button>\r\n        </view>\r\n      </view>\r\n      \r\n      <!-- 超度特殊输入，紧跟配偶信息下方 -->\r\n      <view v-if=\"isChaoduProject\" style=\"margin-top: 10rpx; margin-bottom: 10rpx;\">\r\n        <view class=\"section-title\" style=\"margin-bottom: 8rpx;\">超度类型 <text class=\"section-tip\">（必选）</text></view>\r\n        <view class=\"card\" style=\"margin-bottom: 0;\">\r\n          <picker :range=\"chaoduTypes\" @change=\"onChaoduTypeChange\" :value=\"chaoduTypeIndex\">\r\n            <view class=\"picker\">\r\n              <text class=\"picker-label\">超度类型：</text>\r\n              <text class=\"picker-value\">{{ chaoduType || '请选择' }}</text>\r\n              <text class=\"picker-arrow\">▼</text>\r\n            </view>\r\n          </picker>\r\n        </view>\r\n        <view class=\"section-title\" style=\"margin-bottom: 8rpx;\">已故亲人信息 <text class=\"section-tip\">（至少1人，最多5人）</text></view>\r\n        <view class=\"section-tip-full\">点击\"编辑\"按钮可修改已故亲人信息</view>\r\n        <view class=\"deceased-list\">\r\n          <view v-for=\"(deceased, idx) in deceasedList\" :key=\"idx\" class=\"deceased-card\">\r\n            <view class=\"deceased-header\">\r\n              <text class=\"deceased-name\">{{ deceased.name || '未填写' }}</text>\r\n              <view class=\"deceased-actions\">\r\n                <button class=\"mini-btn\" size=\"mini\" @click=\"openDeceasedDialog(idx)\">编辑</button>\r\n                <button v-if=\"deceasedList.length>1\" class=\"mini-btn danger\" size=\"mini\" @click=\"removeDeceased(idx)\">删除</button>\r\n              </view>\r\n            </view>\r\n            <view class=\"deceased-info-row\">\r\n              <text>出生农历：</text><text class=\"info-value\">{{ deceased.lunarBirthday || '未选' }}</text>\r\n              <text>去世农历：</text><text class=\"info-value\">{{ deceased.deathDate || '未选' }}</text>\r\n            </view>\r\n            <view class=\"deceased-info-row\">\r\n              <text>关系：</text><text class=\"info-value\">{{ deceased.relation || '未选' }}</text>\r\n            </view>\r\n          </view>\r\n        </view>\r\n        <button v-if=\"deceasedList.length < 5\" class=\"add-btn\" @click=\"addDeceased\">\r\n          <text class=\"add-icon\">+</text>\r\n          <text class=\"add-text\">添加已故亲人</text>\r\n        </button>\r\n      </view>\r\n\r\n      <!-- 配偶信息弹窗 -->\r\n      <uni-popup ref=\"spousePopup\" type=\"center\">\r\n        <view class=\"popup-content\">\r\n          <view class=\"popup-title\">配偶信息</view>\r\n          <view class=\"popup-tip\">以下信息为选填项，可根据需要填写</view>\r\n          <input v-model=\"editSpouse.name\" placeholder=\"姓名（选填）\" class=\"input\" maxlength=\"20\" @input=\"saveDraft\" />\r\n                      <picker :range=\"genderOptions\" @change=\"onSpouseGenderChange\" :value=\"spouseGenderIndex\">\r\n            <view class=\"picker\">\r\n              <text class=\"picker-label\">性别：</text>\r\n              <text class=\"picker-value\">{{ editSpouse.gender || '请选择' }}</text>\r\n              <text class=\"picker-arrow\">▼</text>\r\n            </view>\r\n          </picker>\r\n          <picker mode=\"date\" @change=\"onSpouseLunarBirthdayChange\" :value=\"editSpouse.lunarBirthday\">\r\n            <view class=\"picker\">\r\n              <text class=\"picker-label\">农历生日：</text>\r\n              <text class=\"picker-value\">{{ editSpouse.lunarBirthday || '请选择' }}</text>\r\n              <text class=\"picker-arrow\">▼</text>\r\n            </view>\r\n          </picker>\r\n                      <picker :range=\"birthTimeOptions\" @change=\"onSpouseBirthTimeChange\" :value=\"spouseBirthTimeIndex\">\r\n            <view class=\"picker\">\r\n              <text class=\"picker-label\">出生时辰：</text>\r\n              <text class=\"picker-value\">{{ editSpouse.birthTime || '请选择' }}</text>\r\n              <text class=\"picker-arrow\">▼</text>\r\n            </view>\r\n          </picker>\r\n          <view class=\"popup-btns\">\r\n            <button class=\"popup-btn primary\" @click=\"saveSpouse\">保存</button>\r\n            <button class=\"popup-btn\" @click=\"closeSpousePopup\">取消</button>\r\n          </view>\r\n        </view>\r\n      </uni-popup>\r\n\r\n      <!-- 已故亲人信息弹窗 -->\r\n      <uni-popup ref=\"deceasedPopup\" type=\"center\">\r\n        <view class=\"popup-content\">\r\n          <view class=\"popup-title\">已故亲人信息</view>\r\n          <view class=\"popup-tip\">带 * 的字段为必填项，建议填写出生和去世日期</view>\r\n          <input v-model=\"editDeceased.name\" placeholder=\"* 姓名（必填）\" class=\"input\" maxlength=\"20\" @input=\"saveDraft\" />\r\n          <picker mode=\"date\" @change=\"onDeceasedLunarBirthdayChange\" :value=\"editDeceased.lunarBirthday\">\r\n            <view class=\"picker\">\r\n              <text class=\"picker-label\">出生农历：</text>\r\n              <text class=\"picker-value\">{{ editDeceased.lunarBirthday || '请选择' }}</text>\r\n              <text class=\"picker-arrow\">▼</text>\r\n            </view>\r\n          </picker>\r\n          <picker mode=\"date\" @change=\"onDeceasedDeathDateChange\" :value=\"editDeceased.deathDate\">\r\n            <view class=\"picker\">\r\n              <text class=\"picker-label\">去世农历：</text>\r\n              <text class=\"picker-value\">{{ editDeceased.deathDate || '请选择' }}</text>\r\n              <text class=\"picker-arrow\">▼</text>\r\n            </view>\r\n          </picker>\r\n                      <picker :range=\"deceasedRelationOptions\" @change=\"onDeceasedRelationChange\" :value=\"deceasedRelationIndex\">\r\n            <view class=\"picker\">\r\n              <text class=\"picker-label\">* 关系：</text>\r\n              <text class=\"picker-value\">{{ editDeceased.relation || '请选择' }}</text>\r\n              <text class=\"picker-arrow\">▼</text>\r\n            </view>\r\n          </picker>\r\n          <view class=\"popup-btns\">\r\n            <button class=\"popup-btn primary\" @click=\"saveDeceased\">保存</button>\r\n            <button class=\"popup-btn\" @click=\"closeDeceasedPopup\">取消</button>\r\n          </view>\r\n        </view>\r\n      </uni-popup>\r\n\r\n      <!-- 代办物品（可选） -->\r\n      <view class=\"section-title\" v-if=\"showItems\">代办物品 <text class=\"section-tip\">（可选）</text></view>\r\n      <view v-if=\"showItems\" class=\"card\">\r\n        <view v-for=\"(item, idx) in items\" :key=\"idx\" class=\"item-row\">\r\n          <text>{{ item.name }}（￥{{ item.price }}）</text>\r\n          <input type=\"number\" v-model.number=\"item.count\" min=\"0\" class=\"input item-input\" @input=\"saveDraft\" />\r\n        </view>\r\n      </view>\r\n\r\n      <!-- 收件信息 -->\r\n      <view class=\"section-title\" v-if=\"showReceiver\">\r\n        收件信息 \r\n        <text class=\"section-tip\" v-if=\"!receiverConfig || (!receiverConfig.nameRequired && !receiverConfig.phoneRequired && !receiverConfig.addressRequired)\">（可选）</text>\r\n        <text class=\"section-tip\" v-else>（必填项已标记*）</text>\r\n      </view>\r\n      <view v-if=\"showReceiver\" class=\"card\">\r\n        <view class=\"input-group\">\r\n          <text class=\"input-label\" v-if=\"receiverConfig && receiverConfig.nameRequired\">收件人姓名 *</text>\r\n          <text class=\"input-label\" v-else>收件人姓名</text>\r\n          <input v-model=\"receiver.name\" placeholder=\"请输入收件人姓名\" class=\"input\" @input=\"saveDraft\" />\r\n        </view>\r\n        <view class=\"input-group\">\r\n          <text class=\"input-label\" v-if=\"receiverConfig && receiverConfig.phoneRequired\">联系电话 *</text>\r\n          <text class=\"input-label\" v-else>联系电话</text>\r\n                      <input v-model=\"receiver.phone\" placeholder=\"请输入联系电话\" class=\"input\" type=\"tel\" maxlength=\"11\" @input=\"saveDraft\" />\r\n        </view>\r\n        <view class=\"input-group\">\r\n          <text class=\"input-label\" v-if=\"receiverConfig && receiverConfig.addressRequired\">收件地址 *</text>\r\n          <text class=\"input-label\" v-else>收件地址</text>\r\n          <textarea v-model=\"receiver.address\" placeholder=\"请输入详细收件地址\" class=\"textarea\" @input=\"saveDraft\" />\r\n        </view>\r\n      </view>\r\n\r\n      <button class=\"form-btn\" type=\"primary\" @click=\"nextStep\" :disabled=\"isSubmitting\">\r\n        <view v-if=\"isSubmitting\" class=\"btn-loading\">\r\n          <view class=\"btn-spinner\"></view>\r\n          <text>提交中...</text>\r\n        </view>\r\n        <text v-else>下一步</text>\r\n      </button>\r\n      \r\n      <!-- 调试信息（开发时可显示） -->\r\n      <view v-if=\"true\" class=\"debug-info\">\r\n        <text>报名人数：{{ applicants.length }}</text>\r\n        <text>已故亲人数：{{ deceasedList.length }}</text>\r\n        <text>代办物品数：{{ items.length }}</text>\r\n        <text>收件信息：{{ showReceiver ? '显示' : '隐藏' }}</text>\r\n        <text>代办物品模块：{{ showItems ? '显示' : '隐藏' }}</text>\r\n        <button @click=\"checkModuleConfig\" class=\"debug-btn\">检查代办物品配置</button>\r\n        <button @click=\"checkReceiverConfig\" class=\"debug-btn\">检查收件信息配置</button>\r\n        <button @click=\"debugData\" class=\"debug-btn\" style=\"background: #ff6b6b; color: white;\">生成测试数据</button>\r\n      </view>\r\n    </view>\r\n  </view>\r\n</template>\r\n\r\n<script>\r\nimport uniPopup from '@/components/uni-popup/uni-popup.vue'\r\nimport jointDataManager from '@/utils/jointDataManager.js'\r\n\r\n// 导入云对象\r\nconst jointManagement = uniCloud.importObject('joint-management')\r\n\r\nexport default {\r\n  components: {\r\n    uniPopup\r\n  },\r\n  data() {\r\n    return {\r\n      isLoading: true,\r\n      isSubmitting: false,\r\n      projectId: '',\r\n      \r\n      // 报名人信息\r\n      applicants: [],\r\n      editApplicant: {},\r\n      editIndex: -1,\r\n      \r\n      // 法会项目信息\r\n      jointProjects: [],\r\n      jointProjectIdx: -1,\r\n      currentProject: null,\r\n      selectedDateIdx: -1,\r\n      selectedDate: '',\r\n      \r\n      // 姻缘和合法会特殊信息\r\n      spouse: {\r\n        name: '',\r\n        gender: '',\r\n        lunarBirthday: '',\r\n        birthTime: ''\r\n      },\r\n      editSpouse: {},\r\n      \r\n      // 超度法会特殊信息\r\n      chaoduType: '',\r\n      chaoduTypes: ['超度亡灵', '超度婴灵', '超度冤亲债主', '超度历代宗亲'],\r\n      deceasedList: [],\r\n      editDeceased: {},\r\n      editDeceasedIndex: -1,\r\n      \r\n      // 代办物品\r\n      items: [],\r\n      showItems: false,\r\n      \r\n      // 收件信息\r\n      receiver: {\r\n        name: '',\r\n        phone: '',\r\n        address: ''\r\n      },\r\n      showReceiver: false,\r\n      receiverConfig: null,\r\n      \r\n      // 选项数据\r\n      genderOptions: ['男', '女'],\r\n      birthTimeOptions: ['子时(23:00-01:00)', '丑时(01:00-03:00)', '寅时(03:00-05:00)', '卯时(05:00-07:00)', '辰时(07:00-09:00)', '巳时(09:00-11:00)', '午时(11:00-13:00)', '未时(13:00-15:00)', '申时(15:00-17:00)', '酉时(17:00-19:00)', '戌时(19:00-21:00)', '亥时(21:00-23:00)'],\r\n      deceasedRelationOptions: ['先曾祖父', '先曾祖母', '先祖父', '先祖母', '外祖父', '外祖母', '先父', '先母', '岳父', '岳母', '先夫', '先妻', '故爱子', '故爱女', '好友', '恩师', '其他']\r\n    }\r\n  },\r\n  \r\n  computed: {\r\n    hasSelectedItems() {\r\n      return this.items.some(item => item.count > 0)\r\n    },\r\n    projectNames() {\r\n      return this.jointProjects.map(p => p.name)\r\n    },\r\n    genderIndex() {\r\n      return this.genderOptions.indexOf(this.editApplicant.gender)\r\n    },\r\n    birthTimeIndex() {\r\n      return this.birthTimeOptions.indexOf(this.editApplicant.birthTime)\r\n    },\r\n    chaoduTypeIndex() {\r\n      return this.chaoduTypes.indexOf(this.chaoduType)\r\n    },\r\n    spouseGenderIndex() {\r\n      return this.genderOptions.indexOf(this.editSpouse.gender)\r\n    },\r\n    spouseBirthTimeIndex() {\r\n      return this.birthTimeOptions.indexOf(this.editSpouse.birthTime)\r\n    },\r\n    deceasedRelationIndex() {\r\n      return this.deceasedRelationOptions.indexOf(this.editDeceased.relation)\r\n    },\r\n    hasProjectDates() {\r\n      return this.currentProject && this.currentProject.dates && this.currentProject.dates.length > 0\r\n    },\r\n    showSpouseInfo() {\r\n      return this.currentProject && this.currentProject.category === '姻缘和合' && this.spouse.name\r\n    },\r\n    isYinyuanProject() {\r\n      return this.currentProject && this.currentProject.category === '姻缘和合'\r\n    },\r\n    isChaoduProject() {\r\n      return this.currentProject && this.currentProject.category === '超度法会'\r\n    }\r\n  },\r\n  \r\n  onLoad(options) {\r\n    console.log('🔍 页面加载调试: ========== 页面开始加载 ==========')\r\n    console.log('🔍 页面加载调试: options:', options)\r\n    console.log('🔍 页面加载调试: 初始 showReceiver =', this.showReceiver)\r\n    console.log('🔍 页面加载调试: 初始 applicants =', this.applicants)\r\n    \r\n    if (options.projectId) {\r\n      this.projectId = options.projectId\r\n      console.log('🔍 页面加载调试: 设置 projectId =', this.projectId)\r\n    }\r\n    \r\n    console.log('🔍 页面加载调试: 开始调用 loadData()')\r\n    this.loadData()\r\n    console.log('🔍 页面加载调试: loadData() 调用完成')\r\n  },\r\n  \r\n  onShow() {\r\n    console.log('🔍 页面显示调试: ========== 页面显示 ==========')\r\n    console.log('🔍 页面显示调试: 当前 showReceiver =', this.showReceiver)\r\n    console.log('🔍 页面显示调试: 当前 applicants =', this.applicants)\r\n    \r\n    console.log('🔍 页面显示调试: 开始调用 loadDraft()')\r\n    this.loadDraft()\r\n    console.log('🔍 页面显示调试: loadDraft() 调用完成')\r\n    \r\n    console.log('🔍 页面显示调试: 开始调用 checkAndClearOldData()')\r\n    this.checkAndClearOldData()\r\n    console.log('🔍 页面显示调试: checkAndClearOldData() 调用完成')\r\n    \r\n    console.log('🔍 页面显示调试: 页面显示完成，最终 applicants =', this.applicants)\r\n  },\r\n  \r\n  methods: {\r\n    async loadData() {\r\n      console.log('🔍 loadData调试: ========== 开始加载数据 ==========')\r\n      try {\r\n        this.isLoading = true\r\n        console.log('🔍 loadData调试: 设置 isLoading = true')\r\n        \r\n        // 加载合坛法会项目\r\n        console.log('🔍 loadData调试: 开始加载合坛法会项目')\r\n        await this.loadJointProjects()\r\n        console.log('🔍 loadData调试: 合坛法会项目加载完成，项目数量:', this.jointProjects.length)\r\n        \r\n        // 加载收件信息配置\r\n        console.log('🔍 loadData调试: 开始加载收件信息配置...')\r\n        await this.loadReceiverConfig()\r\n        console.log('🔍 loadData调试: 收件信息配置加载完成，showReceiver =', this.showReceiver)\r\n        \r\n        // 如果有projectId，自动选择对应项目\r\n        if (this.projectId) {\r\n          console.log('🔍 loadData调试: 有projectId，开始自动选择项目:', this.projectId)\r\n          const index = this.jointProjects.findIndex(p => p._id === this.projectId)\r\n          if (index !== -1) {\r\n            this.jointProjectIdx = index\r\n            this.currentProject = this.jointProjects[index]\r\n            console.log('🔍 loadData调试: 自动选择项目成功:', this.currentProject.name, '项目ID:', this.currentProject._id)\r\n            // 加载选中项目的代办物品\r\n            await this.loadItemsConfig(this.currentProject._id)\r\n          } else {\r\n            console.log('🔍 loadData调试: 未找到对应的项目')\r\n          }\r\n        }\r\n        \r\n        // 初始化报名人\r\n        console.log('🔍 loadData调试: 检查报名人初始化，当前applicants长度:', this.applicants.length)\r\n        if (this.applicants.length === 0) {\r\n          console.log('🔍 loadData调试: 没有报名人，添加默认报名人')\r\n          this.addApplicant()\r\n          console.log('🔍 loadData调试: 添加默认报名人完成，当前applicants:', this.applicants)\r\n        } else {\r\n          console.log('🔍 loadData调试: 已有报名人，数量:', this.applicants.length)\r\n          console.log('🔍 loadData调试: 现有报名人详情:', this.applicants)\r\n        }\r\n        \r\n        console.log('🔍 loadData调试: ========== 数据加载完成 ==========')\r\n        console.log('🔍 loadData调试: 当前项目数量:', this.jointProjects.length)\r\n        console.log('🔍 loadData调试: 当前选中项目:', this.currentProject?.name || '无')\r\n        console.log('🔍 loadData调试: 代办物品显示状态:', this.showItems)\r\n        console.log('🔍 loadData调试: 收件信息显示状态:', this.showReceiver)\r\n        console.log('🔍 loadData调试: 收件信息配置对象:', this.receiverConfig)\r\n        console.log('🔍 loadData调试: 收件人信息:', this.receiver)\r\n        console.log('🔍 loadData调试: 最终applicants状态:', this.applicants)\r\n        console.log('🔍 loadData调试: applicants长度:', this.applicants.length)\r\n        \r\n        this.isLoading = false\r\n        console.log('🔍 loadData调试: 设置 isLoading = false')\r\n      } catch (error) {\r\n        console.error('加载数据失败:', error)\r\n        uni.showToast({\r\n          title: '加载数据失败',\r\n          icon: 'none'\r\n        })\r\n        this.isLoading = false\r\n      }\r\n    },\r\n    \r\n    async loadJointProjects() {\r\n      try {\r\n        const result = await jointManagement.getProjects()\r\n        \r\n        if (result.success && result.data && result.data.length > 0) {\r\n          this.jointProjects = result.data\r\n        } else {\r\n          // 使用默认数据\r\n          this.jointProjects = [\r\n            { \r\n              _id: 'joint_pingan', \r\n              name: '平安合坛', \r\n              price: 200, \r\n              description: '祈求平安吉祥，消灾免难',\r\n              category: '平安祈福',\r\n              deadline: '2025-12-31',\r\n              dates: ['2025-08-01', '2025-08-15', '2025-09-01'],\r\n              maxApplicants: 100\r\n            },\r\n            { \r\n              _id: 'joint_yinyuan', \r\n              name: '姻缘合坛', \r\n              price: 300, \r\n              description: '祈求姻缘美满，感情和睦',\r\n              category: '姻缘和合',\r\n              deadline: '2025-12-31',\r\n              dates: ['2025-08-10', '2025-09-10'],\r\n              maxApplicants: 50\r\n            },\r\n            { \r\n              _id: 'joint_chaodu', \r\n              name: '超度合坛', \r\n              price: 400, \r\n              description: '超度亡灵，祈求往生净土',\r\n              category: '超度法会',\r\n              deadline: '2025-12-31',\r\n              dates: ['2025-08-18', '2025-08-30', '2025-09-18'],\r\n              maxApplicants: 80\r\n            }\r\n          ]\r\n        }\r\n      } catch (error) {\r\n        console.error('加载合坛法会项目失败:', error)\r\n        throw error\r\n      }\r\n    },\r\n    \r\n    async loadItemsConfig(projectId) {\r\n      if (!projectId) {\r\n        console.log('🔍 代办物品调试: 项目ID为空，禁用代办物品模块')\r\n        this.showItems = false\r\n        this.items = []\r\n        return\r\n      }\r\n      \r\n      try {\r\n        console.log('🔍 代办物品调试: 开始检查模块启用状态，项目ID:', projectId)\r\n        \r\n        // 首先检查模块是否启用\r\n        const moduleResult = await jointManagement.getGoodsConfig()\r\n        \r\n        console.log('🔍 代办物品调试: 模块配置云函数返回结果:', moduleResult)\r\n        \r\n        let moduleEnabled = false\r\n        if (moduleResult.success && moduleResult.data) {\r\n          moduleEnabled = moduleResult.data.enabled || false\r\n          console.log('🔍 代办物品调试: 从数据库获取的启用状态:', moduleEnabled)\r\n        } else {\r\n          console.log('🔍 代办物品调试: 数据库中没有配置数据，默认禁用')\r\n        }\r\n        \r\n        // 如果模块未启用，直接返回\r\n        if (!moduleEnabled) {\r\n          console.log('🔍 代办物品调试: 模块已禁用，隐藏代办物品区域')\r\n          this.showItems = false\r\n          this.items = []\r\n          return\r\n        }\r\n        \r\n        console.log('🔍 代办物品调试: 模块已启用，开始加载项目物品')\r\n        \r\n        // 模块启用后，检查项目是否有物品\r\n        const result = await jointManagement.getGoods({ projectId: projectId })\r\n        \r\n        console.log('🔍 代办物品调试: 项目物品云函数返回结果:', result)\r\n        \r\n        if (result.data && result.data.length > 0) {\r\n          console.log('🔍 代办物品调试: 项目有物品，显示代办物品区域，物品数量:', result.data.length)\r\n          this.showItems = true\r\n          this.items = result.data.map(item => ({\r\n            ...item,\r\n            count: 0\r\n          }))\r\n        } else {\r\n          console.log('🔍 代办物品调试: 项目没有物品，隐藏代办物品区域')\r\n          this.showItems = false\r\n          this.items = []\r\n        }\r\n      } catch (error) {\r\n        console.error('🔍 代办物品调试: 加载代办物品配置失败:', error)\r\n        this.showItems = false\r\n        this.items = []\r\n      }\r\n    },\r\n    \r\n    async loadReceiverConfig() {\r\n      try {\r\n        console.log('🔍 收件信息调试: 开始加载收件信息配置...')\r\n        console.log('🔍 收件信息调试: 调用前 showReceiver =', this.showReceiver)\r\n        \r\n        const result = await jointManagement.getReceiverConfig()\r\n        \r\n        console.log('🔍 收件信息调试: 云函数返回结果:', result)\r\n        console.log('🔍 收件信息调试: result.data =', result.data)\r\n        \r\n        if (result.success && result.data) {\r\n          this.receiverConfig = result.data\r\n          const oldShowReceiver = this.showReceiver\r\n          this.showReceiver = result.data.enabled || false\r\n          console.log('🔍 收件信息调试: 配置加载成功')\r\n          console.log('🔍 收件信息调试: enabled =', result.data.enabled)\r\n          console.log('🔍 收件信息调试: showReceiver 从', oldShowReceiver, '变为', this.showReceiver)\r\n          console.log('🔍 收件信息调试: 完整配置对象:', this.receiverConfig)\r\n        } else {\r\n          const oldShowReceiver = this.showReceiver\r\n          this.receiverConfig = null\r\n          this.showReceiver = false\r\n          console.log('🔍 收件信息调试: 配置为空或无效')\r\n          console.log('🔍 收件信息调试: showReceiver 从', oldShowReceiver, '变为', this.showReceiver)\r\n          console.log('🔍 收件信息调试: receiverConfig 设置为 null')\r\n        }\r\n        \r\n        console.log('🔍 收件信息调试: 方法执行完成，最终 showReceiver =', this.showReceiver)\r\n      } catch (error) {\r\n        console.error('🔍 收件信息调试: 加载收件信息配置失败:', error)\r\n        console.error('🔍 收件信息调试: 错误详情:', error.message || error)\r\n        const oldShowReceiver = this.showReceiver\r\n        this.receiverConfig = null\r\n        this.showReceiver = false\r\n        console.log('🔍 收件信息调试: 异常处理，showReceiver 从', oldShowReceiver, '变为', this.showReceiver)\r\n      }\r\n    },\r\n    \r\n    async getReceiverConfig() {\r\n      try {\r\n        console.log('🔍 收件信息调试: getReceiverConfig 被调用')\r\n        const result = await jointManagement.getReceiverConfig()\r\n        \r\n        console.log('🔍 收件信息调试: getReceiverConfig 云函数返回:', result)\r\n        \r\n        if (result.success && result.data) {\r\n          console.log('🔍 收件信息调试: getReceiverConfig 返回配置:', result.data)\r\n          return result.data\r\n        }\r\n        console.log('🔍 收件信息调试: getReceiverConfig 返回 null')\r\n        return null\r\n      } catch (error) {\r\n        console.error('🔍 收件信息调试: getReceiverConfig 调用失败:', error)\r\n        return null\r\n      }\r\n    },\r\n    \r\n    async checkModuleConfig() {\r\n      try {\r\n        console.log('=== 检查代办物品模块配置 ===')\r\n        \r\n        // 检查模块配置\r\n        const moduleResult = await jointManagement.getGoodsConfig()\r\n        console.log('模块配置结果:', moduleResult)\r\n        \r\n        // 检查数据库配置\r\n        const checkResult = await jointManagement.getGoodsConfig()\r\n        console.log('数据库检查结果:', checkResult)\r\n        \r\n        // 检查当前项目信息\r\n        let projectInfo = '无'\r\n        if (this.currentProject) {\r\n          projectInfo = `${this.currentProject.name} (${this.currentProject._id})`\r\n        }\r\n        \r\n        // 检查项目物品\r\n        let projectItems = '无'\r\n        if (this.currentProject && this.currentProject._id) {\r\n          try {\r\n            const itemsResult = await jointManagement.getGoods({ projectId: this.currentProject._id })\r\n            if (itemsResult.success && itemsResult.data) {\r\n              projectItems = `${itemsResult.data.length}个物品`\r\n            }\r\n          } catch (error) {\r\n            projectItems = '查询失败'\r\n          }\r\n        }\r\n        \r\n        // 显示结果\r\n        let message = '代办物品模块配置检查结果：\\n\\n'\r\n        message += `当前项目: ${projectInfo}\\n`\r\n        message += `项目分类: ${this.currentProject?.category || '无'}\\n`\r\n        message += `模块启用状态: ${moduleResult.data?.[0]?.enabled ? '启用' : '禁用'}\\n`\r\n        message += `数据库配置存在: ${checkResult.total > 0 ? '是' : '否'}\\n`\r\n        message += `项目物品数量: ${projectItems}\\n`\r\n        message += `当前显示状态: ${this.showItems ? '显示' : '隐藏'}\\n`\r\n        message += `物品列表长度: ${this.items.length}`\r\n        \r\n        uni.showModal({\r\n          title: '代办物品模块配置检查',\r\n          content: message,\r\n          showCancel: false\r\n        })\r\n        \r\n      } catch (error) {\r\n        console.error('检查模块配置失败:', error)\r\n                uni.showToast({\r\n          title: '检查失败',\r\n          icon: 'none'\r\n        })\r\n      }\r\n    },\r\n    \r\n    async checkReceiverConfig() {\r\n      try {\r\n        console.log('=== 检查收件信息模块配置 ===')\r\n        \r\n        // 检查收件信息配置\r\n        const receiverResult = await jointManagement.getReceiverConfig()\r\n        console.log('收件信息配置结果:', receiverResult)\r\n        \r\n        // 检查数据库配置\r\n        const checkResult = await jointManagement.getReceiverConfig()\r\n        console.log('数据库检查结果:', checkResult)\r\n        \r\n        // 检查当前状态\r\n        let message = '收件信息模块配置检查结果：\\n\\n'\r\n        message += `配置启用状态: ${receiverResult.data?.[0]?.enabled ? '启用' : '禁用'}\\n`\r\n        message += `姓名必填: ${receiverResult.data?.[0]?.nameRequired ? '是' : '否'}\\n`\r\n        message += `电话必填: ${receiverResult.data?.[0]?.phoneRequired ? '是' : '否'}\\n`\r\n        message += `地址必填: ${receiverResult.data?.[0]?.addressRequired ? '是' : '否'}\\n`\r\n        message += `数据库配置存在: ${checkResult.total > 0 ? '是' : '否'}\\n`\r\n        message += `配置记录数量: ${checkResult.total || 0}\\n`\r\n        message += `收件信息数量: 0\\n`\r\n        message += `当前显示状态: ${this.showReceiver ? '显示' : '隐藏'}\\n`\r\n        message += `配置对象: ${this.receiverConfig ? '存在' : 'null'}\\n`\r\n        message += `收件人姓名: ${this.receiver.name || '未填写'}\\n`\r\n        message += `联系电话: ${this.receiver.phone || '未填写'}\\n`\r\n        message += `收件地址: ${this.receiver.address || '未填写'}`\r\n        \r\n        uni.showModal({\r\n          title: '收件信息模块配置检查',\r\n          content: message,\r\n          showCancel: false\r\n        })\r\n        \r\n      } catch (error) {\r\n        console.error('检查收件信息配置失败:', error)\r\n        uni.showToast({\r\n          title: '检查失败',\r\n          icon: 'none'\r\n        })\r\n      }\r\n    },\r\n    \r\n    // 报名人管理\r\n    addApplicant() {\r\n      console.log('🔍 addApplicant调试: ========== 添加报名人 ==========')\r\n      console.log('🔍 addApplicant调试: 当前applicants长度:', this.applicants.length)\r\n      \r\n      if (this.applicants.length >= 5) {\r\n        console.log('🔍 addApplicant调试: 已达到最大数量限制')\r\n        uni.showToast({\r\n          title: '最多只能添加5位报名人',\r\n          icon: 'none'\r\n        })\r\n        return\r\n      }\r\n      \r\n      const newApplicant = {\r\n        name: '',\r\n        gender: '',\r\n        phone: '',\r\n        lunarBirthday: '',\r\n        birthTime: '',\r\n        address: ''\r\n      }\r\n      \r\n      console.log('🔍 addApplicant调试: 准备添加新报名人:', newApplicant)\r\n      this.applicants.push(newApplicant)\r\n      console.log('🔍 addApplicant调试: 添加完成，当前applicants:', this.applicants)\r\n      \r\n      this.saveDraft()\r\n      console.log('🔍 addApplicant调试: 保存草稿完成')\r\n    },\r\n    \r\n    removeApplicant(index) {\r\n      this.applicants.splice(index, 1)\r\n      this.saveDraft()\r\n    },\r\n    \r\n    openApplicantDialog(index) {\r\n      console.log('🔍 打开报名人弹窗调试: index =', index)\r\n      console.log('🔍 打开报名人弹窗调试: applicants[', index, '] =', this.applicants[index])\r\n      \r\n      this.editIndex = index\r\n      this.editApplicant = { ...this.applicants[index] }\r\n      \r\n      console.log('🔍 打开报名人弹窗调试: editIndex =', this.editIndex)\r\n      console.log('🔍 打开报名人弹窗调试: editApplicant =', this.editApplicant)\r\n      \r\n      this.$refs.popup.open()\r\n    },\r\n    \r\n    saveApplicant() {\r\n      console.log('🔍 保存报名人调试: 开始保存报名人信息')\r\n      console.log('🔍 保存报名人调试: editIndex =', this.editIndex)\r\n      console.log('🔍 保存报名人调试: editApplicant =', this.editApplicant)\r\n      \r\n      if (!this.editApplicant.name) {\r\n        uni.showToast({\r\n          title: '请输入姓名',\r\n          icon: 'none'\r\n        })\r\n        return\r\n      }\r\n      \r\n      if (!this.editApplicant.gender) {\r\n        uni.showToast({\r\n          title: '请选择性别',\r\n          icon: 'none'\r\n        })\r\n        return\r\n      }\r\n      \r\n      if (!this.editApplicant.phone) {\r\n        uni.showToast({\r\n          title: '请输入联系电话',\r\n          icon: 'none'\r\n        })\r\n        return\r\n      }\r\n      \r\n      if (!this.editApplicant.lunarBirthday) {\r\n        uni.showToast({\r\n          title: '请选择农历生日',\r\n          icon: 'none'\r\n        })\r\n        return\r\n      }\r\n      \r\n      if (!this.editApplicant.birthTime) {\r\n        uni.showToast({\r\n          title: '请选择出生时辰',\r\n          icon: 'none'\r\n        })\r\n        return\r\n      }\r\n      \r\n      if (!this.editApplicant.address) {\r\n        uni.showToast({\r\n          title: '请输入常住地址',\r\n          icon: 'none'\r\n        })\r\n        return\r\n      }\r\n      \r\n      // 保存前检查\r\n      console.log('🔍 保存报名人调试: 保存前的applicants =', this.applicants)\r\n      \r\n      // 确保数据正确保存 - 使用Vue.set确保响应式更新\r\n      const savedApplicant = { ...this.editApplicant }\r\n      \r\n      // 使用Vue.set确保响应式更新\r\n      if (this.$set) {\r\n        this.$set(this.applicants, this.editIndex, savedApplicant)\r\n      } else {\r\n        // 如果$set不可用，使用数组方法\r\n        this.applicants.splice(this.editIndex, 1, savedApplicant)\r\n      }\r\n      \r\n      // 保存后检查\r\n      console.log('🔍 保存报名人调试: 保存后的applicants =', this.applicants)\r\n      console.log('🔍 保存报名人调试: 保存后的applicants[', this.editIndex, '] =', this.applicants[this.editIndex])\r\n      console.log('🔍 保存报名人调试: 保存的数据 =', savedApplicant)\r\n      \r\n      // 强制触发响应式更新\r\n      this.$forceUpdate()\r\n      \r\n      this.closePopup()\r\n      this.saveDraft()\r\n      \r\n      // 再次验证保存结果\r\n      setTimeout(() => {\r\n        console.log('🔍 保存报名人调试: 延迟验证 - applicants =', this.applicants)\r\n        console.log('🔍 保存报名人调试: 延迟验证 - applicants[', this.editIndex, '] =', this.applicants[this.editIndex])\r\n        \r\n        // 显示成功提示\r\n        uni.showToast({\r\n          title: '报名人信息保存成功',\r\n          icon: 'success',\r\n          duration: 2000\r\n        })\r\n      }, 100)\r\n      \r\n      console.log('🔍 保存报名人调试: 保存完成，当前applicants =', this.applicants)\r\n    },\r\n    \r\n    closePopup() {\r\n      this.$refs.popup.close()\r\n      this.editIndex = -1\r\n      this.editApplicant = {}\r\n    },\r\n    \r\n    // 选择器事件\r\n    onGenderChange(e) {\r\n      this.editApplicant.gender = this.genderOptions[e.detail.value]\r\n    },\r\n    \r\n    onLunarBirthdayChange(e) {\r\n      this.editApplicant.lunarBirthday = e.detail.value\r\n    },\r\n    \r\n    onBirthTimeChange(e) {\r\n      this.editApplicant.birthTime = this.birthTimeOptions[e.detail.value]\r\n    },\r\n    \r\n    async onProjectChange(e) {\r\n      this.jointProjectIdx = e.detail.value\r\n      this.currentProject = this.jointProjects[e.detail.value]\r\n      console.log('🔍 代办物品调试: 用户选择项目:', this.currentProject.name, '项目ID:', this.currentProject._id, '项目分类:', this.currentProject.category)\r\n      console.log('🔍 姻缘和合法会调试: 选择项目后，currentProject:', this.currentProject)\r\n      console.log('🔍 姻缘和合法会调试: 项目分类检查:', this.currentProject.category === '姻缘和合')\r\n      \r\n      this.selectedDateIdx = -1\r\n      this.selectedDate = ''\r\n      this.chaoduType = ''\r\n      this.deceasedList = []\r\n      \r\n      // 加载选中项目的代办物品\r\n      if (this.currentProject && this.currentProject._id) {\r\n        console.log('🔍 代办物品调试: 开始加载新项目的代办物品配置')\r\n        await this.loadItemsConfig(this.currentProject._id)\r\n      } else {\r\n        console.log('🔍 代办物品调试: 项目ID无效，禁用代办物品模块')\r\n        this.showItems = false\r\n        this.items = []\r\n      }\r\n      \r\n      this.saveDraft()\r\n    },\r\n    \r\n    onDateChange(e) {\r\n      this.selectedDateIdx = e.detail.value\r\n      this.selectedDate = this.currentProject.dates[e.detail.value]\r\n      this.saveDraft()\r\n    },\r\n    \r\n    onChaoduTypeChange(e) {\r\n      this.chaoduType = this.chaoduTypes[e.detail.value]\r\n      this.saveDraft()\r\n    },\r\n    \r\n    // 超度法会特殊功能\r\n    addDeceased() {\r\n      if (this.deceasedList.length >= 5) {\r\n        uni.showToast({\r\n          title: '最多只能添加5位已故亲人',\r\n          icon: 'none'\r\n        })\r\n        return\r\n      }\r\n      \r\n      this.deceasedList.push({\r\n        name: '',\r\n        lunarBirthday: '',\r\n        deathDate: '',\r\n        relation: ''\r\n      })\r\n      this.saveDraft()\r\n    },\r\n    \r\n    removeDeceased(index) {\r\n      this.deceasedList.splice(index, 1)\r\n      this.saveDraft()\r\n    },\r\n    \r\n    openDeceasedDialog(index) {\r\n      this.editDeceasedIndex = index\r\n      this.editDeceased = { ...this.deceasedList[index] }\r\n      this.$refs.deceasedPopup.open()\r\n    },\r\n    \r\n    saveDeceased() {\r\n      if (!this.editDeceased.name) {\r\n        uni.showToast({\r\n          title: '请输入姓名',\r\n          icon: 'none'\r\n        })\r\n        return\r\n      }\r\n      \r\n      if (!this.editDeceased.relation) {\r\n        uni.showToast({\r\n          title: '请选择关系',\r\n          icon: 'none'\r\n        })\r\n        return\r\n      }\r\n      \r\n      this.deceasedList[this.editDeceasedIndex] = { ...this.editDeceased }\r\n      this.closeDeceasedPopup()\r\n      this.saveDraft()\r\n    },\r\n    \r\n    closeDeceasedPopup() {\r\n      this.$refs.deceasedPopup.close()\r\n      this.editDeceasedIndex = -1\r\n      this.editDeceased = {}\r\n    },\r\n    \r\n    onDeceasedLunarBirthdayChange(e) {\r\n      this.editDeceased.lunarBirthday = e.detail.value\r\n    },\r\n    \r\n    onDeceasedDeathDateChange(e) {\r\n      this.editDeceased.deathDate = e.detail.value\r\n    },\r\n    \r\n    onDeceasedRelationChange(e) {\r\n      this.editDeceased.relation = this.deceasedRelationOptions[e.detail.value]\r\n    },\r\n    \r\n    // 配偶信息相关方法\r\n    openSpouseDialog() {\r\n      this.editSpouse = { ...this.spouse }\r\n      this.$refs.spousePopup.open()\r\n    },\r\n    \r\n    saveSpouse() {\r\n      this.spouse = { ...this.editSpouse }\r\n      this.closeSpousePopup()\r\n      this.saveDraft()\r\n    },\r\n    \r\n    closeSpousePopup() {\r\n      this.$refs.spousePopup.close()\r\n      this.editSpouse = {}\r\n    },\r\n    \r\n    onSpouseGenderChange(e) {\r\n      this.editSpouse.gender = this.genderOptions[e.detail.value]\r\n    },\r\n    \r\n    onSpouseLunarBirthdayChange(e) {\r\n      this.editSpouse.lunarBirthday = e.detail.value\r\n    },\r\n    \r\n    onSpouseBirthTimeChange(e) {\r\n      this.editSpouse.birthTime = this.birthTimeOptions[e.detail.value]\r\n    },\r\n    \r\n    // 验证方法\r\n    validateName() {\r\n      if (this.editApplicant.name && this.editApplicant.name.length < 2) {\r\n        uni.showToast({\r\n          title: '姓名至少2个字符',\r\n          icon: 'none'\r\n        })\r\n      }\r\n    },\r\n    \r\n    validatePhone() {\r\n      if (this.editApplicant.phone && !/^1[3-9]\\d{9}$/.test(this.editApplicant.phone)) {\r\n        uni.showToast({\r\n          title: '请输入正确的手机号',\r\n          icon: 'none'\r\n        })\r\n      }\r\n    },\r\n    \r\n    // 检查并清除旧数据\r\n    checkAndClearOldData() {\r\n      try {\r\n        // 检查是否有旧的订单数据\r\n        const oldOrderData = uni.getStorageSync('joint_fahui_order')\r\n        if (oldOrderData) {\r\n          // 检查数据是否来自当前会话（避免清除刚填写的数据）\r\n          const currentTime = new Date().getTime()\r\n          const dataTime = oldOrderData.createTime || 0\r\n          \r\n          // 如果数据是5分钟内的，不提示清除\r\n          if (currentTime - dataTime < 5 * 60 * 1000) {\r\n            console.log('🔍 检测到最近的订单数据，不提示清除')\r\n            return\r\n          }\r\n          \r\n          console.log('🔍 发现旧的订单数据，询问是否清除')\r\n          uni.showModal({\r\n            title: '提示',\r\n            content: '检测到之前的报名数据，是否清除重新填写？',\r\n            success: (res) => {\r\n              if (res.confirm) {\r\n                // 清除旧数据\r\n                uni.removeStorageSync('joint_fahui_order')\r\n                uni.removeStorageSync('joint_fahui_confirm')\r\n                uni.removeStorageSync('joint_fahui_order_id')\r\n                console.log('✅ 旧数据已清除')\r\n                uni.showToast({\r\n                  title: '数据已清除，请重新填写',\r\n                  icon: 'success'\r\n                })\r\n              }\r\n            }\r\n          })\r\n        }\r\n      } catch (error) {\r\n        console.error('检查旧数据失败:', error)\r\n      }\r\n    },\r\n    \r\n    // 数据持久化\r\n    saveDraft() {\r\n      console.log('🔍 保存草稿调试: 开始保存草稿')\r\n      console.log('🔍 保存草稿调试: applicants =', this.applicants)\r\n      \r\n      const draft = {\r\n        applicants: this.applicants,\r\n        jointProjectIdx: this.jointProjectIdx,\r\n        selectedDateIdx: this.selectedDateIdx,\r\n        selectedDate: this.selectedDate,\r\n        spouse: this.spouse,\r\n        chaoduType: this.chaoduType,\r\n        deceasedList: this.deceasedList,\r\n        items: this.items,\r\n        receiver: this.receiver\r\n      }\r\n      \r\n      console.log('🔍 保存草稿调试: 准备保存的草稿数据 =', draft)\r\n      \r\n      try {\r\n        uni.setStorageSync('joint_fahui_draft', draft)\r\n        console.log('🔍 保存草稿调试: 草稿保存成功')\r\n        \r\n        // 验证保存结果\r\n        const savedDraft = uni.getStorageSync('joint_fahui_draft')\r\n        console.log('🔍 保存草稿调试: 验证保存结果 =', savedDraft)\r\n        console.log('🔍 保存草稿调试: 验证保存的applicants =', savedDraft?.applicants)\r\n      } catch (error) {\r\n        console.error('🔍 保存草稿调试: 保存草稿失败:', error)\r\n      }\r\n    },\r\n    \r\n    loadDraft() {\r\n      try {\r\n        console.log('🔍 加载草稿调试: 开始加载草稿...')\r\n        const oldShowReceiver = this.showReceiver\r\n        \r\n        const draft = uni.getStorageSync('joint_fahui_draft')\r\n        console.log('🔍 加载草稿调试: 从存储中获取的草稿数据 =', draft)\r\n        \r\n        if (draft) {\r\n          console.log('🔍 加载草稿调试: 草稿中的applicants =', draft.applicants)\r\n          \r\n          this.applicants = draft.applicants || []\r\n          this.jointProjectIdx = draft.jointProjectIdx || -1\r\n          this.selectedDateIdx = draft.selectedDateIdx || -1\r\n          this.selectedDate = draft.selectedDate || ''\r\n          this.spouse = draft.spouse || { name: '', gender: '', lunarBirthday: '', birthTime: '' }\r\n          this.chaoduType = draft.chaoduType || ''\r\n          this.deceasedList = draft.deceasedList || []\r\n          this.items = draft.items || []\r\n          this.receiver = draft.receiver || { name: '', phone: '', address: '' }\r\n          \r\n          if (this.jointProjectIdx !== -1 && this.jointProjects.length > 0) {\r\n            this.currentProject = this.jointProjects[this.jointProjectIdx]\r\n          }\r\n          \r\n          console.log('🔍 加载草稿调试: 草稿加载完成')\r\n          console.log('🔍 加载草稿调试: 加载后的applicants =', this.applicants)\r\n          console.log('🔍 加载草稿调试: 草稿中的收件人信息:', this.receiver)\r\n          console.log('🔍 加载草稿调试: showReceiver 在草稿加载前后:', oldShowReceiver, '->', this.showReceiver)\r\n        } else {\r\n          console.log('🔍 加载草稿调试: 没有找到草稿数据')\r\n        }\r\n      } catch (error) {\r\n        console.error('🔍 加载草稿调试: 加载草稿失败:', error)\r\n      }\r\n    },\r\n    \r\n    // 表单验证\r\n    async validateForm() {\r\n      console.log('🔍 表单验证调试: 开始验证表单')\r\n      console.log('🔍 表单验证调试: applicants =', this.applicants)\r\n      console.log('🔍 表单验证调试: applicants.length =', this.applicants.length)\r\n      \r\n      if (this.applicants.length === 0) {\r\n        console.log('🔍 表单验证调试: 没有报名人')\r\n        uni.showToast({\r\n          title: '请至少添加一位报名人',\r\n          icon: 'none'\r\n        })\r\n        return false\r\n      }\r\n      \r\n      for (let i = 0; i < this.applicants.length; i++) {\r\n        const applicant = this.applicants[i]\r\n        console.log(`🔍 表单验证调试: 验证第${i + 1}位报名人:`, applicant)\r\n        console.log(`🔍 表单验证调试: 第${i + 1}位报名人字段检查:`)\r\n        console.log(`  - name: \"${applicant.name}\" (${!!applicant.name})`)\r\n        console.log(`  - gender: \"${applicant.gender}\" (${!!applicant.gender})`)\r\n        console.log(`  - phone: \"${applicant.phone}\" (${!!applicant.phone})`)\r\n        console.log(`  - lunarBirthday: \"${applicant.lunarBirthday}\" (${!!applicant.lunarBirthday})`)\r\n        console.log(`  - birthTime: \"${applicant.birthTime}\" (${!!applicant.birthTime})`)\r\n        console.log(`  - address: \"${applicant.address}\" (${!!applicant.address})`)\r\n        \r\n        if (!applicant.name || !applicant.gender || !applicant.phone || \r\n            !applicant.lunarBirthday || !applicant.birthTime || !applicant.address) {\r\n          console.log(`🔍 表单验证调试: 第${i + 1}位报名人信息不完整`)\r\n          \r\n          // 提供更详细的错误信息\r\n          let missingFields = []\r\n          if (!applicant.name) missingFields.push('姓名')\r\n          if (!applicant.gender) missingFields.push('性别')\r\n          if (!applicant.phone) missingFields.push('电话')\r\n          if (!applicant.lunarBirthday) missingFields.push('农历生日')\r\n          if (!applicant.birthTime) missingFields.push('出生时辰')\r\n          if (!applicant.address) missingFields.push('地址')\r\n          \r\n          uni.showModal({\r\n            title: '信息不完整',\r\n            content: `第${i + 1}位报名人缺少以下信息：\\n${missingFields.join('、')}`,\r\n            showCancel: false,\r\n            confirmText: '知道了'\r\n          })\r\n          return false\r\n        }\r\n      }\r\n      \r\n      if (!this.currentProject) {\r\n        uni.showToast({\r\n          title: '请选择法会项目',\r\n          icon: 'none'\r\n        })\r\n        return false\r\n      }\r\n      \r\n      if (this.currentProject.category === '超度法会') {\r\n        if (!this.chaoduType) {\r\n          uni.showToast({\r\n            title: '请选择超度类型',\r\n            icon: 'none'\r\n          })\r\n          return false\r\n        }\r\n        \r\n        if (this.deceasedList.length === 0) {\r\n          uni.showToast({\r\n            title: '请至少添加一位已故亲人',\r\n            icon: 'none'\r\n          })\r\n          return false\r\n        }\r\n        \r\n        for (let i = 0; i < this.deceasedList.length; i++) {\r\n          const deceased = this.deceasedList[i]\r\n          if (!deceased.name || !deceased.relation) {\r\n            uni.showToast({\r\n              title: `第${i + 1}位已故亲人信息不完整`,\r\n              icon: 'none'\r\n            })\r\n            return false\r\n          }\r\n        }\r\n      }\r\n      \r\n      // 收件信息验证\r\n      console.log('🔍 收件信息调试: 开始验证收件信息，showReceiver =', this.showReceiver)\r\n      if (this.showReceiver) {\r\n        console.log('🔍 收件信息调试: 收件信息模块已启用，开始验证')\r\n        const receiverConfig = await this.getReceiverConfig()\r\n        console.log('🔍 收件信息调试: 获取到的配置:', receiverConfig)\r\n        \r\n        if (receiverConfig) {\r\n          console.log('🔍 收件信息调试: 验证收件人姓名，必填:', receiverConfig.nameRequired, '值:', this.receiver.name)\r\n          if (receiverConfig.nameRequired && !this.receiver.name.trim()) {\r\n            console.log('🔍 收件信息调试: 收件人姓名为空，验证失败')\r\n            uni.showToast({\r\n              title: '请填写收件人姓名',\r\n              icon: 'none'\r\n            })\r\n            return false\r\n          }\r\n          \r\n          console.log('🔍 收件信息调试: 验证收件人电话，必填:', receiverConfig.phoneRequired, '值:', this.receiver.phone)\r\n          if (receiverConfig.phoneRequired && !this.receiver.phone.trim()) {\r\n            console.log('🔍 收件信息调试: 收件人电话为空，验证失败')\r\n            uni.showToast({\r\n              title: '请填写收件人电话',\r\n              icon: 'none'\r\n            })\r\n            return false\r\n          }\r\n          \r\n          console.log('🔍 收件信息调试: 验证收件地址，必填:', receiverConfig.addressRequired, '值:', this.receiver.address)\r\n          if (receiverConfig.addressRequired && !this.receiver.address.trim()) {\r\n            console.log('🔍 收件信息调试: 收件地址为空，验证失败')\r\n            uni.showToast({\r\n              title: '请填写收件地址',\r\n              icon: 'none'\r\n            })\r\n            return false\r\n          }\r\n          \r\n          console.log('🔍 收件信息调试: 收件信息验证通过')\r\n        } else {\r\n          console.log('🔍 收件信息调试: 未获取到收件信息配置，跳过验证')\r\n        }\r\n      } else {\r\n        console.log('🔍 收件信息调试: 收件信息模块未启用，跳过验证')\r\n      }\r\n      \r\n      return true\r\n    },\r\n    \r\n    // 下一步\r\n    async nextStep() {\r\n      console.log('🔍 nextStep调试: ========== 开始提交表单 ==========')\r\n      console.log('🔍 nextStep调试: 当前项目:', this.currentProject)\r\n      console.log('🔍 nextStep调试: 报名人信息:', this.applicants)\r\n      console.log('🔍 nextStep调试: 报名人数量:', this.applicants.length)\r\n      console.log('🔍 nextStep调试: 页面路径:', '/pages/fahui/joint/form')\r\n      \r\n      if (!(await this.validateForm())) {\r\n        return\r\n      }\r\n      \r\n      this.isSubmitting = true\r\n      \r\n      try {\r\n        // 计算费用\r\n        let activityFee = 0\r\n        let goodsFee = 0\r\n        const selectedItems = []\r\n        \r\n        // 根据项目分类计算费用\r\n        if (this.currentProject.category === '超度法会') {\r\n          // 超度法会按已故亲人人数收费\r\n          activityFee = this.currentProject.price * this.deceasedList.length\r\n        } else {\r\n          // 其他法会按报名人人数收费\r\n          activityFee = this.currentProject.price * this.applicants.length\r\n        }\r\n        \r\n        if (this.showItems) {\r\n          this.items.forEach(item => {\r\n            if (item.count > 0) {\r\n              goodsFee += item.price * item.count\r\n              selectedItems.push({\r\n                name: item.name,\r\n                price: item.price,\r\n                count: item.count\r\n              })\r\n            }\r\n          })\r\n        }\r\n        \r\n        // 准备订单数据\r\n        const orderData = {\r\n          type: 'joint_fahui',\r\n          projectId: this.currentProject._id,\r\n          projectName: this.currentProject.name,\r\n          projectPrice: this.currentProject.price,\r\n          selectedDate: this.selectedDate,\r\n          chaoduType: this.chaoduType,\r\n          applicants: this.applicants,\r\n          spouse: this.currentProject.category === '姻缘和合' ? this.spouse : null,\r\n          deceasedList: this.deceasedList,\r\n          selectedItems: selectedItems,\r\n          receiver: this.showReceiver ? this.receiver : null,\r\n          activityFee: activityFee,\r\n          goodsFee: goodsFee,\r\n          totalFee: activityFee + goodsFee,\r\n          applicantCount: this.currentProject.category === '超度法会' ? this.deceasedList.length : this.applicants.length,\r\n          createTime: new Date().getTime() // 添加创建时间戳\r\n        }\r\n        \r\n        console.log('🔍 调试信息 - 表单页面构建的订单数据:', orderData)\r\n        \r\n        // 跳转到确认页面，并传递数据\r\n        console.log('📋 准备传递的订单数据:', orderData)\r\n        \r\n        // 保存订单数据到本地存储\r\n        jointDataManager.saveOrderData(orderData)\r\n        \r\n        // 清除草稿\r\n        jointDataManager.clearDraftData()\r\n        \r\n        // 跳转到确认页面\r\n        uni.navigateTo({\r\n          url: '/pages/fahui/joint/confirm',\r\n          success: () => {\r\n            console.log('✅ 跳转到确认页面成功，数据已保存到本地存储')\r\n          },\r\n          fail: (err) => {\r\n            console.error('❌ 跳转到确认页面失败:', err)\r\n            uni.showToast({\r\n              title: '页面跳转失败',\r\n              icon: 'none'\r\n            })\r\n          }\r\n        })\r\n        \r\n      } catch (error) {\r\n        console.error('提交失败:', error)\r\n        uni.showToast({\r\n          title: '提交失败，请重试',\r\n          icon: 'none'\r\n        })\r\n      } finally {\r\n        this.isSubmitting = false\r\n      }\r\n    },\r\n    \r\n    // 调试数据方法\r\n    debugData() {\r\n      console.log('🔍 调试 - 当前表单数据:')\r\n      console.log('  - 报名人:', this.applicants)\r\n      console.log('  - 当前项目:', this.currentProject)\r\n      console.log('  - 代办物品:', this.items)\r\n      console.log('  - 收件信息:', this.receiver)\r\n      \r\n      const debugInfo = jointDataManager.getDebugInfo()\r\n      console.log('  - 数据管理器调试信息:', debugInfo)\r\n      \r\n      // 生成测试数据并保存\r\n      const testData = jointDataManager.generateTestData()\r\n      console.log('✅ 测试数据已生成:', testData)\r\n    },\r\n    \r\n    // 调试报名人数据\r\n    debugApplicants() {\r\n      console.log('🔍 调试报名人数据:')\r\n      console.log('  - applicants数组:', this.applicants)\r\n      console.log('  - applicants长度:', this.applicants.length)\r\n      \r\n      this.applicants.forEach((applicant, index) => {\r\n        console.log(`  - 报名人${index + 1}:`, applicant)\r\n        console.log(`    - name: \"${applicant.name}\" (${!!applicant.name})`)\r\n        console.log(`    - gender: \"${applicant.gender}\" (${!!applicant.gender})`)\r\n        console.log(`    - phone: \"${applicant.phone}\" (${!!applicant.phone})`)\r\n        console.log(`    - lunarBirthday: \"${applicant.lunarBirthday}\" (${!!applicant.lunarBirthday})`)\r\n        console.log(`    - birthTime: \"${applicant.birthTime}\" (${!!applicant.birthTime})`)\r\n        console.log(`    - address: \"${applicant.address}\" (${!!applicant.address})`)\r\n      })\r\n      \r\n      // 检查本地存储\r\n      try {\r\n        const draft = uni.getStorageSync('joint_fahui_draft')\r\n        console.log('  - 本地存储的草稿数据:', draft)\r\n        console.log('  - 本地存储的applicants:', draft?.applicants)\r\n      } catch (error) {\r\n        console.error('  - 读取本地存储失败:', error)\r\n      }\r\n      \r\n      // 显示调试信息给用户\r\n      let message = `报名人数据调试信息：\\n\\n`\r\n      message += `当前报名人数量: ${this.applicants.length}\\n\\n`\r\n      \r\n      this.applicants.forEach((applicant, index) => {\r\n        message += `报名人${index + 1}:\\n`\r\n        message += `  姓名: ${applicant.name || '未填写'}\\n`\r\n        message += `  性别: ${applicant.gender || '未选择'}\\n`\r\n        message += `  电话: ${applicant.phone || '未填写'}\\n`\r\n        message += `  农历生日: ${applicant.lunarBirthday || '未选择'}\\n`\r\n        message += `  出生时辰: ${applicant.birthTime || '未选择'}\\n`\r\n        message += `  地址: ${applicant.address || '未填写'}\\n\\n`\r\n      })\r\n      \r\n      uni.showModal({\r\n        title: '报名人数据调试',\r\n        content: message,\r\n        showCancel: true,\r\n        cancelText: '知道了',\r\n        confirmText: '强制刷新数据',\r\n        success: (res) => {\r\n          if (res.confirm) {\r\n            this.forceRefreshData()\r\n          }\r\n        }\r\n      })\r\n    },\r\n    \r\n    // 强制刷新数据\r\n    forceRefreshData() {\r\n      console.log('🔍 强制刷新数据: 开始刷新')\r\n      \r\n      // 重新加载草稿数据\r\n      this.loadDraft()\r\n      \r\n      // 强制更新视图\r\n      this.$forceUpdate()\r\n      \r\n      // 显示刷新结果\r\n      setTimeout(() => {\r\n        console.log('🔍 强制刷新数据: 刷新后的applicants =', this.applicants)\r\n        \r\n        uni.showToast({\r\n          title: '数据已刷新',\r\n          icon: 'success',\r\n          duration: 2000\r\n        })\r\n      }, 500)\r\n    },\r\n    \r\n    // 快速修复数据\r\n    quickFix() {\r\n      console.log('🔍 快速修复: 开始修复数据')\r\n      \r\n      // 检查并修复applicants数组\r\n      if (!this.applicants || this.applicants.length === 0) {\r\n        console.log('🔍 快速修复: applicants为空，重新初始化')\r\n        this.applicants = [{\r\n          name: '',\r\n          gender: '',\r\n          phone: '',\r\n          lunarBirthday: '',\r\n          birthTime: '',\r\n          address: ''\r\n        }]\r\n      } else {\r\n        console.log('🔍 快速修复: 检查现有报名人数据')\r\n        // 确保每个报名人都有完整的字段\r\n        this.applicants = this.applicants.map(applicant => ({\r\n          name: applicant.name || '',\r\n          gender: applicant.gender || '',\r\n          phone: applicant.phone || '',\r\n          lunarBirthday: applicant.lunarBirthday || '',\r\n          birthTime: applicant.birthTime || '',\r\n          address: applicant.address || ''\r\n        }))\r\n      }\r\n      \r\n      // 强制更新\r\n      this.$forceUpdate()\r\n      \r\n      // 保存到本地存储\r\n      this.saveDraft()\r\n      \r\n      console.log('🔍 快速修复: 修复完成，当前applicants =', this.applicants)\r\n      \r\n      uni.showModal({\r\n        title: '快速修复完成',\r\n        content: '数据已修复，请重新填写报名人信息并保存。',\r\n        showCancel: false,\r\n        confirmText: '知道了'\r\n      })\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.form-bg {\r\n  min-height: 100vh;\r\n  background: linear-gradient(180deg, #e0eaff 0%, #f8f8f8 100%);\r\n  padding-bottom: 120rpx;\r\n}\r\n\r\n.loading-container {\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  justify-content: center;\r\n  height: 100vh;\r\n}\r\n\r\n.loading-spinner {\r\n  width: 60rpx;\r\n  height: 60rpx;\r\n  border: 6rpx solid #f3f3f3;\r\n  border-top: 6rpx solid #667eea;\r\n  border-radius: 50%;\r\n  animation: spin 1s linear infinite;\r\n  margin-bottom: 20rpx;\r\n}\r\n\r\n@keyframes spin {\r\n  0% { transform: rotate(0deg); }\r\n  100% { transform: rotate(360deg); }\r\n}\r\n\r\n.loading-text {\r\n  font-size: 28rpx;\r\n  color: #666;\r\n}\r\n\r\n.form-container {\r\n  padding: 24rpx;\r\n}\r\n\r\n.form-title {\r\n  font-size: 36rpx;\r\n  font-weight: bold;\r\n  color: #333;\r\n  text-align: center;\r\n  margin-bottom: 24rpx;\r\n}\r\n\r\n.form-help {\r\n  background: #fff;\r\n  border-radius: 16rpx;\r\n  padding: 24rpx;\r\n  margin-bottom: 24rpx;\r\n  box-shadow: 0 4rpx 16rpx rgba(0,0,0,0.08);\r\n}\r\n\r\n.form-help text {\r\n  display: block;\r\n  font-size: 24rpx;\r\n  color: #666;\r\n  line-height: 1.6;\r\n  margin-bottom: 8rpx;\r\n}\r\n\r\n.section-title {\r\n  font-size: 32rpx;\r\n  font-weight: bold;\r\n  color: #333;\r\n  margin: 32rpx 0 16rpx 0;\r\n}\r\n\r\n.section-tip {\r\n  font-size: 24rpx;\r\n  color: #999;\r\n  font-weight: normal;\r\n}\r\n\r\n.section-tip-full {\r\n  font-size: 24rpx;\r\n  color: #999;\r\n  margin-bottom: 16rpx;\r\n}\r\n\r\n.debug-info {\r\n  background: #fff3cd;\r\n  border: 1rpx solid #ffeaa7;\r\n  border-radius: 8rpx;\r\n  padding: 16rpx;\r\n  margin-bottom: 16rpx;\r\n}\r\n\r\n.debug-text {\r\n  display: block;\r\n  font-size: 24rpx;\r\n  color: #856404;\r\n  margin-bottom: 8rpx;\r\n}\r\n\r\n.applicant-list {\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 16rpx;\r\n  margin-bottom: 16rpx;\r\n}\r\n\r\n.applicant-card {\r\n  background: #fff;\r\n  border-radius: 16rpx;\r\n  padding: 24rpx;\r\n  box-shadow: 0 4rpx 16rpx rgba(0,0,0,0.08);\r\n}\r\n\r\n.debug-applicant {\r\n  background: #e3f2fd;\r\n  border: 1rpx solid #bbdefb;\r\n  border-radius: 4rpx;\r\n  padding: 8rpx;\r\n  margin-bottom: 12rpx;\r\n}\r\n\r\n.debug-applicant-text {\r\n  font-size: 20rpx;\r\n  color: #1976d2;\r\n  word-break: break-all;\r\n}\r\n\r\n.applicant-header {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  margin-bottom: 16rpx;\r\n}\r\n\r\n.applicant-name {\r\n  font-size: 28rpx;\r\n  font-weight: bold;\r\n  color: #333;\r\n}\r\n\r\n.applicant-actions {\r\n  display: flex;\r\n  gap: 12rpx;\r\n}\r\n\r\n.mini-btn {\r\n  font-size: 20rpx;\r\n  padding: 8rpx 16rpx;\r\n  border-radius: 20rpx;\r\n  background: #667eea;\r\n  color: #fff;\r\n  border: none;\r\n}\r\n\r\n.mini-btn.danger {\r\n  background: #ff6b35;\r\n}\r\n\r\n.applicant-info-row {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  font-size: 24rpx;\r\n  color: #666;\r\n  margin-bottom: 8rpx;\r\n}\r\n\r\n.info-value {\r\n  color: #333;\r\n  font-weight: bold;\r\n}\r\n\r\n.add-btn {\r\n  background: #667eea;\r\n  color: #fff;\r\n  border: none;\r\n  border-radius: 50rpx;\r\n  padding: 16rpx 32rpx;\r\n  font-size: 24rpx;\r\n  margin: 0 auto;\r\n  display: block;\r\n}\r\n\r\n.debug-btn {\r\n  background: #ff6b6b;\r\n  color: #fff;\r\n  border: none;\r\n  border-radius: 50rpx;\r\n  padding: 16rpx 32rpx;\r\n  font-size: 24rpx;\r\n  margin: 10rpx auto 0;\r\n  display: block;\r\n}\r\n\r\n.fix-btn {\r\n  background: #28a745;\r\n  color: #fff;\r\n  border: none;\r\n  border-radius: 50rpx;\r\n  padding: 16rpx 32rpx;\r\n  font-size: 24rpx;\r\n  margin: 10rpx auto 0;\r\n  display: block;\r\n}\r\n\r\n.card {\r\n  background: #fff;\r\n  border-radius: 16rpx;\r\n  padding: 24rpx;\r\n  box-shadow: 0 4rpx 16rpx rgba(0,0,0,0.08);\r\n  margin-bottom: 16rpx;\r\n}\r\n\r\n.picker {\r\n  display: flex;\r\n  align-items: center;\r\n  padding: 20rpx 0;\r\n  border-bottom: 1rpx solid #f0f0f0;\r\n}\r\n\r\n.picker-label {\r\n  font-size: 28rpx;\r\n  color: #333;\r\n  margin-right: 16rpx;\r\n  min-width: 160rpx;\r\n}\r\n\r\n.picker-value {\r\n  flex: 1;\r\n  font-size: 28rpx;\r\n  color: #666;\r\n}\r\n\r\n.picker-arrow {\r\n  font-size: 24rpx;\r\n  color: #999;\r\n  margin-left: 16rpx;\r\n}\r\n\r\n.fahui-tip {\r\n  font-size: 26rpx;\r\n  color: #666;\r\n  margin-top: 16rpx;\r\n}\r\n\r\n.special-tip {\r\n  background: #fff3cd;\r\n  border: 1rpx solid #ffeaa7;\r\n  border-radius: 12rpx;\r\n  padding: 16rpx;\r\n  margin-bottom: 16rpx;\r\n  text-align: center;\r\n}\r\n\r\n.special-tip text {\r\n  font-size: 24rpx;\r\n  color: #856404;\r\n  margin-right: 16rpx;\r\n}\r\n\r\n.deceased-list {\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 16rpx;\r\n  margin-bottom: 16rpx;\r\n}\r\n\r\n.deceased-card {\r\n  background: #fff;\r\n  border-radius: 16rpx;\r\n  padding: 24rpx;\r\n  box-shadow: 0 4rpx 16rpx rgba(0,0,0,0.08);\r\n}\r\n\r\n.deceased-header {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  margin-bottom: 16rpx;\r\n}\r\n\r\n.deceased-name {\r\n  font-size: 28rpx;\r\n  font-weight: bold;\r\n  color: #333;\r\n}\r\n\r\n.deceased-actions {\r\n  display: flex;\r\n  gap: 12rpx;\r\n}\r\n\r\n.deceased-info-row {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  font-size: 24rpx;\r\n  color: #666;\r\n  margin-bottom: 8rpx;\r\n}\r\n\r\n.add-icon {\r\n  font-size: 28rpx;\r\n  margin-right: 8rpx;\r\n}\r\n\r\n.add-text {\r\n  font-size: 24rpx;\r\n}\r\n\r\n.item-row {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  padding: 16rpx 0;\r\n  border-bottom: 1rpx solid #f0f0f0;\r\n}\r\n\r\n.item-row:last-child {\r\n  border-bottom: none;\r\n}\r\n\r\n.item-row text {\r\n  font-size: 26rpx;\r\n  color: #333;\r\n}\r\n\r\n.item-input {\r\n  width: 120rpx;\r\n  text-align: center;\r\n  border: 1rpx solid #ddd;\r\n  border-radius: 8rpx;\r\n  padding: 8rpx;\r\n}\r\n\r\n.input {\r\n  width: 100%;\r\n  padding: 20rpx;\r\n  border: 1rpx solid #ddd;\r\n  border-radius: 12rpx;\r\n  font-size: 28rpx;\r\n  margin-bottom: 16rpx;\r\n  box-sizing: border-box;\r\n}\r\n\r\n.form-btn {\r\n  position: fixed;\r\n  bottom: 40rpx;\r\n  left: 24rpx;\r\n  right: 24rpx;\r\n  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\r\n  color: #fff;\r\n  border: none;\r\n  border-radius: 50rpx;\r\n  padding: 24rpx;\r\n  font-size: 32rpx;\r\n  font-weight: bold;\r\n  box-shadow: 0 8rpx 32rpx rgba(102, 126, 234, 0.3);\r\n}\r\n\r\n.btn-loading {\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n}\r\n\r\n.btn-spinner {\r\n  width: 32rpx;\r\n  height: 32rpx;\r\n  border: 4rpx solid rgba(255,255,255,0.3);\r\n  border-top: 4rpx solid #fff;\r\n  border-radius: 50%;\r\n  animation: spin 1s linear infinite;\r\n  margin-right: 12rpx;\r\n}\r\n\r\n.popup-content {\r\n  background: #fff;\r\n  border-radius: 16rpx;\r\n  padding: 32rpx;\r\n  width: 600rpx;\r\n  max-height: 80vh;\r\n  overflow-y: auto;\r\n}\r\n\r\n.popup-title {\r\n  font-size: 32rpx;\r\n  font-weight: bold;\r\n  color: #333;\r\n  text-align: center;\r\n  margin-bottom: 16rpx;\r\n}\r\n\r\n.popup-tip {\r\n  font-size: 24rpx;\r\n  color: #999;\r\n  text-align: center;\r\n  margin-bottom: 24rpx;\r\n}\r\n\r\n.popup-btns {\r\n  display: flex;\r\n  gap: 16rpx;\r\n  margin-top: 24rpx;\r\n}\r\n\r\n.popup-btn {\r\n  flex: 1;\r\n  padding: 20rpx;\r\n  border-radius: 12rpx;\r\n  font-size: 28rpx;\r\n  border: 1rpx solid #ddd;\r\n  background: #fff;\r\n  color: #666;\r\n}\r\n\r\n.popup-btn.primary {\r\n  background: #667eea;\r\n  color: #fff;\r\n  border-color: #667eea;\r\n}\r\n\r\n.debug-info {\r\n  background: #f8f9fa;\r\n  border-radius: 12rpx;\r\n  padding: 16rpx;\r\n  margin-top: 24rpx;\r\n}\r\n\r\n.debug-info text {\r\n  display: block;\r\n  font-size: 24rpx;\r\n  color: #666;\r\n  margin-bottom: 8rpx;\r\n}\r\n\r\n.debug-btn {\r\n  margin-top: 10rpx;\r\n  background: #667eea;\r\n  color: #fff;\r\n  border: none;\r\n  padding: 10rpx 20rpx;\r\n  border-radius: 6rpx;\r\n  font-size: 24rpx;\r\n}\r\n\r\n.spouse-info {\r\n  margin-bottom: 16rpx;\r\n}\r\n\r\n.info-row {\r\n  display: flex;\r\n  align-items: center;\r\n  margin-bottom: 12rpx;\r\n}\r\n\r\n.info-label {\r\n  font-size: 28rpx;\r\n  color: #666;\r\n  width: 160rpx;\r\n}\r\n\r\n.info-value {\r\n  font-size: 28rpx;\r\n  color: #333;\r\n  flex: 1;\r\n}\r\n\r\n.input-group {\r\n  margin-bottom: 20rpx;\r\n}\r\n\r\n.input-label {\r\n  font-size: 28rpx;\r\n  color: #333;\r\n  font-weight: bold;\r\n  display: block;\r\n  margin-bottom: 8rpx;\r\n}\r\n\r\n.textarea {\r\n  width: 100%;\r\n  min-height: 120rpx;\r\n  padding: 20rpx;\r\n  border: 1rpx solid #ddd;\r\n  border-radius: 12rpx;\r\n  font-size: 28rpx;\r\n  background: #fff;\r\n  box-sizing: border-box;\r\n  resize: none;\r\n}\r\n</style> ","import mod from \"-!../../../../../../../Desktop/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../../../../Desktop/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../../../../Desktop/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../Desktop/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-2!../../../../../../../Desktop/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../../../../Desktop/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../Desktop/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./form.vue?vue&type=style&index=0&id=4bb6e490&scoped=true&lang=css&\"; export default mod; export * from \"-!../../../../../../../Desktop/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../../../../Desktop/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../../../../Desktop/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../Desktop/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-2!../../../../../../../Desktop/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../../../../Desktop/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../Desktop/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./form.vue?vue&type=style&index=0&id=4bb6e490&scoped=true&lang=css&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1754022380791\n      var cssReload = require(\"C:/Users/qub/Desktop/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"/\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}