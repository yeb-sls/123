# 活动报名功能完善说明

## 📋 功能概述

活动报名功能是景区小程序的核心功能之一，为用户提供便捷的活动报名服务。用户可以选择不同类型的活动，填写个人信息，完成报名流程。

## 🎯 主要功能

### 1. 活动报名主页面 (`pages/order/index.vue`)

#### 功能特点：
- **丰富的介绍内容**：包含活动类型介绍、特色说明、报名须知
- **现代化UI设计**：使用卡片布局、渐变背景、图标装饰
- **清晰的信息架构**：分类展示不同类型的活动
- **用户友好的操作**：一键报名、查看记录

#### 活动类型：
- 🕉️ **法会活动**：祈福法会、超度法会、开光法会、放生法会
- 🤝 **慈善活动**：扶贫助学、敬老助残、环保公益、医疗救助
- 🎨 **文化活动**：佛学讲座、禅修体验、文化展览、音乐会
- 🌟 **其他活动**：特色活动、定制活动、特别活动

#### 活动特色：
- ✨ 专业指导，安全可靠
- 🎯 内容丰富，形式多样
- 🤝 结交善友，共同成长
- 🌺 净化心灵，提升境界

### 2. 活动报名表单页面 (`pages/order/form.vue`)

#### 功能特点：
- **步骤指示器**：清晰显示当前步骤
- **活动选择**：支持活动类型和具体活动的二级选择
- **信息填写**：完整的个人信息和紧急联系人信息
- **实时验证**：表单字段实时验证
- **费用预览**：选择活动后显示费用信息
- **协议确认**：必须同意活动报名协议

#### 表单字段：
- **活动信息**：活动类型、具体活动、费用、时间、地点
- **报名人信息**：姓名、电话、身份证、地址、邮箱
- **紧急联系人**：姓名、电话、关系
- **特殊需求**：可选的特殊需求说明
- **协议确认**：活动报名协议

#### 验证规则：
- 姓名：2-10字
- 手机号：11位数字，1开头
- 身份证：18位，最后一位可以是X
- 地址：必填
- 紧急联系人：姓名2-10字，手机号格式正确
- 关系：必选

### 3. 活动报名测试页面 (`pages/order/test.vue`)

#### 测试功能：
- **导航测试**：测试各页面跳转
- **数据存储测试**：测试数据存储和读取
- **表单验证测试**：测试表单验证逻辑
- **完整流程测试**：模拟完整报名流程
- **测试报告**：实时显示测试结果

## 📊 数据结构

### 活动报名表单数据：
```javascript
{
  activityType: '法会活动',           // 活动类型
  activity: '祈福法会',              // 具体活动
  fee: 100,                         // 活动费用
  activityInfo: {                   // 活动详细信息
    fee: 100,
    time: '2024年3月15日 09:00-17:00',
    location: '大雄宝殿'
  },
  name: '张三',                     // 报名人姓名
  phone: '13800138000',            // 联系电话
  idCard: '110101199001011234',    // 身份证号
  address: '北京市朝阳区',          // 联系地址
  email: 'zhangsan@example.com',   // 邮箱（可选）
  emergencyName: '李四',           // 紧急联系人姓名
  emergencyPhone: '13900139000',   // 紧急联系人电话
  emergencyRelation: '朋友',       // 与紧急联系人关系
  specialNeeds: '无特殊需求',      // 特殊需求（可选）
  agreed: true,                    // 是否同意协议
  timestamp: 1647123456789         // 时间戳
}
```

### 活动信息映射：
```javascript
{
  '祈福法会': { fee: 100, time: '2024年3月15日 09:00-17:00', location: '大雄宝殿' },
  '超度法会': { fee: 150, time: '2024年3月20日 08:00-18:00', location: '观音殿' },
  '开光法会': { fee: 200, time: '2024年3月25日 07:00-19:00', location: '天王殿' },
  '放生法会': { fee: 80, time: '2024年3月30日 06:00-12:00', location: '放生池' },
  // ... 更多活动
}
```

## 🎨 UI设计特点

### 1. 色彩方案
- **主色调**：#2d8cf0（蓝色）
- **辅助色**：#ff4d4f（红色，用于错误提示）
- **背景色**：渐变背景 #e0eaff 到 #f8f8f8
- **卡片背景**：#fff（白色）

### 2. 布局设计
- **卡片式布局**：每个功能模块使用独立卡片
- **圆角设计**：18rpx圆角，现代化外观
- **阴影效果**：轻微阴影增加层次感
- **间距统一**：24rpx标准间距

### 3. 交互设计
- **按钮状态**：加载状态、禁用状态
- **表单验证**：实时验证，错误提示
- **价格预览**：选择活动后实时显示费用
- **协议确认**：必须勾选才能提交

## 🔧 技术实现

### 1. 表单验证
```javascript
validate() {
  const errors = {}
  
  // 活动选择验证
  if (this.activityTypeIdx === null) errors.activityTypeIdx = '请选择活动类型'
  if (this.activityIdx === null) errors.activityIdx = '请选择具体活动'
  
  // 个人信息验证
  if (!this.name) errors.name = '请输入姓名'
  else if (this.name.length < 2) errors.name = '姓名需2-10字'
  
  if (!this.phone) errors.phone = '请输入联系电话'
  else if (!/^1[3-9]\d{9}$/.test(this.phone)) errors.phone = '手机号格式不正确'
  
  // 身份证验证
  if (!this.idCard) errors.idCard = '请输入身份证号'
  else if (!/^\d{17}[\dXx]$/.test(this.idCard)) errors.idCard = '身份证号格式不正确'
  
  // 紧急联系人验证
  if (!this.emergencyName) errors.emergencyName = '请输入紧急联系人姓名'
  if (!this.emergencyPhone) errors.emergencyPhone = '请输入紧急联系人电话'
  if (this.relationIdx === null) errors.emergencyRelation = '请选择与紧急联系人关系'
  
  // 协议验证
  if (!this.agreed) errors.agreed = '请阅读并同意活动报名协议'
  
  this.errors = errors
  return Object.keys(errors).length === 0
}
```

### 2. 数据持久化
```javascript
// 保存表单数据
uni.setStorageSync('orderForm', data)

// 读取表单数据
const last = uni.getStorageSync('orderForm')
if (last) {
  // 自动填充上次填写的数据
  this.name = last.name || ''
  this.phone = last.phone || ''
  // ... 其他字段
}
```

### 3. 页面导航
```javascript
// 跳转到确认页
uni.navigateTo({ 
  url: '/pages/order/confirm',
  success: () => {
    console.log('跳转到活动报名确认页成功')
  },
  fail: (err) => {
    console.error('跳转失败:', err)
    uni.showToast({ title: '页面跳转失败', icon: 'none' })
  }
})
```

## 🧪 测试功能

### 1. 测试页面功能
- **导航测试**：测试各页面跳转是否正常
- **数据存储测试**：测试数据存储和读取功能
- **表单验证测试**：测试表单验证逻辑
- **完整流程测试**：模拟完整报名流程
- **测试报告**：实时显示测试结果

### 2. 测试数据
```javascript
const testData = {
  activityType: '法会活动',
  activity: '祈福法会',
  fee: 100,
  activityInfo: { fee: 100, time: '2024年3月15日 09:00-17:00', location: '大雄宝殿' },
  name: '测试用户',
  phone: '13800138000',
  idCard: '110101199001011234',
  address: '北京市朝阳区测试地址',
  email: 'test@example.com',
  emergencyName: '紧急联系人',
  emergencyPhone: '13900139000',
  emergencyRelation: '朋友',
  specialNeeds: '无特殊需求',
  agreed: true,
  timestamp: new Date().getTime()
}
```

## 📱 用户体验

### 1. 操作流程
1. **进入主页面**：查看活动介绍和类型
2. **点击报名**：进入表单页面
3. **选择活动**：选择活动类型和具体活动
4. **填写信息**：填写个人信息和紧急联系人
5. **确认信息**：查看费用预览和确认信息
6. **提交表单**：验证通过后提交
7. **确认订单**：在确认页面查看订单详情
8. **完成支付**：选择支付方式完成支付
9. **报名成功**：显示成功页面

### 2. 用户引导
- **步骤指示器**：清晰显示当前步骤
- **错误提示**：实时显示表单错误
- **费用预览**：选择活动后显示费用
- **协议确认**：必须同意才能提交
- **返回按钮**：方便返回上页

### 3. 数据安全
- **本地存储**：表单数据保存在本地
- **数据验证**：严格的表单验证
- **隐私保护**：敏感信息加密存储

## 🔄 数据流程

### 1. 表单填写流程
```
用户输入 → 实时验证 → 错误提示 → 修正输入 → 验证通过
```

### 2. 数据存储流程
```
表单数据 → 本地存储 → 页面跳转 → 数据读取 → 确认页面
```

### 3. 支付流程
```
确认订单 → 选择支付方式 → 支付处理 → 订单更新 → 成功页面
```

## 🚀 使用说明

### 1. 测试活动报名功能
1. 进入活动报名主页面
2. 点击"立即报名"按钮
3. 在表单页面填写信息
4. 验证通过后提交
5. 在确认页面查看订单
6. 完成支付流程

### 2. 使用测试页面
1. 访问 `/pages/order/test` 页面
2. 点击各种测试按钮
3. 查看测试报告
4. 验证功能是否正常

### 3. 查看活动记录
1. 在主页点击"我的活动"
2. 或进入个人中心查看活动记录
3. 查看活动详情和状态

## 📈 功能优势

### 1. 用户体验
- **界面美观**：现代化设计，视觉效果好
- **操作简单**：步骤清晰，操作便捷
- **反馈及时**：实时验证，错误提示明确
- **数据安全**：本地存储，隐私保护

### 2. 功能完整
- **活动丰富**：多种类型活动可选
- **信息完整**：包含所有必要信息
- **验证严格**：确保数据准确性
- **流程完整**：从报名到支付全流程

### 3. 技术先进
- **响应式设计**：适配不同屏幕
- **性能优化**：流畅的用户体验
- **代码规范**：清晰的结构和注释
- **易于维护**：模块化设计

## 🔮 未来改进

### 1. 功能扩展
- **活动日历**：显示活动时间表
- **活动推荐**：基于用户兴趣推荐
- **在线咨询**：提供在线咨询服务
- **活动评价**：用户评价和反馈

### 2. 技术优化
- **性能优化**：提升页面加载速度
- **缓存机制**：优化数据缓存
- **离线支持**：支持离线填写表单
- **多语言**：支持多语言界面

### 3. 用户体验
- **个性化**：根据用户偏好定制
- **智能提示**：智能表单填写提示
- **语音输入**：支持语音输入功能
- **AR体验**：增强现实活动预览

## 📞 技术支持

如有问题或建议，请联系开发团队：
- 邮箱：support@example.com
- 电话：400-123-4567
- 工作时间：周一至周五 9:00-18:00

---

*本文档最后更新时间：2024年1月* 