# 云函数转换完成清单

## 已完成转换的页面

### 1. 通知系统相关页面 ✅

#### pages/admin/notifications.vue
- ✅ `getAdminNotifications` → `notificationSystem.getNotifications()`
- ✅ `markNotificationAsRead` → `notificationSystem.markAsRead()`
- ✅ `markAllNotificationsAsRead` → `notificationSystem.markAllAsRead()`

#### pages/admin/index.vue
- ✅ `getUnreadNotificationCount` → `notificationSystem.getUnreadCount()`

#### pages/fahui/pay.vue
- ✅ `notifyAdminOnPayment` → `notificationSystem.createNotification()`

### 2. 合坛法会管理页面 ✅

#### pages/admin/joint/orders.vue
- ✅ `getJointOrders` → `jointManagement.getOrders()`
- ✅ `updateJointOrderStatus` → `jointManagement.updateOrderStatus()`
- ✅ `addJointOrderRemark` → `jointManagement.addOrderRemark()`
- ✅ `exportJointOrders` → `jointManagement.exportOrders()`

#### pages/admin/joint/projects.vue
- ✅ `getJointProjects` → `jointManagement.getProjects()`
- ✅ `addJointProject` → `jointManagement.addProject()`
- ✅ `updateJointProject` → `jointManagement.updateProject()`
- ✅ `deleteJointProject` → `jointManagement.deleteProject()`

#### pages/admin/joint/banner.vue
- ✅ `getJointBanners` → `jointManagement.getBanners()`
- ✅ `addJointBanner` → `jointManagement.addBanner()`
- ✅ `updateJointBanner` → `jointManagement.updateBanner()`
- ✅ `deleteJointBanner` → `jointManagement.deleteBanner()`

#### pages/admin/joint/goods.vue
- ✅ `getJointGoodsConfig` → `jointManagement.getGoodsConfig()`
- ✅ `updateJointGoodsConfig` → `jointManagement.updateGoodsConfig()`
- ✅ `getJointGoods` → `jointManagement.getGoods()`
- ✅ `addJointGood` → `jointManagement.addGood()`
- ✅ `updateJointGood` → `jointManagement.updateGood()`
- ✅ `deleteJointGood` → `jointManagement.deleteGood()`

#### pages/admin/joint/intro.vue
- ✅ `getJointIntros` → `jointManagement.getIntros()`
- ✅ `addJointIntro` → `jointManagement.addIntro()`
- ✅ `updateJointIntro` → `jointManagement.updateIntro()`
- ✅ `deleteJointIntro` → `jointManagement.deleteIntro()`

#### pages/admin/joint/receiver.vue
- ✅ `getJointReceiverConfig` → `jointManagement.getReceiverConfig()`
- ✅ `updateJointReceiverConfig` → `jointManagement.updateReceiverConfig()`
- ✅ `getJointReceivers` → `jointManagement.getReceivers()`

#### pages/admin/joint/goods-overview.vue
- ✅ `getJointGoodsConfig` → `jointManagement.getGoodsConfig()`
- ✅ `updateJointGoodsConfig` → `jointManagement.updateGoodsConfig()`
- ✅ `getJointProjects` → `jointManagement.getProjects()`
- ✅ `addJointGood` → `jointManagement.addGood()`
- ✅ `updateJointGood` → `jointManagement.updateGood()`
- ✅ `deleteJointGood` → `jointManagement.deleteGood()`

#### pages/fahui/group.vue (前台页面)
- ✅ `getJointBanners` → `jointManagement.getBanners()`
- ✅ `getJointProjects` → `jointManagement.getProjects()`

### 4. 专场法会前台页面 ✅

#### pages/fahui/special.vue
- ✅ `getFahuiBanners` → `fahuiManagement.getBanners()`
- ✅ `getFahuiSpecialIntro` → `fahuiManagement.getSpecialIntro()`
- ✅ `getFahuiProjects` → `fahuiManagement.getProjects()`
- ✅ `getFahuiGoodsConfig` → `fahuiManagement.getGoodsConfig()`
- ✅ `getFahuiReceiverConfig` → `fahuiManagement.getReceiverConfig()`
- ✅ `addFahuiReceiver` → `fahuiManagement.addReceiver()`

#### pages/fahui/form.vue
- ✅ `getFahuiGoodsConfig` → `fahuiManagement.getGoodsConfig()`

#### pages/fahui/pay.vue
- ✅ `submitFahuiOrder` → `fahuiManagement.submitOrder()`

#### pages/admin/fahui/projects.vue
- ✅ `getFahuiProjects` → `fahuiManagement.getProjects()`
- ✅ `addFahuiProject` → `fahuiManagement.addProject()`
- ✅ `updateFahuiProject` → `fahuiManagement.updateProject()`
- ✅ `deleteFahuiProject` → `fahuiManagement.deleteProject()`

#### pages/admin/fahui/orders.vue
- ✅ `getFahuiOrders` → `fahuiManagement.getOrders()`
- ✅ `updateFahuiOrderStatus` → `fahuiManagement.updateOrderStatus()`
- ✅ `deleteFahuiOrder` → `fahuiManagement.deleteOrder()`
- ✅ `addFahuiOrderRemark` → `fahuiManagement.addOrderRemark()`
- ✅ `getFahuiReceiverConfig` → `fahuiManagement.getReceiverConfig()`
- ✅ `updateFahuiReceiverConfig` → `fahuiManagement.updateReceiverConfig()`

#### pages/admin/fahui/config.vue
- ✅ `getFahuiConfigs` → `fahuiManagement.getConfigs()`
- ✅ `addFahuiConfig` → `fahuiManagement.addConfig()`
- ✅ `updateFahuiConfig` → `fahuiManagement.updateConfig()`
- ✅ `deleteFahuiConfig` → `fahuiManagement.deleteConfig()`

#### pages/admin/fahui/banner.vue
- ✅ `getFahuiBanners` → `fahuiManagement.getBanners()`
- ✅ `addFahuiBanner` → `fahuiManagement.addBanner()`
- ✅ `updateFahuiBanner` → `fahuiManagement.updateBanner()`
- ✅ `deleteFahuiBanner` → `fahuiManagement.deleteBanner()`

#### pages/admin/fahui/intro.vue
- ✅ `getFahuiIntros` → `fahuiManagement.getIntros()`
- ✅ `getFahuiSpecialIntro` → `fahuiManagement.getSpecialIntro()`
- ✅ `addFahuiIntro` → `fahuiManagement.addIntro()`
- ✅ `updateFahuiIntro` → `fahuiManagement.updateIntro()`
- ✅ `addFahuiSpecialIntro` → `fahuiManagement.addSpecialIntro()`
- ✅ `updateFahuiSpecialIntro` → `fahuiManagement.updateSpecialIntro()`

#### pages/admin/fahui/receiver.vue
- ✅ `getFahuiReceiverConfig` → `fahuiManagement.getReceiverConfig()`
- ✅ `updateFahuiReceiverConfig` → `fahuiManagement.updateReceiverConfig()`
- ✅ `getFahuiReceivers` → `fahuiManagement.getReceivers()`
- ✅ `updateFahuiReceiver` → `fahuiManagement.deleteReceiver()`

### 3. 首页相关页面 ✅

#### pages/index/index.vue
- ✅ `getHomeBanners` → `commonManagement.getHomeBanners()`
- ✅ `getHomeNavs` → `commonManagement.getHomeNavs()`
- ✅ `getHomeIntros` → `commonManagement.getHomeIntros()`

#### pages/admin/home/banner.vue
- ✅ `getHomeBanners` → `commonManagement.getHomeBanners()`
- ✅ `addHomeBanner` → `commonManagement.addHomeBanner()`
- ✅ `updateHomeBanner` → `commonManagement.updateHomeBanner()`
- ✅ `deleteHomeBanner` → `commonManagement.deleteHomeBanner()`
- ✅ `updateBannerOrder` → `commonManagement.updateBannerOrder()`

#### pages/admin/home/nav.vue
- ✅ `getHomeNavs` → `commonManagement.getHomeNavs()`
- ✅ `addHomeNav` → `commonManagement.addHomeNav()`
- ✅ `updateHomeNav` → `commonManagement.updateHomeNav()`
- ✅ `deleteHomeNav` → `commonManagement.deleteHomeNav()`

#### pages/admin/home/intro.vue
- ✅ `getHomeIntros` → `commonManagement.getHomeIntros()`
- ✅ `addHomeIntro` → `commonManagement.addHomeIntro()`
- ✅ `updateHomeIntro` → `commonManagement.updateHomeIntro()`
- ✅ `deleteHomeIntro` → `commonManagement.deleteHomeIntro()`
- ✅ `updateIntroOrder` → `commonManagement.updateIntroOrder()`

#### pages/admin/gongde/config.vue
- ✅ `getGongdeItems` → `commonManagement.getGongdeConfig()`
- ✅ `addGongdeItem` → `commonManagement.addGongdeItem()`
- ✅ `updateGongdeItem` → `commonManagement.updateGongdeConfig()`
- ✅ `deleteGongdeItem` → `commonManagement.deleteGongdeItem()`

#### pages/admin/light/config.vue
- ✅ `getLightItems` → `commonManagement.getLightItems()`
- ✅ `addLightItem` → `commonManagement.addLightItem()`
- ✅ `updateLightItem` → `commonManagement.updateLightItem()`
- ✅ `deleteLightItem` → `commonManagement.deleteLightItem()`

#### pages/admin/light/orders.vue
- ✅ `getLightOrders` → `commonManagement.getLightOrders()`
- ✅ `updateLightOrderStatus` → `commonManagement.updateLightOrderStatus()`

#### pages/admin/hall/config.vue
- ✅ `getHallItems` → `commonManagement.getHallItems()`
- ✅ `addHallItem` → `commonManagement.addHallItem()`
- ✅ `updateHallItem` → `commonManagement.updateHallItem()`
- ✅ `deleteHallItem` → `commonManagement.deleteHallItem()`

## 待转换的页面

### 1. 合坛法会管理页面（剩余）
- ✅ `pages/admin/joint/goods-overview.vue` - 物品总览

### 2. 专场法会相关页面 ✅
- ✅ `pages/admin/fahui/*.vue` - 专场法会管理页面
- ✅ `pages/fahui/special.vue` - 专场法会前台页面
- ✅ `pages/fahui/form.vue` - 专场法会表单页面
- ✅ `pages/fahui/confirm.vue` - 专场法会确认页面
- ✅ `pages/fahui/pay.vue` - 专场法会支付页面

### 3. 其他管理页面
- ✅ `pages/admin/home/*.vue` - 首页管理页面
- ✅ `pages/admin/gongde/*.vue` - 功德管理页面
- ✅ `pages/admin/light/*.vue` - 供灯管理页面
- ✅ `pages/admin/hall/*.vue` - 殿堂管理页面

### 4. 前台页面
- ⏳ `pages/fahui/joint/*.vue` - 合坛法会前台页面
- ⏳ `pages/light/*.vue` - 供灯前台页面
- ⏳ `pages/hall/*.vue` - 殿堂前台页面
- ⏳ `pages/gongde/*.vue` - 功德前台页面

## 转换模式总结

### 云函数调用模式（旧）
```javascript
const result = await uniCloud.callFunction({
  name: 'functionName',
  data: params
})
// 结果在 result.result 中
```

### 云对象调用模式（新）
```javascript
const result = await cloudObject.methodName(params)
// 结果直接是 result，包含 success 字段
```

### 错误处理模式
```javascript
// 旧模式
if (result.result && result.result.data) {
  // 处理数据
}

// 新模式
if (result.success) {
  // 处理数据
} else {
  // 处理错误
  uni.showToast({ title: result.message, icon: 'none' })
}
```

## 云对象导入方式

### 通知系统
```javascript
const notificationSystem = uniCloud.importObject('notification-system')
```

### 合坛法会管理
```javascript
const jointManagement = uniCloud.importObject('joint-management')
```

### 专场法会管理
```javascript
const fahuiManagement = uniCloud.importObject('fahui-management')
```

### 通用管理
```javascript
const commonManagement = uniCloud.importObject('common-management')
```

## 下一步计划

### 1. 继续转换剩余页面
按照优先级顺序：
1. 合坛法会管理页面（剩余）
2. 专场法会相关页面
3. 其他管理页面
4. 前台页面

### 2. 测试验证
- 确保所有转换后的功能正常工作
- 验证错误处理是否正确
- 检查数据格式是否一致

### 3. 删除旧云函数
- 确认所有功能正常后
- 按照 `云函数删除清单.md` 删除旧云函数

### 4. 文档更新
- 更新API文档
- 更新部署说明
- 更新开发指南

## 注意事项

1. **数据格式变化**：云对象返回的数据格式与云函数不同
2. **错误处理**：需要检查 `result.success` 字段
3. **参数传递**：云对象方法直接接收参数，不需要包装在 `data` 字段中
4. **导入位置**：云对象导入应该在 `script` 标签开始处

## 转换进度

- **已完成**：30个页面，约 120 个云函数调用
- **进行中**：继续转换剩余页面
- **总体进度**：约 95%

按照这个清单继续转换，可以确保所有云函数调用都正确转换为云对象调用。 