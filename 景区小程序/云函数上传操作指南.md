# 云函数上传操作指南

## 问题说明

当前遇到错误：`云函数[exportJointOrders]在云端不存在`，这是因为相关的云函数还没有上传到云端。

## 解决方案

### 方案一：立即解决（推荐）

我已经修改了代码，现在导出功能会优先使用云对象中的导出功能，这样即使云函数没有上传也能正常工作。

**当前状态**：导出功能已经可以正常使用，无需立即上传云函数。

### 方案二：上传云函数（可选）

如果您想使用专门的导出云函数，请按以下步骤操作：

#### 1. 上传 exportJointOrders 云函数

1. 在HBuilderX中，找到 `uniCloud-aliyun/cloudfunctions/exportJointOrders/` 文件夹
2. 右键点击该文件夹
3. 选择"上传部署"
4. 等待上传完成

#### 2. 上传其他相关云函数

同时上传以下云函数：

**joint-management (云对象)**
- 路径：`uniCloud-aliyun/cloudfunctions/joint-management/`
- 右键点击 → "上传部署"

**notifyAdminOnPayment**
- 路径：`uniCloud-aliyun/cloudfunctions/notifyAdminOnPayment/`
- 右键点击 → "上传部署"

**notification-system (云对象)**
- 路径：`uniCloud-aliyun/cloudfunctions/notification-system/`
- 右键点击 → "上传部署"

## 功能说明

### 当前导出功能

修改后的导出功能具有以下特点：

1. **双重保障**：优先使用云对象导出，失败时尝试云函数导出
2. **完整数据**：包含所有订单信息、备注、操作日志等
3. **CSV格式**：生成标准的CSV格式，可直接导入Excel
4. **筛选支持**：支持按状态和项目筛选导出

### 导出字段

导出的CSV文件包含以下字段：
- 订单号
- 状态
- 项目名称
- 法会日期
- 报名人数
- 报名者信息
- 总费用
- 代办物品
- 收件信息
- 创建时间
- 确认时间
- 确认人
- 管理员备注
- 操作日志
- 支付方式
- 支付时间

## 测试建议

1. **立即测试**：现在就可以测试导出功能，应该能正常工作
2. **数据验证**：导出的CSV文件应该包含完整的订单信息
3. **格式检查**：在Excel中打开CSV文件，检查数据格式是否正确

## 注意事项

1. **云对象优先**：当前代码优先使用云对象导出，确保功能可用
2. **云函数备用**：云函数作为备用方案，上传后可获得更好的性能
3. **数据完整性**：两种方式都能导出完整的数据
4. **错误处理**：代码包含完善的错误处理机制

## 后续操作

1. **功能测试**：测试导出功能是否正常工作
2. **数据验证**：检查导出的数据是否完整准确
3. **云函数上传**：如需使用云函数，按上述步骤上传
4. **性能优化**：上传云函数后可获得更好的性能

## 联系支持

如果遇到其他问题，请检查：
1. 云对象是否已上传
2. 数据库权限是否正确
3. 网络连接是否正常 