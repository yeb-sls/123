# 姻缘和合法会功能测试说明

## 问题描述

用户反馈：在前台选择了姻缘和合法会对应的项目，但没有出现输入配偶信息的选项。

## 已添加的调试功能

我已经在前台表单页面添加了详细的调试功能来帮助排查问题：

### 1. 页面调试信息

页面中会显示一个黄色的调试信息区域，包含：
- 当前项目名称
- 项目分类
- 是否应该显示配偶信息
- currentProject对象的完整信息
- 项目列表及其分类

### 2. 控制台调试信息

打开浏览器开发者工具的控制台，会看到详细的调试信息：

#### 页面加载时：
```
🔍 姻缘和合法会调试: 页面加载完成
🔍 姻缘和合法会调试: 项目列表: [...]
🔍 姻缘和合法会调试: 当前项目: {...}
🔍 姻缘和合法会调试: 当前项目分类: 姻缘和合
🔍 姻缘和合法会调试: 是否应该显示配偶信息: true/false
```

#### 项目选择时：
```
🔍 姻缘和合法会调试: 选择项目后，currentProject: {...}
🔍 姻缘和合法会调试: 项目分类检查: true/false
```

### 3. 测试功能

我还添加了一个绿色的测试区域，强制显示配偶信息提示，用于验证功能是否正常。

## 测试步骤

### 步骤1：检查页面调试信息

1. 打开前台表单页面
2. 查看页面中的黄色调试信息区域
3. 确认：
   - 当前项目是否正确
   - 项目分类是否为"姻缘和合"
   - 是否应该显示配偶信息

### 步骤2：检查控制台信息

1. 打开浏览器开发者工具 (F12)
2. 切换到 Console 标签
3. 刷新页面或选择不同项目
4. 查看带有 🔍 图标的调试信息

### 步骤3：测试强制显示功能

1. 查看页面中的绿色测试区域
2. 点击"测试填写配偶信息"按钮
3. 验证弹窗是否正常打开

### 步骤4：验证项目数据

检查项目数据是否正确：

```javascript
// 默认项目数据
{
  _id: 'joint_yinyuan',
  name: '姻缘合坛',
  category: '姻缘和合',  // 注意这里的分类名称
  price: 300,
  description: '祈求姻缘美满，感情和睦'
}
```

## 可能的问题原因

### 1. 项目分类名称不匹配
**症状**：项目分类不是"姻缘和合"
**解决**：检查后台项目数据，确保分类名称正确

### 2. 项目数据未加载
**症状**：currentProject为空或undefined
**解决**：检查云函数getJointProjects是否正常工作

### 3. Vue响应式问题
**症状**：数据正确但界面不更新
**解决**：检查Vue的响应式绑定

### 4. CSS样式问题
**症状**：元素存在但不可见
**解决**：检查CSS样式和布局

## 排查清单

请按以下顺序检查：

- [ ] 页面调试信息显示项目分类为"姻缘和合"
- [ ] 控制台调试信息显示应该显示配偶信息
- [ ] 绿色测试区域可以正常点击
- [ ] 配偶信息弹窗可以正常打开
- [ ] 项目数据从数据库正确加载

## 临时解决方案

如果问题持续存在，可以临时修改显示条件：

```vue
<!-- 临时：移除条件判断，强制显示 -->
<view v-if="true" class="special-tip">
  <text>如需填写配偶信息，请点击下方按钮</text>
  <button class="mini-btn" size="mini" @click="openSpouseDialog">填写配偶信息（选填）</button>
</view>
```

## 相关文件

- `pages/fahui/joint/form.vue` - 前台表单页面（已添加调试信息）
- `pages/admin/joint/projects.vue` - 后台项目管理页面
- `uniCloud-aliyun/cloudfunctions/getJointProjects/` - 获取项目列表云函数

## 下一步

请按照测试步骤操作，然后告诉我：

1. 页面调试信息显示的内容
2. 控制台调试信息的输出
3. 绿色测试区域是否正常工作
4. 具体在哪一步出现问题

这样我可以准确定位问题并提供解决方案。 