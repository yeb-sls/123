# 合坛法会特殊功能实现说明

## 功能概述

根据需求，合坛法会系统已实现以下特殊功能：

### 1. 姻缘和合法会特殊功能

**功能描述：**
- 当选择"姻缘和合法会"项目时，系统会提示用户填写配偶信息（选填）
- 配偶信息包括：姓名、性别、农历生日、出生时辰

**实现细节：**
- 在 `pages/fahui/joint/form.vue` 中添加了配偶信息管理功能
- 配偶信息为选填项，用户可根据需要填写
- 配偶信息会保存到本地草稿和最终订单中
- 在确认页面和支付页面会显示配偶信息

**界面展示：**
- 选择姻缘和合项目后，显示"填写配偶信息（选填）"按钮
- 填写后显示配偶信息卡片，包含所有填写的信息
- 支持修改配偶信息

### 2. 超度法会特殊功能

**功能描述：**
- 当选择"超度法会"项目时，系统要求选择超度类型（必选）
- 需要添加已故亲人信息，至少1人，最多5人
- 已故亲人信息包括：姓名（必填）、出生农历日期（选填）、去世农历日期（选填）、关系（必选）

**超度类型选项：**
- 超度亡灵
- 超度婴灵
- 超度冤亲债主
- 超度历代宗亲

**已故亲人关系选项：**
- 先曾祖父、先曾祖母、先祖父、先祖母
- 外祖父、外祖母、先父、先母
- 岳父、岳母、先夫、先妻
- 故爱子、故爱女、好友、恩师、其他

**实现细节：**
- 在表单页面添加超度类型选择器
- 实现已故亲人信息的增删改查功能
- 表单验证确保至少添加一位已故亲人
- 支持最多添加5位已故亲人
- 已故亲人信息会保存到订单中

**界面展示：**
- 选择超度法会项目后，显示超度类型选择
- 显示已故亲人列表，支持添加、编辑、删除
- 在确认页面显示所有已故亲人信息

## 技术实现

### 数据模型

**配偶信息：**
```javascript
spouse: {
  name: '',           // 姓名（选填）
  gender: '',         // 性别
  lunarBirthday: '',  // 农历生日
  birthTime: ''       // 出生时辰
}
```

**已故亲人信息：**
```javascript
deceasedList: [
  {
    name: '',              // 姓名（必填）
    lunarBirthday: '',     // 出生农历日期（选填）
    deathDate: '',         // 去世农历日期（选填）
    relation: ''           // 关系（必选）
  }
]
```

### 表单验证

**姻缘和合法会：**
- 配偶信息为选填项，不强制验证

**超度法会：**
- 超度类型为必选项
- 至少添加一位已故亲人
- 已故亲人姓名和关系为必填项

### 数据持久化

- 所有信息都会保存到本地草稿中
- 提交时保存到订单数据
- 支持页面刷新后恢复数据

### 页面集成

**表单页面 (`pages/fahui/joint/form.vue`)：**
- 根据项目类型动态显示相应功能
- 实现配偶信息和已故亲人信息的编辑功能

**确认页面 (`pages/fahui/joint/confirm.vue`)：**
- 显示配偶信息（如果有）
- 显示已故亲人信息（如果有）

**支付页面 (`pages/fahui/joint/pay.vue`)：**
- 显示订单摘要信息

## 使用流程

### 姻缘和合法会报名流程：
1. 选择"姻缘和合法会"项目
2. 填写报名人信息
3. 可选择填写配偶信息（点击"填写配偶信息"按钮）
4. 填写其他信息（代办物品、收件信息等）
5. 提交订单

### 超度法会报名流程：
1. 选择"超度法会"项目
2. 填写报名人信息
3. 选择超度类型（必选）
4. 添加已故亲人信息（至少1人，最多5人）
5. 填写其他信息（代办物品、收件信息等）
6. 提交订单

## 注意事项

1. **数据验证：** 超度法会必须选择超度类型和添加至少一位已故亲人
2. **数据保存：** 所有信息都会自动保存到本地，支持断点续填
3. **界面适配：** 根据项目类型动态显示相应功能模块
4. **用户体验：** 提供清晰的提示信息和操作指引

## 后续优化建议

1. 可以添加更多的超度类型选项
2. 可以增加已故亲人的更多信息字段
3. 可以优化配偶信息的验证逻辑
4. 可以添加数据导入导出功能 